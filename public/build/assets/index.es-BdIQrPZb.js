function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/index-B18Rf5_z.js","assets/app-Chk6y4fk.js","assets/app-DOflTQmN.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{L as I1,P as fc,c as Ci,g as Vf,Q as S1,_ as x1}from"./app-Chk6y4fk.js";import{e as Er,U as dc}from"./events-DITPEO1_.js";var pc={},Zs={},xe={},Wf={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});function e(f,y){var g=f>>>16&65535,m=f&65535,D=y>>>16&65535,I=y&65535;return m*I+(g*I+m*D<<16>>>0)|0}i.mul=Math.imul||e;function t(f,y){return f+y|0}i.add=t;function s(f,y){return f-y|0}i.sub=s;function o(f,y){return f<<y|f>>>32-y}i.rotl=o;function c(f,y){return f<<32-y|f>>>y}i.rotr=c;function d(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f}i.isInteger=Number.isInteger||d,i.MAX_SAFE_INTEGER=9007199254740991,i.isSafeInteger=function(f){return i.isInteger(f)&&f>=-i.MAX_SAFE_INTEGER&&f<=i.MAX_SAFE_INTEGER}})(Wf);Object.defineProperty(xe,"__esModule",{value:!0});var Gf=Wf;function O1(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])<<16>>16}xe.readInt16BE=O1;function P1(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])>>>0}xe.readUint16BE=P1;function C1(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])<<16>>16}xe.readInt16LE=C1;function A1(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])>>>0}xe.readUint16LE=A1;function Yf(i,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=i>>>8,e[t+1]=i>>>0,e}xe.writeUint16BE=Yf;xe.writeInt16BE=Yf;function Jf(i,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=i>>>0,e[t+1]=i>>>8,e}xe.writeUint16LE=Jf;xe.writeInt16LE=Jf;function ka(i,e){return e===void 0&&(e=0),i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}xe.readInt32BE=ka;function Ka(i,e){return e===void 0&&(e=0),(i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3])>>>0}xe.readUint32BE=Ka;function Va(i,e){return e===void 0&&(e=0),i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e]}xe.readInt32LE=Va;function Wa(i,e){return e===void 0&&(e=0),(i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e])>>>0}xe.readUint32LE=Wa;function Ws(i,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=i>>>24,e[t+1]=i>>>16,e[t+2]=i>>>8,e[t+3]=i>>>0,e}xe.writeUint32BE=Ws;xe.writeInt32BE=Ws;function Gs(i,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=i>>>0,e[t+1]=i>>>8,e[t+2]=i>>>16,e[t+3]=i>>>24,e}xe.writeUint32LE=Gs;xe.writeInt32LE=Gs;function R1(i,e){e===void 0&&(e=0);var t=ka(i,e),s=ka(i,e+4);return t*4294967296+s-(s>>31)*4294967296}xe.readInt64BE=R1;function N1(i,e){e===void 0&&(e=0);var t=Ka(i,e),s=Ka(i,e+4);return t*4294967296+s}xe.readUint64BE=N1;function T1(i,e){e===void 0&&(e=0);var t=Va(i,e),s=Va(i,e+4);return s*4294967296+t-(t>>31)*4294967296}xe.readInt64LE=T1;function U1(i,e){e===void 0&&(e=0);var t=Wa(i,e),s=Wa(i,e+4);return s*4294967296+t}xe.readUint64LE=U1;function Qf(i,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Ws(i/4294967296>>>0,e,t),Ws(i>>>0,e,t+4),e}xe.writeUint64BE=Qf;xe.writeInt64BE=Qf;function Xf(i,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Gs(i>>>0,e,t),Gs(i/4294967296>>>0,e,t+4),e}xe.writeUint64LE=Xf;xe.writeInt64LE=Xf;function $1(i,e,t){if(t===void 0&&(t=0),i%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(i/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,o=1,c=i/8+t-1;c>=t;c--)s+=e[c]*o,o*=256;return s}xe.readUintBE=$1;function L1(i,e,t){if(t===void 0&&(t=0),i%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(i/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,o=1,c=t;c<t+i/8;c++)s+=e[c]*o,o*=256;return s}xe.readUintLE=L1;function M1(i,e,t,s){if(t===void 0&&(t=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Gf.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var o=1,c=i/8+s-1;c>=s;c--)t[c]=e/o&255,o*=256;return t}xe.writeUintBE=M1;function j1(i,e,t,s){if(t===void 0&&(t=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Gf.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var o=1,c=s;c<s+i/8;c++)t[c]=e/o&255,o*=256;return t}xe.writeUintLE=j1;function q1(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat32(e)}xe.readFloat32BE=q1;function F1(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat32(e,!0)}xe.readFloat32LE=F1;function z1(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat64(e)}xe.readFloat64BE=z1;function B1(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat64(e,!0)}xe.readFloat64LE=B1;function H1(i,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,i),e}xe.writeFloat32BE=H1;function k1(i,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,i,!0),e}xe.writeFloat32LE=k1;function K1(i,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,i),e}xe.writeFloat64BE=K1;function V1(i,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,i,!0),e}xe.writeFloat64LE=V1;var lr={};Object.defineProperty(lr,"__esModule",{value:!0});function W1(i){for(var e=0;e<i.length;e++)i[e]=0;return i}lr.wipe=W1;Object.defineProperty(Zs,"__esModule",{value:!0});var Ft=xe,Ga=lr,G1=20;function Y1(i,e,t){for(var s=1634760805,o=857760878,c=2036477234,d=1797285236,f=t[3]<<24|t[2]<<16|t[1]<<8|t[0],y=t[7]<<24|t[6]<<16|t[5]<<8|t[4],g=t[11]<<24|t[10]<<16|t[9]<<8|t[8],m=t[15]<<24|t[14]<<16|t[13]<<8|t[12],D=t[19]<<24|t[18]<<16|t[17]<<8|t[16],I=t[23]<<24|t[22]<<16|t[21]<<8|t[20],A=t[27]<<24|t[26]<<16|t[25]<<8|t[24],O=t[31]<<24|t[30]<<16|t[29]<<8|t[28],q=e[3]<<24|e[2]<<16|e[1]<<8|e[0],B=e[7]<<24|e[6]<<16|e[5]<<8|e[4],te=e[11]<<24|e[10]<<16|e[9]<<8|e[8],T=e[15]<<24|e[14]<<16|e[13]<<8|e[12],L=s,x=o,C=c,E=d,u=f,b=y,K=g,W=m,re=D,ae=I,ue=A,_=O,P=q,X=B,J=te,H=T,k=0;k<G1;k+=2)L=L+u|0,P^=L,P=P>>>16|P<<16,re=re+P|0,u^=re,u=u>>>20|u<<12,x=x+b|0,X^=x,X=X>>>16|X<<16,ae=ae+X|0,b^=ae,b=b>>>20|b<<12,C=C+K|0,J^=C,J=J>>>16|J<<16,ue=ue+J|0,K^=ue,K=K>>>20|K<<12,E=E+W|0,H^=E,H=H>>>16|H<<16,_=_+H|0,W^=_,W=W>>>20|W<<12,C=C+K|0,J^=C,J=J>>>24|J<<8,ue=ue+J|0,K^=ue,K=K>>>25|K<<7,E=E+W|0,H^=E,H=H>>>24|H<<8,_=_+H|0,W^=_,W=W>>>25|W<<7,x=x+b|0,X^=x,X=X>>>24|X<<8,ae=ae+X|0,b^=ae,b=b>>>25|b<<7,L=L+u|0,P^=L,P=P>>>24|P<<8,re=re+P|0,u^=re,u=u>>>25|u<<7,L=L+b|0,H^=L,H=H>>>16|H<<16,ue=ue+H|0,b^=ue,b=b>>>20|b<<12,x=x+K|0,P^=x,P=P>>>16|P<<16,_=_+P|0,K^=_,K=K>>>20|K<<12,C=C+W|0,X^=C,X=X>>>16|X<<16,re=re+X|0,W^=re,W=W>>>20|W<<12,E=E+u|0,J^=E,J=J>>>16|J<<16,ae=ae+J|0,u^=ae,u=u>>>20|u<<12,C=C+W|0,X^=C,X=X>>>24|X<<8,re=re+X|0,W^=re,W=W>>>25|W<<7,E=E+u|0,J^=E,J=J>>>24|J<<8,ae=ae+J|0,u^=ae,u=u>>>25|u<<7,x=x+K|0,P^=x,P=P>>>24|P<<8,_=_+P|0,K^=_,K=K>>>25|K<<7,L=L+b|0,H^=L,H=H>>>24|H<<8,ue=ue+H|0,b^=ue,b=b>>>25|b<<7;Ft.writeUint32LE(L+s|0,i,0),Ft.writeUint32LE(x+o|0,i,4),Ft.writeUint32LE(C+c|0,i,8),Ft.writeUint32LE(E+d|0,i,12),Ft.writeUint32LE(u+f|0,i,16),Ft.writeUint32LE(b+y|0,i,20),Ft.writeUint32LE(K+g|0,i,24),Ft.writeUint32LE(W+m|0,i,28),Ft.writeUint32LE(re+D|0,i,32),Ft.writeUint32LE(ae+I|0,i,36),Ft.writeUint32LE(ue+A|0,i,40),Ft.writeUint32LE(_+O|0,i,44),Ft.writeUint32LE(P+q|0,i,48),Ft.writeUint32LE(X+B|0,i,52),Ft.writeUint32LE(J+te|0,i,56),Ft.writeUint32LE(H+T|0,i,60)}function Zf(i,e,t,s,o){if(o===void 0&&(o=0),i.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<t.length)throw new Error("ChaCha: destination is shorter than source");var c,d;if(o===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");c=new Uint8Array(16),d=c.length-e.length,c.set(e,d)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");c=e,d=o}for(var f=new Uint8Array(64),y=0;y<t.length;y+=64){Y1(f,c,i);for(var g=y;g<y+64&&g<t.length;g++)s[g]=t[g]^f[g-y];Q1(c,0,d)}return Ga.wipe(f),o===0&&Ga.wipe(c),s}Zs.streamXOR=Zf;function J1(i,e,t,s){return s===void 0&&(s=0),Ga.wipe(t),Zf(i,e,t,t,s)}Zs.stream=J1;function Q1(i,e,t){for(var s=1;t--;)s=s+(i[e]&255)|0,i[e]=s&255,s>>>=8,e++;if(s>0)throw new Error("ChaCha: counter overflow")}var ed={},di={};Object.defineProperty(di,"__esModule",{value:!0});function X1(i,e,t){return~(i-1)&e|i-1&t}di.select=X1;function Z1(i,e){return(i|0)-(e|0)-1>>>31&1}di.lessOrEqual=Z1;function td(i,e){if(i.length!==e.length)return 0;for(var t=0,s=0;s<i.length;s++)t|=i[s]^e[s];return 1&t-1>>>8}di.compare=td;function eb(i,e){return i.length===0||e.length===0?!1:td(i,e)!==0}di.equal=eb;(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=di,t=lr;i.DIGEST_LENGTH=16;var s=function(){function d(f){this.digestLength=i.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var y=f[0]|f[1]<<8;this._r[0]=y&8191;var g=f[2]|f[3]<<8;this._r[1]=(y>>>13|g<<3)&8191;var m=f[4]|f[5]<<8;this._r[2]=(g>>>10|m<<6)&7939;var D=f[6]|f[7]<<8;this._r[3]=(m>>>7|D<<9)&8191;var I=f[8]|f[9]<<8;this._r[4]=(D>>>4|I<<12)&255,this._r[5]=I>>>1&8190;var A=f[10]|f[11]<<8;this._r[6]=(I>>>14|A<<2)&8191;var O=f[12]|f[13]<<8;this._r[7]=(A>>>11|O<<5)&8065;var q=f[14]|f[15]<<8;this._r[8]=(O>>>8|q<<8)&8191,this._r[9]=q>>>5&127,this._pad[0]=f[16]|f[17]<<8,this._pad[1]=f[18]|f[19]<<8,this._pad[2]=f[20]|f[21]<<8,this._pad[3]=f[22]|f[23]<<8,this._pad[4]=f[24]|f[25]<<8,this._pad[5]=f[26]|f[27]<<8,this._pad[6]=f[28]|f[29]<<8,this._pad[7]=f[30]|f[31]<<8}return d.prototype._blocks=function(f,y,g){for(var m=this._fin?0:2048,D=this._h[0],I=this._h[1],A=this._h[2],O=this._h[3],q=this._h[4],B=this._h[5],te=this._h[6],T=this._h[7],L=this._h[8],x=this._h[9],C=this._r[0],E=this._r[1],u=this._r[2],b=this._r[3],K=this._r[4],W=this._r[5],re=this._r[6],ae=this._r[7],ue=this._r[8],_=this._r[9];g>=16;){var P=f[y+0]|f[y+1]<<8;D+=P&8191;var X=f[y+2]|f[y+3]<<8;I+=(P>>>13|X<<3)&8191;var J=f[y+4]|f[y+5]<<8;A+=(X>>>10|J<<6)&8191;var H=f[y+6]|f[y+7]<<8;O+=(J>>>7|H<<9)&8191;var k=f[y+8]|f[y+9]<<8;q+=(H>>>4|k<<12)&8191,B+=k>>>1&8191;var G=f[y+10]|f[y+11]<<8;te+=(k>>>14|G<<2)&8191;var Z=f[y+12]|f[y+13]<<8;T+=(G>>>11|Z<<5)&8191;var ve=f[y+14]|f[y+15]<<8;L+=(Z>>>8|ve<<8)&8191,x+=ve>>>5|m;var ie=0,me=ie;me+=D*C,me+=I*(5*_),me+=A*(5*ue),me+=O*(5*ae),me+=q*(5*re),ie=me>>>13,me&=8191,me+=B*(5*W),me+=te*(5*K),me+=T*(5*b),me+=L*(5*u),me+=x*(5*E),ie+=me>>>13,me&=8191;var we=ie;we+=D*E,we+=I*C,we+=A*(5*_),we+=O*(5*ue),we+=q*(5*ae),ie=we>>>13,we&=8191,we+=B*(5*re),we+=te*(5*W),we+=T*(5*K),we+=L*(5*b),we+=x*(5*u),ie+=we>>>13,we&=8191;var ye=ie;ye+=D*u,ye+=I*E,ye+=A*C,ye+=O*(5*_),ye+=q*(5*ue),ie=ye>>>13,ye&=8191,ye+=B*(5*ae),ye+=te*(5*re),ye+=T*(5*W),ye+=L*(5*K),ye+=x*(5*b),ie+=ye>>>13,ye&=8191;var j=ie;j+=D*b,j+=I*u,j+=A*E,j+=O*C,j+=q*(5*_),ie=j>>>13,j&=8191,j+=B*(5*ue),j+=te*(5*ae),j+=T*(5*re),j+=L*(5*W),j+=x*(5*K),ie+=j>>>13,j&=8191;var F=ie;F+=D*K,F+=I*b,F+=A*u,F+=O*E,F+=q*C,ie=F>>>13,F&=8191,F+=B*(5*_),F+=te*(5*ue),F+=T*(5*ae),F+=L*(5*re),F+=x*(5*W),ie+=F>>>13,F&=8191;var U=ie;U+=D*W,U+=I*K,U+=A*b,U+=O*u,U+=q*E,ie=U>>>13,U&=8191,U+=B*C,U+=te*(5*_),U+=T*(5*ue),U+=L*(5*ae),U+=x*(5*re),ie+=U>>>13,U&=8191;var l=ie;l+=D*re,l+=I*W,l+=A*K,l+=O*b,l+=q*u,ie=l>>>13,l&=8191,l+=B*E,l+=te*C,l+=T*(5*_),l+=L*(5*ue),l+=x*(5*ae),ie+=l>>>13,l&=8191;var R=ie;R+=D*ae,R+=I*re,R+=A*W,R+=O*K,R+=q*b,ie=R>>>13,R&=8191,R+=B*u,R+=te*E,R+=T*C,R+=L*(5*_),R+=x*(5*ue),ie+=R>>>13,R&=8191;var ne=ie;ne+=D*ue,ne+=I*ae,ne+=A*re,ne+=O*W,ne+=q*K,ie=ne>>>13,ne&=8191,ne+=B*b,ne+=te*u,ne+=T*E,ne+=L*C,ne+=x*(5*_),ie+=ne>>>13,ne&=8191;var ce=ie;ce+=D*_,ce+=I*ue,ce+=A*ae,ce+=O*re,ce+=q*W,ie=ce>>>13,ce&=8191,ce+=B*K,ce+=te*b,ce+=T*u,ce+=L*E,ce+=x*C,ie+=ce>>>13,ce&=8191,ie=(ie<<2)+ie|0,ie=ie+me|0,me=ie&8191,ie=ie>>>13,we+=ie,D=me,I=we,A=ye,O=j,q=F,B=U,te=l,T=R,L=ne,x=ce,y+=16,g-=16}this._h[0]=D,this._h[1]=I,this._h[2]=A,this._h[3]=O,this._h[4]=q,this._h[5]=B,this._h[6]=te,this._h[7]=T,this._h[8]=L,this._h[9]=x},d.prototype.finish=function(f,y){y===void 0&&(y=0);var g=new Uint16Array(10),m,D,I,A;if(this._leftover){for(A=this._leftover,this._buffer[A++]=1;A<16;A++)this._buffer[A]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(m=this._h[1]>>>13,this._h[1]&=8191,A=2;A<10;A++)this._h[A]+=m,m=this._h[A]>>>13,this._h[A]&=8191;for(this._h[0]+=m*5,m=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=m,m=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=m,g[0]=this._h[0]+5,m=g[0]>>>13,g[0]&=8191,A=1;A<10;A++)g[A]=this._h[A]+m,m=g[A]>>>13,g[A]&=8191;for(g[9]-=8192,D=(m^1)-1,A=0;A<10;A++)g[A]&=D;for(D=~D,A=0;A<10;A++)this._h[A]=this._h[A]&D|g[A];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,I=this._h[0]+this._pad[0],this._h[0]=I&65535,A=1;A<8;A++)I=(this._h[A]+this._pad[A]|0)+(I>>>16)|0,this._h[A]=I&65535;return f[y+0]=this._h[0]>>>0,f[y+1]=this._h[0]>>>8,f[y+2]=this._h[1]>>>0,f[y+3]=this._h[1]>>>8,f[y+4]=this._h[2]>>>0,f[y+5]=this._h[2]>>>8,f[y+6]=this._h[3]>>>0,f[y+7]=this._h[3]>>>8,f[y+8]=this._h[4]>>>0,f[y+9]=this._h[4]>>>8,f[y+10]=this._h[5]>>>0,f[y+11]=this._h[5]>>>8,f[y+12]=this._h[6]>>>0,f[y+13]=this._h[6]>>>8,f[y+14]=this._h[7]>>>0,f[y+15]=this._h[7]>>>8,this._finished=!0,this},d.prototype.update=function(f){var y=0,g=f.length,m;if(this._leftover){m=16-this._leftover,m>g&&(m=g);for(var D=0;D<m;D++)this._buffer[this._leftover+D]=f[y+D];if(g-=m,y+=m,this._leftover+=m,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(g>=16&&(m=g-g%16,this._blocks(f,y,m),y+=m,g-=m),g){for(var D=0;D<g;D++)this._buffer[this._leftover+D]=f[y+D];this._leftover+=g}return this},d.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var f=new Uint8Array(16);return this.finish(f),f},d.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},d}();i.Poly1305=s;function o(d,f){var y=new s(d);y.update(f);var g=y.digest();return y.clean(),g}i.oneTimeAuth=o;function c(d,f){return d.length!==i.DIGEST_LENGTH||f.length!==i.DIGEST_LENGTH?!1:e.equal(d,f)}i.equal=c})(ed);(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Zs,t=ed,s=lr,o=xe,c=di;i.KEY_LENGTH=32,i.NONCE_LENGTH=12,i.TAG_LENGTH=16;var d=new Uint8Array(16),f=function(){function y(g){if(this.nonceLength=i.NONCE_LENGTH,this.tagLength=i.TAG_LENGTH,g.length!==i.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(g)}return y.prototype.seal=function(g,m,D,I){if(g.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var A=new Uint8Array(16);A.set(g,A.length-g.length);var O=new Uint8Array(32);e.stream(this._key,A,O,4);var q=m.length+this.tagLength,B;if(I){if(I.length!==q)throw new Error("ChaCha20Poly1305: incorrect destination length");B=I}else B=new Uint8Array(q);return e.streamXOR(this._key,A,m,B,4),this._authenticate(B.subarray(B.length-this.tagLength,B.length),O,B.subarray(0,B.length-this.tagLength),D),s.wipe(A),B},y.prototype.open=function(g,m,D,I){if(g.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(m.length<this.tagLength)return null;var A=new Uint8Array(16);A.set(g,A.length-g.length);var O=new Uint8Array(32);e.stream(this._key,A,O,4);var q=new Uint8Array(this.tagLength);if(this._authenticate(q,O,m.subarray(0,m.length-this.tagLength),D),!c.equal(q,m.subarray(m.length-this.tagLength,m.length)))return null;var B=m.length-this.tagLength,te;if(I){if(I.length!==B)throw new Error("ChaCha20Poly1305: incorrect destination length");te=I}else te=new Uint8Array(B);return e.streamXOR(this._key,A,m.subarray(0,m.length-this.tagLength),te,4),s.wipe(A),te},y.prototype.clean=function(){return s.wipe(this._key),this},y.prototype._authenticate=function(g,m,D,I){var A=new t.Poly1305(m);I&&(A.update(I),I.length%16>0&&A.update(d.subarray(I.length%16))),A.update(D),D.length%16>0&&A.update(d.subarray(D.length%16));var O=new Uint8Array(8);I&&o.writeUint64LE(I.length,O),A.update(O),o.writeUint64LE(D.length,O),A.update(O);for(var q=A.digest(),B=0;B<q.length;B++)g[B]=q[B];A.clean(),s.wipe(q),s.wipe(O)},y}();i.ChaCha20Poly1305=f})(pc);var rd={},Hn={},gc={};Object.defineProperty(gc,"__esModule",{value:!0});function tb(i){return typeof i.saveState<"u"&&typeof i.restoreState<"u"&&typeof i.cleanSavedState<"u"}gc.isSerializableHash=tb;Object.defineProperty(Hn,"__esModule",{value:!0});var Tr=gc,rb=di,ib=lr,id=function(){function i(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(s).clean():s.set(t);for(var o=0;o<s.length;o++)s[o]^=54;this._inner.update(s);for(var o=0;o<s.length;o++)s[o]^=106;this._outer.update(s),Tr.isSerializableHash(this._inner)&&Tr.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),ib.wipe(s)}return i.prototype.reset=function(){if(!Tr.isSerializableHash(this._inner)||!Tr.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.clean=function(){Tr.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Tr.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},i.prototype.update=function(e){return this._inner.update(e),this},i.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},i.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},i.prototype.saveState=function(){if(!Tr.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},i.prototype.restoreState=function(e){if(!Tr.isSerializableHash(this._inner)||!Tr.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.cleanSavedState=function(e){if(!Tr.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},i}();Hn.HMAC=id;function nb(i,e,t){var s=new id(i,e);s.update(t);var o=s.digest();return s.clean(),o}Hn.hmac=nb;Hn.equal=rb.equal;Object.defineProperty(rd,"__esModule",{value:!0});var al=Hn,cl=lr,sb=function(){function i(e,t,s,o){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=o;var c=al.hmac(this._hash,s,t);this._hmac=new al.HMAC(e,c),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return i.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},i.prototype.expand=function(e){for(var t=new Uint8Array(e),s=0;s<t.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[s]=this._buffer[this._bufpos++];return t},i.prototype.clean=function(){this._hmac.clean(),cl.wipe(this._buffer),cl.wipe(this._counter),this._bufpos=0},i}(),ob=rd.HKDF=sb,on={},eo={},to={};Object.defineProperty(to,"__esModule",{value:!0});to.BrowserRandomSource=void 0;const ul=65536;class ab{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let s=0;s<t.length;s+=ul)this._crypto.getRandomValues(t.subarray(s,s+Math.min(t.length-s,ul)));return t}}to.BrowserRandomSource=ab;function cb(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ro={};Object.defineProperty(ro,"__esModule",{value:!0});ro.NodeRandomSource=void 0;const ub=lr;class hb{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof cb<"u"){const e=I1;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(e);for(let o=0;o<s.length;o++)s[o]=t[o];return(0,ub.wipe)(t),s}}ro.NodeRandomSource=hb;Object.defineProperty(eo,"__esModule",{value:!0});eo.SystemRandomSource=void 0;const lb=to,fb=ro;class db{constructor(){if(this.isAvailable=!1,this.name="",this._source=new lb.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new fb.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}eo.SystemRandomSource=db;(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.randomStringForEntropy=i.randomString=i.randomUint32=i.randomBytes=i.defaultRandomSource=void 0;const e=eo,t=xe,s=lr;i.defaultRandomSource=new e.SystemRandomSource;function o(g,m=i.defaultRandomSource){return m.randomBytes(g)}i.randomBytes=o;function c(g=i.defaultRandomSource){const m=o(4,g),D=(0,t.readUint32LE)(m);return(0,s.wipe)(m),D}i.randomUint32=c;const d="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function f(g,m=d,D=i.defaultRandomSource){if(m.length<2)throw new Error("randomString charset is too short");if(m.length>256)throw new Error("randomString charset is too long");let I="";const A=m.length,O=256-256%A;for(;g>0;){const q=o(Math.ceil(g*256/O),D);for(let B=0;B<q.length&&g>0;B++){const te=q[B];te<O&&(I+=m.charAt(te%A),g--)}(0,s.wipe)(q)}return I}i.randomString=f;function y(g,m=d,D=i.defaultRandomSource){const I=Math.ceil(g/(Math.log(m.length)/Math.LN2));return f(I,m,D)}i.randomStringForEntropy=y})(on);var io={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=xe,t=lr;i.DIGEST_LENGTH=32,i.BLOCK_SIZE=64;var s=function(){function f(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},f.prototype.update=function(y,g){if(g===void 0&&(g=y.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var m=0;if(this._bytesHashed+=g,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&g>0;)this._buffer[this._bufferLength++]=y[m++],g--;this._bufferLength===this.blockSize&&(c(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(g>=this.blockSize&&(m=c(this._temp,this._state,y,m,g),g%=this.blockSize);g>0;)this._buffer[this._bufferLength++]=y[m++],g--;return this},f.prototype.finish=function(y){if(!this._finished){var g=this._bytesHashed,m=this._bufferLength,D=g/536870912|0,I=g<<3,A=g%64<56?64:128;this._buffer[m]=128;for(var O=m+1;O<A-8;O++)this._buffer[O]=0;e.writeUint32BE(D,this._buffer,A-8),e.writeUint32BE(I,this._buffer,A-4),c(this._temp,this._state,this._buffer,0,A),this._finished=!0}for(var O=0;O<this.digestLength/4;O++)e.writeUint32BE(this._state[O],y,O*4);return this},f.prototype.digest=function(){var y=new Uint8Array(this.digestLength);return this.finish(y),y},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(y){return this._state.set(y.state),this._bufferLength=y.bufferLength,y.buffer&&this._buffer.set(y.buffer),this._bytesHashed=y.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(y){t.wipe(y.state),y.buffer&&t.wipe(y.buffer),y.bufferLength=0,y.bytesHashed=0},f}();i.SHA256=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function c(f,y,g,m,D){for(;D>=64;){for(var I=y[0],A=y[1],O=y[2],q=y[3],B=y[4],te=y[5],T=y[6],L=y[7],x=0;x<16;x++){var C=m+x*4;f[x]=e.readUint32BE(g,C)}for(var x=16;x<64;x++){var E=f[x-2],u=(E>>>17|E<<15)^(E>>>19|E<<13)^E>>>10;E=f[x-15];var b=(E>>>7|E<<25)^(E>>>18|E<<14)^E>>>3;f[x]=(u+f[x-7]|0)+(b+f[x-16]|0)}for(var x=0;x<64;x++){var u=(((B>>>6|B<<26)^(B>>>11|B<<21)^(B>>>25|B<<7))+(B&te^~B&T)|0)+(L+(o[x]+f[x]|0)|0)|0,b=((I>>>2|I<<30)^(I>>>13|I<<19)^(I>>>22|I<<10))+(I&A^I&O^A&O)|0;L=T,T=te,te=B,B=q+u|0,q=O,O=A,A=I,I=u+b|0}y[0]+=I,y[1]+=A,y[2]+=O,y[3]+=q,y[4]+=B,y[5]+=te,y[6]+=T,y[7]+=L,m+=64,D-=64}return m}function d(f){var y=new s;y.update(f);var g=y.digest();return y.clean(),g}i.hash=d})(io);var yc={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.sharedKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.scalarMultBase=i.scalarMult=i.SHARED_KEY_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=void 0;const e=on,t=lr;i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=32,i.SHARED_KEY_LENGTH=32;function s(x){const C=new Float64Array(16);if(x)for(let E=0;E<x.length;E++)C[E]=x[E];return C}const o=new Uint8Array(32);o[0]=9;const c=s([56129,1]);function d(x){let C=1;for(let E=0;E<16;E++){let u=x[E]+C+65535;C=Math.floor(u/65536),x[E]=u-C*65536}x[0]+=C-1+37*(C-1)}function f(x,C,E){const u=~(E-1);for(let b=0;b<16;b++){const K=u&(x[b]^C[b]);x[b]^=K,C[b]^=K}}function y(x,C){const E=s(),u=s();for(let b=0;b<16;b++)u[b]=C[b];d(u),d(u),d(u);for(let b=0;b<2;b++){E[0]=u[0]-65517;for(let W=1;W<15;W++)E[W]=u[W]-65535-(E[W-1]>>16&1),E[W-1]&=65535;E[15]=u[15]-32767-(E[14]>>16&1);const K=E[15]>>16&1;E[14]&=65535,f(u,E,1-K)}for(let b=0;b<16;b++)x[2*b]=u[b]&255,x[2*b+1]=u[b]>>8}function g(x,C){for(let E=0;E<16;E++)x[E]=C[2*E]+(C[2*E+1]<<8);x[15]&=32767}function m(x,C,E){for(let u=0;u<16;u++)x[u]=C[u]+E[u]}function D(x,C,E){for(let u=0;u<16;u++)x[u]=C[u]-E[u]}function I(x,C,E){let u,b,K=0,W=0,re=0,ae=0,ue=0,_=0,P=0,X=0,J=0,H=0,k=0,G=0,Z=0,ve=0,ie=0,me=0,we=0,ye=0,j=0,F=0,U=0,l=0,R=0,ne=0,ce=0,be=0,Me=0,Be=0,Te=0,at=0,ct=0,$e=E[0],_e=E[1],Pe=E[2],Ce=E[3],Le=E[4],Ie=E[5],Ae=E[6],Ee=E[7],Re=E[8],qe=E[9],He=E[10],Ke=E[11],Ve=E[12],We=E[13],Ge=E[14],Je=E[15];u=C[0],K+=u*$e,W+=u*_e,re+=u*Pe,ae+=u*Ce,ue+=u*Le,_+=u*Ie,P+=u*Ae,X+=u*Ee,J+=u*Re,H+=u*qe,k+=u*He,G+=u*Ke,Z+=u*Ve,ve+=u*We,ie+=u*Ge,me+=u*Je,u=C[1],W+=u*$e,re+=u*_e,ae+=u*Pe,ue+=u*Ce,_+=u*Le,P+=u*Ie,X+=u*Ae,J+=u*Ee,H+=u*Re,k+=u*qe,G+=u*He,Z+=u*Ke,ve+=u*Ve,ie+=u*We,me+=u*Ge,we+=u*Je,u=C[2],re+=u*$e,ae+=u*_e,ue+=u*Pe,_+=u*Ce,P+=u*Le,X+=u*Ie,J+=u*Ae,H+=u*Ee,k+=u*Re,G+=u*qe,Z+=u*He,ve+=u*Ke,ie+=u*Ve,me+=u*We,we+=u*Ge,ye+=u*Je,u=C[3],ae+=u*$e,ue+=u*_e,_+=u*Pe,P+=u*Ce,X+=u*Le,J+=u*Ie,H+=u*Ae,k+=u*Ee,G+=u*Re,Z+=u*qe,ve+=u*He,ie+=u*Ke,me+=u*Ve,we+=u*We,ye+=u*Ge,j+=u*Je,u=C[4],ue+=u*$e,_+=u*_e,P+=u*Pe,X+=u*Ce,J+=u*Le,H+=u*Ie,k+=u*Ae,G+=u*Ee,Z+=u*Re,ve+=u*qe,ie+=u*He,me+=u*Ke,we+=u*Ve,ye+=u*We,j+=u*Ge,F+=u*Je,u=C[5],_+=u*$e,P+=u*_e,X+=u*Pe,J+=u*Ce,H+=u*Le,k+=u*Ie,G+=u*Ae,Z+=u*Ee,ve+=u*Re,ie+=u*qe,me+=u*He,we+=u*Ke,ye+=u*Ve,j+=u*We,F+=u*Ge,U+=u*Je,u=C[6],P+=u*$e,X+=u*_e,J+=u*Pe,H+=u*Ce,k+=u*Le,G+=u*Ie,Z+=u*Ae,ve+=u*Ee,ie+=u*Re,me+=u*qe,we+=u*He,ye+=u*Ke,j+=u*Ve,F+=u*We,U+=u*Ge,l+=u*Je,u=C[7],X+=u*$e,J+=u*_e,H+=u*Pe,k+=u*Ce,G+=u*Le,Z+=u*Ie,ve+=u*Ae,ie+=u*Ee,me+=u*Re,we+=u*qe,ye+=u*He,j+=u*Ke,F+=u*Ve,U+=u*We,l+=u*Ge,R+=u*Je,u=C[8],J+=u*$e,H+=u*_e,k+=u*Pe,G+=u*Ce,Z+=u*Le,ve+=u*Ie,ie+=u*Ae,me+=u*Ee,we+=u*Re,ye+=u*qe,j+=u*He,F+=u*Ke,U+=u*Ve,l+=u*We,R+=u*Ge,ne+=u*Je,u=C[9],H+=u*$e,k+=u*_e,G+=u*Pe,Z+=u*Ce,ve+=u*Le,ie+=u*Ie,me+=u*Ae,we+=u*Ee,ye+=u*Re,j+=u*qe,F+=u*He,U+=u*Ke,l+=u*Ve,R+=u*We,ne+=u*Ge,ce+=u*Je,u=C[10],k+=u*$e,G+=u*_e,Z+=u*Pe,ve+=u*Ce,ie+=u*Le,me+=u*Ie,we+=u*Ae,ye+=u*Ee,j+=u*Re,F+=u*qe,U+=u*He,l+=u*Ke,R+=u*Ve,ne+=u*We,ce+=u*Ge,be+=u*Je,u=C[11],G+=u*$e,Z+=u*_e,ve+=u*Pe,ie+=u*Ce,me+=u*Le,we+=u*Ie,ye+=u*Ae,j+=u*Ee,F+=u*Re,U+=u*qe,l+=u*He,R+=u*Ke,ne+=u*Ve,ce+=u*We,be+=u*Ge,Me+=u*Je,u=C[12],Z+=u*$e,ve+=u*_e,ie+=u*Pe,me+=u*Ce,we+=u*Le,ye+=u*Ie,j+=u*Ae,F+=u*Ee,U+=u*Re,l+=u*qe,R+=u*He,ne+=u*Ke,ce+=u*Ve,be+=u*We,Me+=u*Ge,Be+=u*Je,u=C[13],ve+=u*$e,ie+=u*_e,me+=u*Pe,we+=u*Ce,ye+=u*Le,j+=u*Ie,F+=u*Ae,U+=u*Ee,l+=u*Re,R+=u*qe,ne+=u*He,ce+=u*Ke,be+=u*Ve,Me+=u*We,Be+=u*Ge,Te+=u*Je,u=C[14],ie+=u*$e,me+=u*_e,we+=u*Pe,ye+=u*Ce,j+=u*Le,F+=u*Ie,U+=u*Ae,l+=u*Ee,R+=u*Re,ne+=u*qe,ce+=u*He,be+=u*Ke,Me+=u*Ve,Be+=u*We,Te+=u*Ge,at+=u*Je,u=C[15],me+=u*$e,we+=u*_e,ye+=u*Pe,j+=u*Ce,F+=u*Le,U+=u*Ie,l+=u*Ae,R+=u*Ee,ne+=u*Re,ce+=u*qe,be+=u*He,Me+=u*Ke,Be+=u*Ve,Te+=u*We,at+=u*Ge,ct+=u*Je,K+=38*we,W+=38*ye,re+=38*j,ae+=38*F,ue+=38*U,_+=38*l,P+=38*R,X+=38*ne,J+=38*ce,H+=38*be,k+=38*Me,G+=38*Be,Z+=38*Te,ve+=38*at,ie+=38*ct,b=1,u=K+b+65535,b=Math.floor(u/65536),K=u-b*65536,u=W+b+65535,b=Math.floor(u/65536),W=u-b*65536,u=re+b+65535,b=Math.floor(u/65536),re=u-b*65536,u=ae+b+65535,b=Math.floor(u/65536),ae=u-b*65536,u=ue+b+65535,b=Math.floor(u/65536),ue=u-b*65536,u=_+b+65535,b=Math.floor(u/65536),_=u-b*65536,u=P+b+65535,b=Math.floor(u/65536),P=u-b*65536,u=X+b+65535,b=Math.floor(u/65536),X=u-b*65536,u=J+b+65535,b=Math.floor(u/65536),J=u-b*65536,u=H+b+65535,b=Math.floor(u/65536),H=u-b*65536,u=k+b+65535,b=Math.floor(u/65536),k=u-b*65536,u=G+b+65535,b=Math.floor(u/65536),G=u-b*65536,u=Z+b+65535,b=Math.floor(u/65536),Z=u-b*65536,u=ve+b+65535,b=Math.floor(u/65536),ve=u-b*65536,u=ie+b+65535,b=Math.floor(u/65536),ie=u-b*65536,u=me+b+65535,b=Math.floor(u/65536),me=u-b*65536,K+=b-1+37*(b-1),b=1,u=K+b+65535,b=Math.floor(u/65536),K=u-b*65536,u=W+b+65535,b=Math.floor(u/65536),W=u-b*65536,u=re+b+65535,b=Math.floor(u/65536),re=u-b*65536,u=ae+b+65535,b=Math.floor(u/65536),ae=u-b*65536,u=ue+b+65535,b=Math.floor(u/65536),ue=u-b*65536,u=_+b+65535,b=Math.floor(u/65536),_=u-b*65536,u=P+b+65535,b=Math.floor(u/65536),P=u-b*65536,u=X+b+65535,b=Math.floor(u/65536),X=u-b*65536,u=J+b+65535,b=Math.floor(u/65536),J=u-b*65536,u=H+b+65535,b=Math.floor(u/65536),H=u-b*65536,u=k+b+65535,b=Math.floor(u/65536),k=u-b*65536,u=G+b+65535,b=Math.floor(u/65536),G=u-b*65536,u=Z+b+65535,b=Math.floor(u/65536),Z=u-b*65536,u=ve+b+65535,b=Math.floor(u/65536),ve=u-b*65536,u=ie+b+65535,b=Math.floor(u/65536),ie=u-b*65536,u=me+b+65535,b=Math.floor(u/65536),me=u-b*65536,K+=b-1+37*(b-1),x[0]=K,x[1]=W,x[2]=re,x[3]=ae,x[4]=ue,x[5]=_,x[6]=P,x[7]=X,x[8]=J,x[9]=H,x[10]=k,x[11]=G,x[12]=Z,x[13]=ve,x[14]=ie,x[15]=me}function A(x,C){I(x,C,C)}function O(x,C){const E=s();for(let u=0;u<16;u++)E[u]=C[u];for(let u=253;u>=0;u--)A(E,E),u!==2&&u!==4&&I(E,E,C);for(let u=0;u<16;u++)x[u]=E[u]}function q(x,C){const E=new Uint8Array(32),u=new Float64Array(80),b=s(),K=s(),W=s(),re=s(),ae=s(),ue=s();for(let J=0;J<31;J++)E[J]=x[J];E[31]=x[31]&127|64,E[0]&=248,g(u,C);for(let J=0;J<16;J++)K[J]=u[J];b[0]=re[0]=1;for(let J=254;J>=0;--J){const H=E[J>>>3]>>>(J&7)&1;f(b,K,H),f(W,re,H),m(ae,b,W),D(b,b,W),m(W,K,re),D(K,K,re),A(re,ae),A(ue,b),I(b,W,b),I(W,K,ae),m(ae,b,W),D(b,b,W),A(K,b),D(W,re,ue),I(b,W,c),m(b,b,re),I(W,W,b),I(b,re,ue),I(re,K,u),A(K,ae),f(b,K,H),f(W,re,H)}for(let J=0;J<16;J++)u[J+16]=b[J],u[J+32]=W[J],u[J+48]=K[J],u[J+64]=re[J];const _=u.subarray(32),P=u.subarray(16);O(_,_),I(P,P,_);const X=new Uint8Array(32);return y(X,P),X}i.scalarMult=q;function B(x){return q(x,o)}i.scalarMultBase=B;function te(x){if(x.length!==i.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${i.SECRET_KEY_LENGTH} bytes`);const C=new Uint8Array(x);return{publicKey:B(C),secretKey:C}}i.generateKeyPairFromSeed=te;function T(x){const C=(0,e.randomBytes)(32,x),E=te(C);return(0,t.wipe)(C),E}i.generateKeyPair=T;function L(x,C,E=!1){if(x.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(C.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const u=q(x,C);if(E){let b=0;for(let K=0;K<u.length;K++)b|=u[K];if(b===0)throw new Error("X25519: invalid shared key")}return u}i.sharedKey=L})(yc);function vc(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function nd(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?vc(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function Ya(i,e){e||(e=i.reduce((o,c)=>o+c.length,0));const t=nd(e);let s=0;for(const o of i)t.set(o,s),s+=o.length;return vc(t)}function pb(i,e){if(i.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<i.length;o++){var c=i.charAt(o),d=c.charCodeAt(0);if(t[d]!==255)throw new TypeError(c+" is ambiguous");t[d]=o}var f=i.length,y=i.charAt(0),g=Math.log(f)/Math.log(256),m=Math.log(256)/Math.log(f);function D(O){if(O instanceof Uint8Array||(ArrayBuffer.isView(O)?O=new Uint8Array(O.buffer,O.byteOffset,O.byteLength):Array.isArray(O)&&(O=Uint8Array.from(O))),!(O instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(O.length===0)return"";for(var q=0,B=0,te=0,T=O.length;te!==T&&O[te]===0;)te++,q++;for(var L=(T-te)*m+1>>>0,x=new Uint8Array(L);te!==T;){for(var C=O[te],E=0,u=L-1;(C!==0||E<B)&&u!==-1;u--,E++)C+=256*x[u]>>>0,x[u]=C%f>>>0,C=C/f>>>0;if(C!==0)throw new Error("Non-zero carry");B=E,te++}for(var b=L-B;b!==L&&x[b]===0;)b++;for(var K=y.repeat(q);b<L;++b)K+=i.charAt(x[b]);return K}function I(O){if(typeof O!="string")throw new TypeError("Expected String");if(O.length===0)return new Uint8Array;var q=0;if(O[q]!==" "){for(var B=0,te=0;O[q]===y;)B++,q++;for(var T=(O.length-q)*g+1>>>0,L=new Uint8Array(T);O[q];){var x=t[O.charCodeAt(q)];if(x===255)return;for(var C=0,E=T-1;(x!==0||C<te)&&E!==-1;E--,C++)x+=f*L[E]>>>0,L[E]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");te=C,q++}if(O[q]!==" "){for(var u=T-te;u!==T&&L[u]===0;)u++;for(var b=new Uint8Array(B+(T-u)),K=B;u!==T;)b[K++]=L[u++];return b}}}function A(O){var q=I(O);if(q)return q;throw new Error(`Non-${e} character`)}return{encode:D,decodeUnsafe:I,decode:A}}var gb=pb,yb=gb;const vb=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},mb=i=>new TextEncoder().encode(i),wb=i=>new TextDecoder().decode(i);class bb{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class _b{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return sd(this,e)}}class Eb{constructor(e){this.decoders=e}or(e){return sd(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const sd=(i,e)=>new Eb({...i.decoders||{[i.prefix]:i},...e.decoders||{[e.prefix]:e}});class Db{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new bb(e,t,s),this.decoder=new _b(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const no=({name:i,prefix:e,encode:t,decode:s})=>new Db(i,e,t,s),kn=({prefix:i,name:e,alphabet:t})=>{const{encode:s,decode:o}=yb(t,e);return no({prefix:i,name:e,encode:s,decode:c=>vb(o(c))})},Ib=(i,e,t,s)=>{const o={};for(let m=0;m<e.length;++m)o[e[m]]=m;let c=i.length;for(;i[c-1]==="=";)--c;const d=new Uint8Array(c*t/8|0);let f=0,y=0,g=0;for(let m=0;m<c;++m){const D=o[i[m]];if(D===void 0)throw new SyntaxError(`Non-${s} character`);y=y<<t|D,f+=t,f>=8&&(f-=8,d[g++]=255&y>>f)}if(f>=t||255&y<<8-f)throw new SyntaxError("Unexpected end of data");return d},Sb=(i,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let c="",d=0,f=0;for(let y=0;y<i.length;++y)for(f=f<<8|i[y],d+=8;d>t;)d-=t,c+=e[o&f>>d];if(d&&(c+=e[o&f<<t-d]),s)for(;c.length*t&7;)c+="=";return c},Lt=({name:i,prefix:e,bitsPerChar:t,alphabet:s})=>no({prefix:e,name:i,encode(o){return Sb(o,s,t)},decode(o){return Ib(o,s,t,i)}}),xb=no({prefix:"\0",name:"identity",encode:i=>wb(i),decode:i=>mb(i)}),Ob=Object.freeze(Object.defineProperty({__proto__:null,identity:xb},Symbol.toStringTag,{value:"Module"})),Pb=Lt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Cb=Object.freeze(Object.defineProperty({__proto__:null,base2:Pb},Symbol.toStringTag,{value:"Module"})),Ab=Lt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Rb=Object.freeze(Object.defineProperty({__proto__:null,base8:Ab},Symbol.toStringTag,{value:"Module"})),Nb=kn({prefix:"9",name:"base10",alphabet:"0123456789"}),Tb=Object.freeze(Object.defineProperty({__proto__:null,base10:Nb},Symbol.toStringTag,{value:"Module"})),Ub=Lt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),$b=Lt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Lb=Object.freeze(Object.defineProperty({__proto__:null,base16:Ub,base16upper:$b},Symbol.toStringTag,{value:"Module"})),Mb=Lt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),jb=Lt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),qb=Lt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Fb=Lt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),zb=Lt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Bb=Lt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Hb=Lt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),kb=Lt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Kb=Lt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Vb=Object.freeze(Object.defineProperty({__proto__:null,base32:Mb,base32hex:zb,base32hexpad:Hb,base32hexpadupper:kb,base32hexupper:Bb,base32pad:qb,base32padupper:Fb,base32upper:jb,base32z:Kb},Symbol.toStringTag,{value:"Module"})),Wb=kn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Gb=kn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Yb=Object.freeze(Object.defineProperty({__proto__:null,base36:Wb,base36upper:Gb},Symbol.toStringTag,{value:"Module"})),Jb=kn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Qb=kn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Xb=Object.freeze(Object.defineProperty({__proto__:null,base58btc:Jb,base58flickr:Qb},Symbol.toStringTag,{value:"Module"})),Zb=Lt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),e_=Lt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),t_=Lt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),r_=Lt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),i_=Object.freeze(Object.defineProperty({__proto__:null,base64:Zb,base64pad:e_,base64url:t_,base64urlpad:r_},Symbol.toStringTag,{value:"Module"})),od=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),n_=od.reduce((i,e,t)=>(i[t]=e,i),[]),s_=od.reduce((i,e,t)=>(i[e.codePointAt(0)]=t,i),[]);function o_(i){return i.reduce((e,t)=>(e+=n_[t],e),"")}function a_(i){const e=[];for(const t of i){const s=s_[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const c_=no({prefix:"🚀",name:"base256emoji",encode:o_,decode:a_}),u_=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:c_},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const hl={...Ob,...Cb,...Rb,...Tb,...Lb,...Vb,...Yb,...Xb,...i_,...u_};function ad(i,e,t,s){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:t},decoder:{decode:s}}}const ll=ad("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),_a=ad("ascii","a",i=>{let e="a";for(let t=0;t<i.length;t++)e+=String.fromCharCode(i[t]);return e},i=>{i=i.substring(1);const e=nd(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e}),cd={utf8:ll,"utf-8":ll,hex:hl.base16,latin1:_a,ascii:_a,binary:_a,...hl};function rr(i,e="utf8"){const t=cd[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?vc(globalThis.Buffer.from(i,"utf-8")):t.decoder.decode(`${t.prefix}${i}`)}function Yt(i,e="utf8"){const t=cd[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(i.buffer,i.byteOffset,i.byteLength).toString("utf8"):t.encoder.encode(i).substring(1)}var fl=function(i,e,t){if(t||arguments.length===2)for(var s=0,o=e.length,c;s<o;s++)(c||!(s in e))&&(c||(c=Array.prototype.slice.call(e,0,s)),c[s]=e[s]);return i.concat(c||Array.prototype.slice.call(e))},h_=function(){function i(e,t,s){this.name=e,this.version=t,this.os=s,this.type="browser"}return i}(),l_=function(){function i(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return i}(),f_=function(){function i(e,t,s,o){this.name=e,this.version=t,this.os=s,this.bot=o,this.type="bot-device"}return i}(),d_=function(){function i(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return i}(),p_=function(){function i(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return i}(),g_=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,y_=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,dl=3,v_=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",g_]],pl=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function m_(i){return i?gl(i):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new p_:typeof navigator<"u"?gl(navigator.userAgent):__()}function w_(i){return i!==""&&v_.reduce(function(e,t){var s=t[0],o=t[1];if(e)return e;var c=o.exec(i);return!!c&&[s,c]},!1)}function gl(i){var e=w_(i);if(!e)return null;var t=e[0],s=e[1];if(t==="searchbot")return new d_;var o=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);o?o.length<dl&&(o=fl(fl([],o,!0),E_(dl-o.length),!0)):o=[];var c=o.join("."),d=b_(i),f=y_.exec(i);return f&&f[1]?new f_(t,c,d,f[1]):new h_(t,c,d)}function b_(i){for(var e=0,t=pl.length;e<t;e++){var s=pl[e],o=s[0],c=s[1],d=c.exec(i);if(d)return o}return null}function __(){var i=typeof process<"u"&&process.version;return i?new l_(process.version.slice(1)):null}function E_(i){for(var e=[],t=0;t<i;t++)e.push("0");return e}var fe={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ja=function(i,e){return Ja=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},Ja(i,e)};function D_(i,e){Ja(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Qa=function(){return Qa=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Qa.apply(this,arguments)};function I_(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function S_(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(d=i[f])&&(c=(o<3?d(c):o>3?d(e,t,c):d(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function x_(i,e){return function(t,s){e(t,s,i)}}function O_(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function P_(i,e,t,s){function o(c){return c instanceof t?c:new t(function(d){d(c)})}return new(t||(t=Promise))(function(c,d){function f(m){try{g(s.next(m))}catch(D){d(D)}}function y(m){try{g(s.throw(m))}catch(D){d(D)}}function g(m){m.done?c(m.value):o(m.value).then(f,y)}g((s=s.apply(i,e||[])).next())})}function C_(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,d;return d={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function f(g){return function(m){return y([g,m])}}function y(g){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=g[0]&2?o.return:g[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,g[1])).done)return c;switch(o=0,c&&(g=[g[0]&2,c.value]),g[0]){case 0:case 1:c=g;break;case 4:return t.label++,{value:g[1],done:!1};case 5:t.label++,o=g[1],g=[0];continue;case 7:g=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(g[0]===6||g[0]===2)){t=0;continue}if(g[0]===3&&(!c||g[1]>c[0]&&g[1]<c[3])){t.label=g[1];break}if(g[0]===6&&t.label<c[1]){t.label=c[1],c=g;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(g);break}c[2]&&t.ops.pop(),t.trys.pop();continue}g=e.call(i,t)}catch(m){g=[6,m],o=0}finally{s=c=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}}function A_(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function R_(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function Xa(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ud(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],d;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){d={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(d)throw d.error}}return c}function N_(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(ud(arguments[e]));return i}function T_(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],d=0,f=c.length;d<f;d++,o++)s[o]=c[d];return s}function qn(i){return this instanceof qn?(this.v=i,this):new qn(i)}function U_(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},d("next"),d("throw"),d("return"),o[Symbol.asyncIterator]=function(){return this},o;function d(I){s[I]&&(o[I]=function(A){return new Promise(function(O,q){c.push([I,A,O,q])>1||f(I,A)})})}function f(I,A){try{y(s[I](A))}catch(O){D(c[0][3],O)}}function y(I){I.value instanceof qn?Promise.resolve(I.value.v).then(g,m):D(c[0][2],I)}function g(I){f("next",I)}function m(I){f("throw",I)}function D(I,A){I(A),c.shift(),c.length&&f(c[0][0],c[0][1])}}function $_(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(d){return(t=!t)?{value:qn(i[o](d)),done:o==="return"}:c?c(d):d}:c}}function L_(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof Xa=="function"?Xa(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(d){return new Promise(function(f,y){d=i[c](d),o(f,y,d.done,d.value)})}}function o(c,d,f,y){Promise.resolve(y).then(function(g){c({value:g,done:f})},d)}}function M_(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function j_(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function q_(i){return i&&i.__esModule?i:{default:i}}function F_(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function z_(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const B_=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Qa},__asyncDelegator:$_,__asyncGenerator:U_,__asyncValues:L_,__await:qn,__awaiter:P_,__classPrivateFieldGet:F_,__classPrivateFieldSet:z_,__createBinding:A_,__decorate:S_,__exportStar:R_,__extends:D_,__generator:C_,__importDefault:q_,__importStar:j_,__makeTemplateObject:M_,__metadata:O_,__param:x_,__read:ud,__rest:I_,__spread:N_,__spreadArrays:T_,__values:Xa},Symbol.toStringTag,{value:"Module"})),Lr=fc(B_);var Ea={},Pn={},yl;function H_(){if(yl)return Pn;yl=1,Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.delay=void 0;function i(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return Pn.delay=i,Pn}var Si={},Da={},xi={},vl;function k_(){return vl||(vl=1,Object.defineProperty(xi,"__esModule",{value:!0}),xi.ONE_THOUSAND=xi.ONE_HUNDRED=void 0,xi.ONE_HUNDRED=100,xi.ONE_THOUSAND=1e3),xi}var Ia={},ml;function K_(){return ml||(ml=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ONE_YEAR=i.FOUR_WEEKS=i.THREE_WEEKS=i.TWO_WEEKS=i.ONE_WEEK=i.THIRTY_DAYS=i.SEVEN_DAYS=i.FIVE_DAYS=i.THREE_DAYS=i.ONE_DAY=i.TWENTY_FOUR_HOURS=i.TWELVE_HOURS=i.SIX_HOURS=i.THREE_HOURS=i.ONE_HOUR=i.SIXTY_MINUTES=i.THIRTY_MINUTES=i.TEN_MINUTES=i.FIVE_MINUTES=i.ONE_MINUTE=i.SIXTY_SECONDS=i.THIRTY_SECONDS=i.TEN_SECONDS=i.FIVE_SECONDS=i.ONE_SECOND=void 0,i.ONE_SECOND=1,i.FIVE_SECONDS=5,i.TEN_SECONDS=10,i.THIRTY_SECONDS=30,i.SIXTY_SECONDS=60,i.ONE_MINUTE=i.SIXTY_SECONDS,i.FIVE_MINUTES=i.ONE_MINUTE*5,i.TEN_MINUTES=i.ONE_MINUTE*10,i.THIRTY_MINUTES=i.ONE_MINUTE*30,i.SIXTY_MINUTES=i.ONE_MINUTE*60,i.ONE_HOUR=i.SIXTY_MINUTES,i.THREE_HOURS=i.ONE_HOUR*3,i.SIX_HOURS=i.ONE_HOUR*6,i.TWELVE_HOURS=i.ONE_HOUR*12,i.TWENTY_FOUR_HOURS=i.ONE_HOUR*24,i.ONE_DAY=i.TWENTY_FOUR_HOURS,i.THREE_DAYS=i.ONE_DAY*3,i.FIVE_DAYS=i.ONE_DAY*5,i.SEVEN_DAYS=i.ONE_DAY*7,i.THIRTY_DAYS=i.ONE_DAY*30,i.ONE_WEEK=i.SEVEN_DAYS,i.TWO_WEEKS=i.ONE_WEEK*2,i.THREE_WEEKS=i.ONE_WEEK*3,i.FOUR_WEEKS=i.ONE_WEEK*4,i.ONE_YEAR=i.ONE_DAY*365}(Ia)),Ia}var wl;function hd(){return wl||(wl=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=Lr;e.__exportStar(k_(),i),e.__exportStar(K_(),i)}(Da)),Da}var bl;function V_(){if(bl)return Si;bl=1,Object.defineProperty(Si,"__esModule",{value:!0}),Si.fromMiliseconds=Si.toMiliseconds=void 0;const i=hd();function e(s){return s*i.ONE_THOUSAND}Si.toMiliseconds=e;function t(s){return Math.floor(s/i.ONE_THOUSAND)}return Si.fromMiliseconds=t,Si}var _l;function W_(){return _l||(_l=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=Lr;e.__exportStar(H_(),i),e.__exportStar(V_(),i)}(Ea)),Ea}var Zi={},El;function G_(){if(El)return Zi;El=1,Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.Watch=void 0;class i{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const s=this.get(t);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const o=Date.now()-s.started;this.timestamps.set(t,{started:s.started,elapsed:o})}get(t){const s=this.timestamps.get(t);if(typeof s>"u")throw new Error(`No timestamp found for label: ${t}`);return s}elapsed(t){const s=this.get(t);return s.elapsed||Date.now()-s.started}}return Zi.Watch=i,Zi.default=i,Zi}var Sa={},Cn={},Dl;function Y_(){if(Dl)return Cn;Dl=1,Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.IWatch=void 0;class i{}return Cn.IWatch=i,Cn}var Il;function J_(){return Il||(Il=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),Lr.__exportStar(Y_(),i)}(Sa)),Sa}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=Lr;e.__exportStar(W_(),i),e.__exportStar(G_(),i),e.__exportStar(J_(),i),e.__exportStar(hd(),i)})(fe);var tt={};Object.defineProperty(tt,"__esModule",{value:!0});tt.getLocalStorage=tt.getLocalStorageOrThrow=tt.getCrypto=tt.getCryptoOrThrow=ld=tt.getLocation=tt.getLocationOrThrow=wc=tt.getNavigator=tt.getNavigatorOrThrow=mc=tt.getDocument=tt.getDocumentOrThrow=tt.getFromWindowOrThrow=tt.getFromWindow=void 0;function Ni(i){let e;return typeof window<"u"&&typeof window[i]<"u"&&(e=window[i]),e}tt.getFromWindow=Ni;function an(i){const e=Ni(i);if(!e)throw new Error(`${i} is not defined in Window`);return e}tt.getFromWindowOrThrow=an;function Q_(){return an("document")}tt.getDocumentOrThrow=Q_;function X_(){return Ni("document")}var mc=tt.getDocument=X_;function Z_(){return an("navigator")}tt.getNavigatorOrThrow=Z_;function eE(){return Ni("navigator")}var wc=tt.getNavigator=eE;function tE(){return an("location")}tt.getLocationOrThrow=tE;function rE(){return Ni("location")}var ld=tt.getLocation=rE;function iE(){return an("crypto")}tt.getCryptoOrThrow=iE;function nE(){return Ni("crypto")}tt.getCrypto=nE;function sE(){return an("localStorage")}tt.getLocalStorageOrThrow=sE;function oE(){return Ni("localStorage")}tt.getLocalStorage=oE;var bc={};Object.defineProperty(bc,"__esModule",{value:!0});var fd=bc.getWindowMetadata=void 0;const Sl=tt;function aE(){let i,e;try{i=Sl.getDocumentOrThrow(),e=Sl.getLocationOrThrow()}catch{return null}function t(){const D=i.getElementsByTagName("link"),I=[];for(let A=0;A<D.length;A++){const O=D[A],q=O.getAttribute("rel");if(q&&q.toLowerCase().indexOf("icon")>-1){const B=O.getAttribute("href");if(B)if(B.toLowerCase().indexOf("https:")===-1&&B.toLowerCase().indexOf("http:")===-1&&B.indexOf("//")!==0){let te=e.protocol+"//"+e.host;if(B.indexOf("/")===0)te+=B;else{const T=e.pathname.split("/");T.pop();const L=T.join("/");te+=L+"/"+B}I.push(te)}else if(B.indexOf("//")===0){const te=e.protocol+B;I.push(te)}else I.push(B)}}return I}function s(...D){const I=i.getElementsByTagName("meta");for(let A=0;A<I.length;A++){const O=I[A],q=["itemprop","property","name"].map(B=>O.getAttribute(B)).filter(B=>B?D.includes(B):!1);if(q.length&&q){const B=O.getAttribute("content");if(B)return B}}return""}function o(){let D=s("name","og:site_name","og:title","twitter:title");return D||(D=i.title),D}function c(){return s("description","og:description","twitter:description","keywords")}const d=o(),f=c(),y=e.origin,g=t();return{description:f,url:y,icons:g,name:d}}fd=bc.getWindowMetadata=aE;var Fn={},cE=i=>encodeURIComponent(i).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),dd="%[a-f0-9]{2}",xl=new RegExp("("+dd+")|([^%]+?)","gi"),Ol=new RegExp("("+dd+")+","gi");function Za(i,e){try{return[decodeURIComponent(i.join(""))]}catch{}if(i.length===1)return i;e=e||1;var t=i.slice(0,e),s=i.slice(e);return Array.prototype.concat.call([],Za(t),Za(s))}function uE(i){try{return decodeURIComponent(i)}catch{for(var e=i.match(xl)||[],t=1;t<e.length;t++)i=Za(e,t).join(""),e=i.match(xl)||[];return i}}function hE(i){for(var e={"%FE%FF":"��","%FF%FE":"��"},t=Ol.exec(i);t;){try{e[t[0]]=decodeURIComponent(t[0])}catch{var s=uE(t[0]);s!==t[0]&&(e[t[0]]=s)}t=Ol.exec(i)}e["%C2"]="�";for(var o=Object.keys(e),c=0;c<o.length;c++){var d=o[c];i=i.replace(new RegExp(d,"g"),e[d])}return i}var lE=function(i){if(typeof i!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof i+"`");try{return i=i.replace(/\+/g," "),decodeURIComponent(i)}catch{return hE(i)}},fE=(i,e)=>{if(!(typeof i=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[i];const t=i.indexOf(e);return t===-1?[i]:[i.slice(0,t),i.slice(t+e.length)]},dE=function(i,e){for(var t={},s=Object.keys(i),o=Array.isArray(e),c=0;c<s.length;c++){var d=s[c],f=i[d];(o?e.indexOf(d)!==-1:e(d,f,i))&&(t[d]=f)}return t};(function(i){const e=cE,t=lE,s=fE,o=dE,c=T=>T==null,d=Symbol("encodeFragmentIdentifier");function f(T){switch(T.arrayFormat){case"index":return L=>(x,C)=>{const E=x.length;return C===void 0||T.skipNull&&C===null||T.skipEmptyString&&C===""?x:C===null?[...x,[m(L,T),"[",E,"]"].join("")]:[...x,[m(L,T),"[",m(E,T),"]=",m(C,T)].join("")]};case"bracket":return L=>(x,C)=>C===void 0||T.skipNull&&C===null||T.skipEmptyString&&C===""?x:C===null?[...x,[m(L,T),"[]"].join("")]:[...x,[m(L,T),"[]=",m(C,T)].join("")];case"colon-list-separator":return L=>(x,C)=>C===void 0||T.skipNull&&C===null||T.skipEmptyString&&C===""?x:C===null?[...x,[m(L,T),":list="].join("")]:[...x,[m(L,T),":list=",m(C,T)].join("")];case"comma":case"separator":case"bracket-separator":{const L=T.arrayFormat==="bracket-separator"?"[]=":"=";return x=>(C,E)=>E===void 0||T.skipNull&&E===null||T.skipEmptyString&&E===""?C:(E=E===null?"":E,C.length===0?[[m(x,T),L,m(E,T)].join("")]:[[C,m(E,T)].join(T.arrayFormatSeparator)])}default:return L=>(x,C)=>C===void 0||T.skipNull&&C===null||T.skipEmptyString&&C===""?x:C===null?[...x,m(L,T)]:[...x,[m(L,T),"=",m(C,T)].join("")]}}function y(T){let L;switch(T.arrayFormat){case"index":return(x,C,E)=>{if(L=/\[(\d*)\]$/.exec(x),x=x.replace(/\[\d*\]$/,""),!L){E[x]=C;return}E[x]===void 0&&(E[x]={}),E[x][L[1]]=C};case"bracket":return(x,C,E)=>{if(L=/(\[\])$/.exec(x),x=x.replace(/\[\]$/,""),!L){E[x]=C;return}if(E[x]===void 0){E[x]=[C];return}E[x]=[].concat(E[x],C)};case"colon-list-separator":return(x,C,E)=>{if(L=/(:list)$/.exec(x),x=x.replace(/:list$/,""),!L){E[x]=C;return}if(E[x]===void 0){E[x]=[C];return}E[x]=[].concat(E[x],C)};case"comma":case"separator":return(x,C,E)=>{const u=typeof C=="string"&&C.includes(T.arrayFormatSeparator),b=typeof C=="string"&&!u&&D(C,T).includes(T.arrayFormatSeparator);C=b?D(C,T):C;const K=u||b?C.split(T.arrayFormatSeparator).map(W=>D(W,T)):C===null?C:D(C,T);E[x]=K};case"bracket-separator":return(x,C,E)=>{const u=/(\[\])$/.test(x);if(x=x.replace(/\[\]$/,""),!u){E[x]=C&&D(C,T);return}const b=C===null?[]:C.split(T.arrayFormatSeparator).map(K=>D(K,T));if(E[x]===void 0){E[x]=b;return}E[x]=[].concat(E[x],b)};default:return(x,C,E)=>{if(E[x]===void 0){E[x]=C;return}E[x]=[].concat(E[x],C)}}}function g(T){if(typeof T!="string"||T.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function m(T,L){return L.encode?L.strict?e(T):encodeURIComponent(T):T}function D(T,L){return L.decode?t(T):T}function I(T){return Array.isArray(T)?T.sort():typeof T=="object"?I(Object.keys(T)).sort((L,x)=>Number(L)-Number(x)).map(L=>T[L]):T}function A(T){const L=T.indexOf("#");return L!==-1&&(T=T.slice(0,L)),T}function O(T){let L="";const x=T.indexOf("#");return x!==-1&&(L=T.slice(x)),L}function q(T){T=A(T);const L=T.indexOf("?");return L===-1?"":T.slice(L+1)}function B(T,L){return L.parseNumbers&&!Number.isNaN(Number(T))&&typeof T=="string"&&T.trim()!==""?T=Number(T):L.parseBooleans&&T!==null&&(T.toLowerCase()==="true"||T.toLowerCase()==="false")&&(T=T.toLowerCase()==="true"),T}function te(T,L){L=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},L),g(L.arrayFormatSeparator);const x=y(L),C=Object.create(null);if(typeof T!="string"||(T=T.trim().replace(/^[?#&]/,""),!T))return C;for(const E of T.split("&")){if(E==="")continue;let[u,b]=s(L.decode?E.replace(/\+/g," "):E,"=");b=b===void 0?null:["comma","separator","bracket-separator"].includes(L.arrayFormat)?b:D(b,L),x(D(u,L),b,C)}for(const E of Object.keys(C)){const u=C[E];if(typeof u=="object"&&u!==null)for(const b of Object.keys(u))u[b]=B(u[b],L);else C[E]=B(u,L)}return L.sort===!1?C:(L.sort===!0?Object.keys(C).sort():Object.keys(C).sort(L.sort)).reduce((E,u)=>{const b=C[u];return b&&typeof b=="object"&&!Array.isArray(b)?E[u]=I(b):E[u]=b,E},Object.create(null))}i.extract=q,i.parse=te,i.stringify=(T,L)=>{if(!T)return"";L=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},L),g(L.arrayFormatSeparator);const x=b=>L.skipNull&&c(T[b])||L.skipEmptyString&&T[b]==="",C=f(L),E={};for(const b of Object.keys(T))x(b)||(E[b]=T[b]);const u=Object.keys(E);return L.sort!==!1&&u.sort(L.sort),u.map(b=>{const K=T[b];return K===void 0?"":K===null?m(b,L):Array.isArray(K)?K.length===0&&L.arrayFormat==="bracket-separator"?m(b,L)+"[]":K.reduce(C(b),[]).join("&"):m(b,L)+"="+m(K,L)}).filter(b=>b.length>0).join("&")},i.parseUrl=(T,L)=>{L=Object.assign({decode:!0},L);const[x,C]=s(T,"#");return Object.assign({url:x.split("?")[0]||"",query:te(q(T),L)},L&&L.parseFragmentIdentifier&&C?{fragmentIdentifier:D(C,L)}:{})},i.stringifyUrl=(T,L)=>{L=Object.assign({encode:!0,strict:!0,[d]:!0},L);const x=A(T.url).split("?")[0]||"",C=i.extract(T.url),E=i.parse(C,{sort:!1}),u=Object.assign(E,T.query);let b=i.stringify(u,L);b&&(b=`?${b}`);let K=O(T.url);return T.fragmentIdentifier&&(K=`#${L[d]?m(T.fragmentIdentifier,L):T.fragmentIdentifier}`),`${x}${b}${K}`},i.pick=(T,L,x)=>{x=Object.assign({parseFragmentIdentifier:!0,[d]:!1},x);const{url:C,query:E,fragmentIdentifier:u}=i.parseUrl(T,x);return i.stringifyUrl({url:C,query:o(E,L),fragmentIdentifier:u},x)},i.exclude=(T,L,x)=>{const C=Array.isArray(L)?E=>!L.includes(E):(E,u)=>!L(E,u);return i.pick(T,C,x)}})(Fn);const pE={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}},gE=":";function yE(i){const[e,t]=i.split(gE);return{namespace:e,reference:t}}function vE(i,e=[]){const t=[];return Object.keys(i).forEach(s=>{if(e.length&&!e.includes(s))return;const o=i[s];t.push(...o.accounts)}),t}function pd(i,e){return i.includes(":")?[i]:e.chains||[]}const gd="base10",Gt="base16",ec="base64pad",_c="utf8",yd=0,Ti=1,mE=0,Pl=1,tc=12,Ec=32;function wE(){const i=yc.generateKeyPair();return{privateKey:Yt(i.secretKey,Gt),publicKey:Yt(i.publicKey,Gt)}}function rc(){const i=on.randomBytes(Ec);return Yt(i,Gt)}function bE(i,e){const t=yc.sharedKey(rr(i,Gt),rr(e,Gt),!0),s=new ob(io.SHA256,t).expand(Ec);return Yt(s,Gt)}function _E(i){const e=io.hash(rr(i,Gt));return Yt(e,Gt)}function nn(i){const e=io.hash(rr(i,_c));return Yt(e,Gt)}function EE(i){return rr(`${i}`,gd)}function Kn(i){return Number(Yt(i,gd))}function DE(i){const e=EE(typeof i.type<"u"?i.type:yd);if(Kn(e)===Ti&&typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof i.senderPublicKey<"u"?rr(i.senderPublicKey,Gt):void 0,s=typeof i.iv<"u"?rr(i.iv,Gt):on.randomBytes(tc),o=new pc.ChaCha20Poly1305(rr(i.symKey,Gt)).seal(s,rr(i.message,_c));return SE({type:e,sealed:o,iv:s,senderPublicKey:t})}function IE(i){const e=new pc.ChaCha20Poly1305(rr(i.symKey,Gt)),{sealed:t,iv:s}=Ys(i.encoded),o=e.open(s,t);if(o===null)throw new Error("Failed to decrypt");return Yt(o,_c)}function SE(i){if(Kn(i.type)===Ti){if(typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Yt(Ya([i.type,i.senderPublicKey,i.iv,i.sealed]),ec)}return Yt(Ya([i.type,i.iv,i.sealed]),ec)}function Ys(i){const e=rr(i,ec),t=e.slice(mE,Pl),s=Pl;if(Kn(t)===Ti){const f=s+Ec,y=f+tc,g=e.slice(s,f),m=e.slice(f,y),D=e.slice(y);return{type:t,sealed:D,iv:m,senderPublicKey:g}}const o=s+tc,c=e.slice(s,o),d=e.slice(o);return{type:t,sealed:d,iv:c}}function xE(i,e){const t=Ys(i);return vd({type:Kn(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?Yt(t.senderPublicKey,Gt):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function vd(i){const e=(i==null?void 0:i.type)||yd;if(e===Ti){if(typeof(i==null?void 0:i.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(i==null?void 0:i.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:i==null?void 0:i.senderPublicKey,receiverPublicKey:i==null?void 0:i.receiverPublicKey}}function Cl(i){return i.type===Ti&&typeof i.senderPublicKey=="string"&&typeof i.receiverPublicKey=="string"}var OE=Object.defineProperty,Al=Object.getOwnPropertySymbols,PE=Object.prototype.hasOwnProperty,CE=Object.prototype.propertyIsEnumerable,Rl=(i,e,t)=>e in i?OE(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Nl=(i,e)=>{for(var t in e||(e={}))PE.call(e,t)&&Rl(i,t,e[t]);if(Al)for(var t of Al(e))CE.call(e,t)&&Rl(i,t,e[t]);return i};const AE="ReactNative",hr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},RE="js";function Dc(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function cn(){return!mc()&&!!wc()&&navigator.product===AE}function un(){return!Dc()&&!!wc()&&!!mc()}function Vn(){return cn()?hr.reactNative:Dc()?hr.node:un()?hr.browser:hr.unknown}function NE(){var i;try{return cn()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(i=global.Application)==null?void 0:i.applicationId:void 0}catch{return}}function TE(i,e){let t=Fn.parse(i);return t=Nl(Nl({},t),e),i=Fn.stringify(t),i}function UE(){return fd()||{name:"",description:"",url:"",icons:[""]}}function $E(){if(Vn()===hr.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:s}=global.Platform;return[t,s].join("-")}const i=m_();if(i===null)return"unknown";const e=i.os?i.os.replace(" ","").toLowerCase():"unknown";return i.type==="browser"?[e,i.name,i.version].join("-"):[e,i.version].join("-")}function LE(){var i;const e=Vn();return e===hr.browser?[e,((i=ld())==null?void 0:i.host)||"unknown"].join(":"):e}function ME(i,e,t){const s=$E(),o=LE();return[[i,e].join("-"),[RE,t].join("-"),s,o].join("/")}function jE({protocol:i,version:e,relayUrl:t,sdkVersion:s,auth:o,projectId:c,useOnCloseEvent:d,bundleId:f}){const y=t.split("?"),g=ME(i,e,s),m={auth:o,ua:g,projectId:c,useOnCloseEvent:d||void 0,origin:f||void 0},D=TE(y[1]||"",m);return y[0]+"?"+D}function Ai(i,e){return i.filter(t=>e.includes(t)).length===i.length}function md(i){return Object.fromEntries(i.entries())}function wd(i){return new Map(Object.entries(i))}function tn(i=fe.FIVE_MINUTES,e){const t=fe.toMiliseconds(i||fe.FIVE_MINUTES);let s,o,c;return{resolve:d=>{c&&s&&(clearTimeout(c),s(d))},reject:d=>{c&&o&&(clearTimeout(c),o(d))},done:()=>new Promise((d,f)=>{c=setTimeout(()=>{f(new Error(e))},t),s=d,o=f})}}function zn(i,e,t){return new Promise(async(s,o)=>{const c=setTimeout(()=>o(new Error(t)),e);try{const d=await i;s(d)}catch(d){o(d)}clearTimeout(c)})}function bd(i,e){if(typeof e=="string"&&e.startsWith(`${i}:`))return e;if(i.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(i.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${i}`)}function qE(i){return bd("topic",i)}function FE(i){return bd("id",i)}function _d(i){const[e,t]=i.split(":"),s={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")s.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))s.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return s}function ur(i,e){return fe.fromMiliseconds((e||Date.now())+fe.toMiliseconds(i))}function hi(i){return Date.now()>=fe.toMiliseconds(i)}function ft(i,e){return`${i}${e?`:${e}`:""}`}function xa(i=[],e=[]){return[...new Set([...i,...e])]}async function zE({id:i,topic:e,wcDeepLink:t}){try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t;let o=s==null?void 0:s.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const c=`${o}/wc?requestId=${i}&sessionTopic=${e}`,d=Vn();d===hr.browser?c.startsWith("https://")?window.open(c,"_blank","noreferrer noopener"):window.open(c,"_self","noreferrer noopener"):d===hr.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(c)}catch(s){console.error(s)}}async function BE(i,e){try{return await i.getItem(e)||(un()?localStorage.getItem(e):void 0)}catch(t){console.error(t)}}const HE="irn";function ic(i){return(i==null?void 0:i.relay)||{protocol:HE}}function ks(i){const e=pE[i];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${i}`);return e}var kE=Object.defineProperty,KE=Object.defineProperties,VE=Object.getOwnPropertyDescriptors,Tl=Object.getOwnPropertySymbols,WE=Object.prototype.hasOwnProperty,GE=Object.prototype.propertyIsEnumerable,Ul=(i,e,t)=>e in i?kE(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,YE=(i,e)=>{for(var t in e||(e={}))WE.call(e,t)&&Ul(i,t,e[t]);if(Tl)for(var t of Tl(e))GE.call(e,t)&&Ul(i,t,e[t]);return i},JE=(i,e)=>KE(i,VE(e));function QE(i,e="-"){const t={},s="relay"+e;return Object.keys(i).forEach(o=>{if(o.startsWith(s)){const c=o.replace(s,""),d=i[o];t[c]=d}}),t}function $l(i){i=i.includes("wc://")?i.replace("wc://",""):i,i=i.includes("wc:")?i.replace("wc:",""):i;const e=i.indexOf(":"),t=i.indexOf("?")!==-1?i.indexOf("?"):void 0,s=i.substring(0,e),o=i.substring(e+1,t).split("@"),c=typeof t<"u"?i.substring(t):"",d=Fn.parse(c);return{protocol:s,topic:XE(o[0]),version:parseInt(o[1],10),symKey:d.symKey,relay:QE(d),expiryTimestamp:d.expiryTimestamp?parseInt(d.expiryTimestamp,10):void 0}}function XE(i){return i.startsWith("//")?i.substring(2):i}function ZE(i,e="-"){const t="relay",s={};return Object.keys(i).forEach(o=>{const c=t+e+o;i[o]&&(s[c]=i[o])}),s}function eD(i){return`${i.protocol}:${i.topic}@${i.version}?`+Fn.stringify(JE(YE({symKey:i.symKey},ZE(i.relay)),{expiryTimestamp:i.expiryTimestamp}))}function hn(i){const e=[];return i.forEach(t=>{const[s,o]=t.split(":");e.push(`${s}:${o}`)}),e}function tD(i){const e=[];return Object.values(i).forEach(t=>{e.push(...hn(t.accounts))}),e}function rD(i,e){const t=[];return Object.values(i).forEach(s=>{hn(s.accounts).includes(e)&&t.push(...s.methods)}),t}function iD(i,e){const t=[];return Object.values(i).forEach(s=>{hn(s.accounts).includes(e)&&t.push(...s.events)}),t}function Ic(i){return i.includes(":")}function $n(i){return Ic(i)?i.split(":")[0]:i}const nD={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},sD={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function se(i,e){const{message:t,code:s}=sD[i];return{message:e?`${t} ${e}`:t,code:s}}function nt(i,e){const{message:t,code:s}=nD[i];return{message:e?`${t} ${e}`:t,code:s}}function $r(i,e){return Array.isArray(i)?typeof e<"u"&&i.length?i.every(e):!0:!1}function Bn(i){return Object.getPrototypeOf(i)===Object.prototype&&Object.keys(i).length}function Wt(i){return typeof i>"u"}function Tt(i,e){return e&&Wt(i)?!0:typeof i=="string"&&!!i.trim().length}function Sc(i,e){return e&&Wt(i)?!0:typeof i=="number"&&!isNaN(i)}function oD(i,e){const{requiredNamespaces:t}=e,s=Object.keys(i.namespaces),o=Object.keys(t);let c=!0;return Ai(o,s)?(s.forEach(d=>{const{accounts:f,methods:y,events:g}=i.namespaces[d],m=hn(f),D=t[d];(!Ai(pd(d,D),m)||!Ai(D.methods,y)||!Ai(D.events,g))&&(c=!1)}),c):!1}function Js(i){return Tt(i,!1)&&i.includes(":")?i.split(":").length===2:!1}function aD(i){if(Tt(i,!1)&&i.includes(":")){const e=i.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&Js(t)}}return!1}function cD(i){if(Tt(i,!1))try{return typeof new URL(i)<"u"}catch{return!1}return!1}function uD(i){var e;return(e=i==null?void 0:i.proposer)==null?void 0:e.publicKey}function hD(i){return i==null?void 0:i.topic}function lD(i,e){let t=null;return Tt(i==null?void 0:i.publicKey,!1)||(t=se("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function Ll(i){let e=!0;return $r(i)?i.length&&(e=i.every(t=>Tt(t,!1))):e=!1,e}function fD(i,e,t){let s=null;return $r(e)&&e.length?e.forEach(o=>{s||Js(o)||(s=nt("UNSUPPORTED_CHAINS",`${t}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):Js(i)||(s=nt("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function dD(i,e,t){let s=null;return Object.entries(i).forEach(([o,c])=>{if(s)return;const d=fD(o,pd(o,c),`${e} ${t}`);d&&(s=d)}),s}function pD(i,e){let t=null;return $r(i)?i.forEach(s=>{t||aD(s)||(t=nt("UNSUPPORTED_ACCOUNTS",`${e}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):t=nt("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function gD(i,e){let t=null;return Object.values(i).forEach(s=>{if(t)return;const o=pD(s==null?void 0:s.accounts,`${e} namespace`);o&&(t=o)}),t}function yD(i,e){let t=null;return Ll(i==null?void 0:i.methods)?Ll(i==null?void 0:i.events)||(t=nt("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=nt("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function Ed(i,e){let t=null;return Object.values(i).forEach(s=>{if(t)return;const o=yD(s,`${e}, namespace`);o&&(t=o)}),t}function vD(i,e,t){let s=null;if(i&&Bn(i)){const o=Ed(i,e);o&&(s=o);const c=dD(i,e,t);c&&(s=c)}else s=se("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return s}function Oa(i,e){let t=null;if(i&&Bn(i)){const s=Ed(i,e);s&&(t=s);const o=gD(i,e);o&&(t=o)}else t=se("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function Dd(i){return Tt(i.protocol,!0)}function mD(i,e){let t=!1;return e&&!i?t=!0:i&&$r(i)&&i.length&&i.forEach(s=>{t=Dd(s)}),t}function wD(i){return typeof i=="number"}function tr(i){return typeof i<"u"&&typeof i!==null}function bD(i){return!(!i||typeof i!="object"||!i.code||!Sc(i.code,!1)||!i.message||!Tt(i.message,!1))}function _D(i){return!(Wt(i)||!Tt(i.method,!1))}function ED(i){return!(Wt(i)||Wt(i.result)&&Wt(i.error)||!Sc(i.id,!1)||!Tt(i.jsonrpc,!1))}function DD(i){return!(Wt(i)||!Tt(i.name,!1))}function Ml(i,e){return!(!Js(e)||!tD(i).includes(e))}function ID(i,e,t){return Tt(t,!1)?rD(i,e).includes(t):!1}function SD(i,e,t){return Tt(t,!1)?iD(i,e).includes(t):!1}function jl(i,e,t){let s=null;const o=xD(i),c=OD(e),d=Object.keys(o),f=Object.keys(c),y=ql(Object.keys(i)),g=ql(Object.keys(e)),m=y.filter(D=>!g.includes(D));return m.length&&(s=se("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${m.toString()}
      Received: ${Object.keys(e).toString()}`)),Ai(d,f)||(s=se("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${d.toString()}
      Approved: ${f.toString()}`)),Object.keys(e).forEach(D=>{if(!D.includes(":")||s)return;const I=hn(e[D].accounts);I.includes(D)||(s=se("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${D}
        Required: ${D}
        Approved: ${I.toString()}`))}),d.forEach(D=>{s||(Ai(o[D].methods,c[D].methods)?Ai(o[D].events,c[D].events)||(s=se("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${D}`)):s=se("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${D}`))}),s}function xD(i){const e={};return Object.keys(i).forEach(t=>{var s;t.includes(":")?e[t]=i[t]:(s=i[t].chains)==null||s.forEach(o=>{e[o]={methods:i[t].methods,events:i[t].events}})}),e}function ql(i){return[...new Set(i.map(e=>e.includes(":")?e.split(":")[0]:e))]}function OD(i){const e={};return Object.keys(i).forEach(t=>{if(t.includes(":"))e[t]=i[t];else{const s=hn(i[t].accounts);s==null||s.forEach(o=>{e[o]={accounts:i[t].accounts.filter(c=>c.includes(`${o}:`)),methods:i[t].methods,events:i[t].events}})}}),e}function PD(i,e){return Sc(i,!1)&&i<=e.max&&i>=e.min}function Fl(){const i=Vn();return new Promise(e=>{switch(i){case hr.browser:e(CD());break;case hr.reactNative:e(AD());break;case hr.node:e(RD());break;default:e(!0)}})}function CD(){return un()&&(navigator==null?void 0:navigator.onLine)}async function AD(){if(cn()&&typeof global<"u"&&global!=null&&global.NetInfo){const i=await(global==null?void 0:global.NetInfo.fetch());return i==null?void 0:i.isConnected}return!0}function RD(){return!0}function ND(i){switch(Vn()){case hr.browser:TD(i);break;case hr.reactNative:UD(i);break}}function TD(i){!cn()&&un()&&(window.addEventListener("online",()=>i(!0)),window.addEventListener("offline",()=>i(!1)))}function UD(i){cn()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>i(e==null?void 0:e.isConnected)))}const Pa={};let js=class{static get(e){return Pa[e]}static set(e,t){Pa[e]=t}static delete(e){delete Pa[e]}};const $D=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,LD=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,MD=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function jD(i,e){if(i==="__proto__"||i==="constructor"&&e&&typeof e=="object"&&"prototype"in e){qD(i);return}return e}function qD(i){console.warn(`[destr] Dropping "${i}" key to prevent prototype pollution.`)}function qs(i,e={}){if(typeof i!="string")return i;const t=i.trim();if(i[0]==='"'&&i.endsWith('"')&&!i.includes("\\"))return t.slice(1,-1);if(t.length<=9){const s=t.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!MD.test(i)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return i}try{if($D.test(i)||LD.test(i)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(i,jD)}return JSON.parse(i)}catch(s){if(e.strict)throw s;return i}}function FD(i){return!i||typeof i.then!="function"?Promise.resolve(i):i}function Nt(i,...e){try{return FD(i(...e))}catch(t){return Promise.reject(t)}}function zD(i){const e=typeof i;return i===null||e!=="object"&&e!=="function"}function BD(i){const e=Object.getPrototypeOf(i);return!e||e.isPrototypeOf(Object)}function Ks(i){if(zD(i))return String(i);if(BD(i)||Array.isArray(i))return JSON.stringify(i);if(typeof i.toJSON=="function")return Ks(i.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Id(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const nc="base64:";function HD(i){if(typeof i=="string")return i;Id();const e=Buffer.from(i).toString("base64");return nc+e}function kD(i){return typeof i!="string"||!i.startsWith(nc)?i:(Id(),Buffer.from(i.slice(nc.length),"base64"))}function er(i){return i?i.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function KD(...i){return er(i.join(":"))}function Fs(i){return i=er(i),i?i+":":""}const VD="memory",WD=()=>{const i=new Map;return{name:VD,options:{},hasItem(e){return i.has(e)},getItem(e){return i.get(e)??null},getItemRaw(e){return i.get(e)??null},setItem(e,t){i.set(e,t)},setItemRaw(e,t){i.set(e,t)},removeItem(e){i.delete(e)},getKeys(){return Array.from(i.keys())},clear(){i.clear()},dispose(){i.clear()}}};function GD(i={}){const e={mounts:{"":i.driver||WD()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=g=>{for(const m of e.mountpoints)if(g.startsWith(m))return{base:m,relativeKey:g.slice(m.length),driver:e.mounts[m]};return{base:"",relativeKey:g,driver:e.mounts[""]}},s=(g,m)=>e.mountpoints.filter(D=>D.startsWith(g)||m&&g.startsWith(D)).map(D=>({relativeBase:g.length>D.length?g.slice(D.length):void 0,mountpoint:D,driver:e.mounts[D]})),o=(g,m)=>{if(e.watching){m=er(m);for(const D of e.watchListeners)D(g,m)}},c=async()=>{if(!e.watching){e.watching=!0;for(const g in e.mounts)e.unwatch[g]=await zl(e.mounts[g],o,g)}},d=async()=>{if(e.watching){for(const g in e.unwatch)await e.unwatch[g]();e.unwatch={},e.watching=!1}},f=(g,m,D)=>{const I=new Map,A=O=>{let q=I.get(O.base);return q||(q={driver:O.driver,base:O.base,items:[]},I.set(O.base,q)),q};for(const O of g){const q=typeof O=="string",B=er(q?O:O.key),te=q?void 0:O.value,T=q||!O.options?m:{...m,...O.options},L=t(B);A(L).items.push({key:B,value:te,relativeKey:L.relativeKey,options:T})}return Promise.all([...I.values()].map(O=>D(O))).then(O=>O.flat())},y={hasItem(g,m={}){g=er(g);const{relativeKey:D,driver:I}=t(g);return Nt(I.hasItem,D,m)},getItem(g,m={}){g=er(g);const{relativeKey:D,driver:I}=t(g);return Nt(I.getItem,D,m).then(A=>qs(A))},getItems(g,m){return f(g,m,D=>D.driver.getItems?Nt(D.driver.getItems,D.items.map(I=>({key:I.relativeKey,options:I.options})),m).then(I=>I.map(A=>({key:KD(D.base,A.key),value:qs(A.value)}))):Promise.all(D.items.map(I=>Nt(D.driver.getItem,I.relativeKey,I.options).then(A=>({key:I.key,value:qs(A)})))))},getItemRaw(g,m={}){g=er(g);const{relativeKey:D,driver:I}=t(g);return I.getItemRaw?Nt(I.getItemRaw,D,m):Nt(I.getItem,D,m).then(A=>kD(A))},async setItem(g,m,D={}){if(m===void 0)return y.removeItem(g);g=er(g);const{relativeKey:I,driver:A}=t(g);A.setItem&&(await Nt(A.setItem,I,Ks(m),D),A.watch||o("update",g))},async setItems(g,m){await f(g,m,async D=>{if(D.driver.setItems)return Nt(D.driver.setItems,D.items.map(I=>({key:I.relativeKey,value:Ks(I.value),options:I.options})),m);D.driver.setItem&&await Promise.all(D.items.map(I=>Nt(D.driver.setItem,I.relativeKey,Ks(I.value),I.options)))})},async setItemRaw(g,m,D={}){if(m===void 0)return y.removeItem(g,D);g=er(g);const{relativeKey:I,driver:A}=t(g);if(A.setItemRaw)await Nt(A.setItemRaw,I,m,D);else if(A.setItem)await Nt(A.setItem,I,HD(m),D);else return;A.watch||o("update",g)},async removeItem(g,m={}){typeof m=="boolean"&&(m={removeMeta:m}),g=er(g);const{relativeKey:D,driver:I}=t(g);I.removeItem&&(await Nt(I.removeItem,D,m),(m.removeMeta||m.removeMata)&&await Nt(I.removeItem,D+"$",m),I.watch||o("remove",g))},async getMeta(g,m={}){typeof m=="boolean"&&(m={nativeOnly:m}),g=er(g);const{relativeKey:D,driver:I}=t(g),A=Object.create(null);if(I.getMeta&&Object.assign(A,await Nt(I.getMeta,D,m)),!m.nativeOnly){const O=await Nt(I.getItem,D+"$",m).then(q=>qs(q));O&&typeof O=="object"&&(typeof O.atime=="string"&&(O.atime=new Date(O.atime)),typeof O.mtime=="string"&&(O.mtime=new Date(O.mtime)),Object.assign(A,O))}return A},setMeta(g,m,D={}){return this.setItem(g+"$",m,D)},removeMeta(g,m={}){return this.removeItem(g+"$",m)},async getKeys(g,m={}){g=Fs(g);const D=s(g,!0);let I=[];const A=[];for(const O of D){const B=(await Nt(O.driver.getKeys,O.relativeBase,m)).map(te=>O.mountpoint+er(te)).filter(te=>!I.some(T=>te.startsWith(T)));A.push(...B),I=[O.mountpoint,...I.filter(te=>!te.startsWith(O.mountpoint))]}return g?A.filter(O=>O.startsWith(g)&&!O.endsWith("$")):A.filter(O=>!O.endsWith("$"))},async clear(g,m={}){g=Fs(g),await Promise.all(s(g,!1).map(async D=>{if(D.driver.clear)return Nt(D.driver.clear,D.relativeBase,m);if(D.driver.removeItem){const I=await D.driver.getKeys(D.relativeBase||"",m);return Promise.all(I.map(A=>D.driver.removeItem(A,m)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(g=>Bl(g)))},async watch(g){return await c(),e.watchListeners.push(g),async()=>{e.watchListeners=e.watchListeners.filter(m=>m!==g),e.watchListeners.length===0&&await d()}},async unwatch(){e.watchListeners=[],await d()},mount(g,m){if(g=Fs(g),g&&e.mounts[g])throw new Error(`already mounted at ${g}`);return g&&(e.mountpoints.push(g),e.mountpoints.sort((D,I)=>I.length-D.length)),e.mounts[g]=m,e.watching&&Promise.resolve(zl(m,o,g)).then(D=>{e.unwatch[g]=D}).catch(console.error),y},async unmount(g,m=!0){g=Fs(g),!(!g||!e.mounts[g])&&(e.watching&&g in e.unwatch&&(e.unwatch[g](),delete e.unwatch[g]),m&&await Bl(e.mounts[g]),e.mountpoints=e.mountpoints.filter(D=>D!==g),delete e.mounts[g])},getMount(g=""){g=er(g)+":";const m=t(g);return{driver:m.driver,base:m.base}},getMounts(g="",m={}){return g=er(g),s(g,m.parents).map(I=>({driver:I.driver,base:I.mountpoint}))}};return y}function zl(i,e,t){return i.watch?i.watch((s,o)=>e(s,t+o)):()=>{}}async function Bl(i){typeof i.dispose=="function"&&await Nt(i.dispose)}function Ui(i){return new Promise((e,t)=>{i.oncomplete=i.onsuccess=()=>e(i.result),i.onabort=i.onerror=()=>t(i.error)})}function Sd(i,e){const t=indexedDB.open(i);t.onupgradeneeded=()=>t.result.createObjectStore(e);const s=Ui(t);return(o,c)=>s.then(d=>c(d.transaction(e,o).objectStore(e)))}let Ca;function Wn(){return Ca||(Ca=Sd("keyval-store","keyval")),Ca}function Hl(i,e=Wn()){return e("readonly",t=>Ui(t.get(i)))}function YD(i,e,t=Wn()){return t("readwrite",s=>(s.put(e,i),Ui(s.transaction)))}function JD(i,e=Wn()){return e("readwrite",t=>(t.delete(i),Ui(t.transaction)))}function QD(i=Wn()){return i("readwrite",e=>(e.clear(),Ui(e.transaction)))}function XD(i,e){return i.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Ui(i.transaction)}function ZD(i=Wn()){return i("readonly",e=>{if(e.getAllKeys)return Ui(e.getAllKeys());const t=[];return XD(e,s=>t.push(s.key)).then(()=>t)})}const e3=i=>JSON.stringify(i,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),t3=i=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=i.replace(e,'$1"$2n"$3');return JSON.parse(t,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function Gn(i){if(typeof i!="string")throw new Error(`Cannot safe json parse value of type ${typeof i}`);try{return t3(i)}catch{return i}}function Ri(i){return typeof i=="string"?i:e3(i)||""}const r3="idb-keyval";var i3=(i={})=>{const e=i.base&&i.base.length>0?`${i.base}:`:"",t=o=>e+o;let s;return i.dbName&&i.storeName&&(s=Sd(i.dbName,i.storeName)),{name:r3,options:i,async hasItem(o){return!(typeof await Hl(t(o),s)>"u")},async getItem(o){return await Hl(t(o),s)??null},setItem(o,c){return YD(t(o),c,s)},removeItem(o){return JD(t(o),s)},getKeys(){return ZD(s)},clear(){return QD(s)}}};const n3="WALLET_CONNECT_V2_INDEXED_DB",s3="keyvaluestorage";let o3=class{constructor(){this.indexedDb=GD({driver:i3({dbName:n3,storeName:s3})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,Ri(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var Aa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Vs={exports:{}};(function(){let i;function e(){}i=e,i.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},i.prototype.setItem=function(t,s){this[t]=String(s)},i.prototype.removeItem=function(t){delete this[t]},i.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(s){t[s]=void 0,delete t[s]})},i.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},i.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Aa<"u"&&Aa.localStorage?Vs.exports=Aa.localStorage:typeof window<"u"&&window.localStorage?Vs.exports=window.localStorage:Vs.exports=new e})();function a3(i){var e;return[i[0],Gn((e=i[1])!=null?e:"")]}class c3{constructor(){this.localStorage=Vs.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(a3)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return Gn(t)}async setItem(e,t){this.localStorage.setItem(e,Ri(t))}async removeItem(e){this.localStorage.removeItem(e)}}const u3="wc_storage_version",kl=1,h3=async(i,e,t)=>{const s=u3,o=await e.getItem(s);if(o&&o>=kl){t(e);return}const c=await i.getKeys();if(!c.length){t(e);return}const d=[];for(;c.length;){const f=c.shift();if(!f)continue;const y=f.toLowerCase();if(y.includes("wc@")||y.includes("walletconnect")||y.includes("wc_")||y.includes("wallet_connect")){const g=await i.getItem(f);await e.setItem(f,g),d.push(f)}}await e.setItem(s,kl),t(e),l3(i,d)},l3=async(i,e)=>{e.length&&e.forEach(async t=>{await i.removeItem(t)})};let f3=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new c3;this.storage=e;try{const t=new o3;h3(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};var ln={},An={},Ra={},Rn={};let $i=class{};const d3=Object.freeze(Object.defineProperty({__proto__:null,IEvents:$i},Symbol.toStringTag,{value:"Module"})),p3=fc(d3);var Kl;function g3(){if(Kl)return Rn;Kl=1,Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.IHeartBeat=void 0;const i=p3;class e extends i.IEvents{constructor(s){super()}}return Rn.IHeartBeat=e,Rn}var Vl;function xd(){return Vl||(Vl=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),Lr.__exportStar(g3(),i)}(Ra)),Ra}var Na={},Oi={},Wl;function y3(){if(Wl)return Oi;Wl=1,Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.HEARTBEAT_EVENTS=Oi.HEARTBEAT_INTERVAL=void 0;const i=fe;return Oi.HEARTBEAT_INTERVAL=i.FIVE_SECONDS,Oi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Oi}var Gl;function Od(){return Gl||(Gl=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),Lr.__exportStar(y3(),i)}(Na)),Na}var Yl;function v3(){if(Yl)return An;Yl=1,Object.defineProperty(An,"__esModule",{value:!0}),An.HeartBeat=void 0;const i=Lr,e=Er,t=fe,s=xd(),o=Od();class c extends s.IHeartBeat{constructor(f){super(f),this.events=new e.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(f==null?void 0:f.interval)||o.HEARTBEAT_INTERVAL}static init(f){return i.__awaiter(this,void 0,void 0,function*(){const y=new c(f);return yield y.init(),y})}init(){return i.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(f,y){this.events.on(f,y)}once(f,y){this.events.once(f,y)}off(f,y){this.events.off(f,y)}removeListener(f,y){this.events.removeListener(f,y)}initialize(){return i.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return An.HeartBeat=c,An}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=Lr;e.__exportStar(v3(),i),e.__exportStar(xd(),i),e.__exportStar(Od(),i)})(ln);var ze={},Ta,Jl;function m3(){if(Jl)return Ta;Jl=1;function i(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}Ta=e;function e(t,s,o){var c=o&&o.stringify||i,d=1;if(typeof t=="object"&&t!==null){var f=s.length+d;if(f===1)return t;var y=new Array(f);y[0]=c(t);for(var g=1;g<f;g++)y[g]=c(s[g]);return y.join(" ")}if(typeof t!="string")return t;var m=s.length;if(m===0)return t;for(var D="",I=1-d,A=-1,O=t&&t.length||0,q=0;q<O;){if(t.charCodeAt(q)===37&&q+1<O){switch(A=A>-1?A:0,t.charCodeAt(q+1)){case 100:case 102:if(I>=m||s[I]==null)break;A<q&&(D+=t.slice(A,q)),D+=Number(s[I]),A=q+2,q++;break;case 105:if(I>=m||s[I]==null)break;A<q&&(D+=t.slice(A,q)),D+=Math.floor(Number(s[I])),A=q+2,q++;break;case 79:case 111:case 106:if(I>=m||s[I]===void 0)break;A<q&&(D+=t.slice(A,q));var B=typeof s[I];if(B==="string"){D+="'"+s[I]+"'",A=q+2,q++;break}if(B==="function"){D+=s[I].name||"<anonymous>",A=q+2,q++;break}D+=c(s[I]),A=q+2,q++;break;case 115:if(I>=m)break;A<q&&(D+=t.slice(A,q)),D+=String(s[I]),A=q+2,q++;break;case 37:A<q&&(D+=t.slice(A,q)),D+="%",A=q+2,q++,I--;break}++I}++q}return A===-1?t:(A<O&&(D+=t.slice(A)),D)}return Ta}var Ua,Ql;function w3(){if(Ql)return Ua;Ql=1;const i=m3();Ua=o;const e=C().console||{},t={mapHttpRequest:O,mapHttpResponse:O,wrapRequestSerializer:q,wrapResponseSerializer:q,wrapErrorSerializer:q,req:O,res:O,err:I};function s(E,u){return Array.isArray(E)?E.filter(function(K){return K!=="!stdSerializers.err"}):E===!0?Object.keys(u):!1}function o(E){E=E||{},E.browser=E.browser||{};const u=E.browser.transmit;if(u&&typeof u.send!="function")throw Error("pino: transmit option must have a send function");const b=E.browser.write||e;E.browser.write&&(E.browser.asObject=!0);const K=E.serializers||{},W=s(E.browser.serialize,K);let re=E.browser.serialize;Array.isArray(E.browser.serialize)&&E.browser.serialize.indexOf("!stdSerializers.err")>-1&&(re=!1);const ae=["error","fatal","warn","info","debug","trace"];typeof b=="function"&&(b.error=b.fatal=b.warn=b.info=b.debug=b.trace=b),E.enabled===!1&&(E.level="silent");const ue=E.level||"info",_=Object.create(b);_.log||(_.log=B),Object.defineProperty(_,"levelVal",{get:X}),Object.defineProperty(_,"level",{get:J,set:H});const P={transmit:u,serialize:W,asObject:E.browser.asObject,levels:ae,timestamp:A(E)};_.levels=o.levels,_.level=ue,_.setMaxListeners=_.getMaxListeners=_.emit=_.addListener=_.on=_.prependListener=_.once=_.prependOnceListener=_.removeListener=_.removeAllListeners=_.listeners=_.listenerCount=_.eventNames=_.write=_.flush=B,_.serializers=K,_._serialize=W,_._stdErrSerialize=re,_.child=k,u&&(_._logEvent=D());function X(){return this.level==="silent"?1/0:this.levels.values[this.level]}function J(){return this._level}function H(G){if(G!=="silent"&&!this.levels.values[G])throw Error("unknown level "+G);this._level=G,c(P,_,"error","log"),c(P,_,"fatal","error"),c(P,_,"warn","error"),c(P,_,"info","log"),c(P,_,"debug","log"),c(P,_,"trace","log")}function k(G,Z){if(!G)throw new Error("missing bindings for child Pino");Z=Z||{},W&&G.serializers&&(Z.serializers=G.serializers);const ve=Z.serializers;if(W&&ve){var ie=Object.assign({},K,ve),me=E.browser.serialize===!0?Object.keys(ie):W;delete G.serializers,y([G],me,ie,this._stdErrSerialize)}function we(ye){this._childLevel=(ye._childLevel|0)+1,this.error=g(ye,G,"error"),this.fatal=g(ye,G,"fatal"),this.warn=g(ye,G,"warn"),this.info=g(ye,G,"info"),this.debug=g(ye,G,"debug"),this.trace=g(ye,G,"trace"),ie&&(this.serializers=ie,this._serialize=me),u&&(this._logEvent=D([].concat(ye._logEvent.bindings,G)))}return we.prototype=this,new we(this)}return _}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=t,o.stdTimeFunctions=Object.assign({},{nullTime:te,epochTime:T,unixTime:L,isoTime:x});function c(E,u,b,K){const W=Object.getPrototypeOf(u);u[b]=u.levelVal>u.levels.values[b]?B:W[b]?W[b]:e[b]||e[K]||B,d(E,u,b)}function d(E,u,b){!E.transmit&&u[b]===B||(u[b]=function(K){return function(){const re=E.timestamp(),ae=new Array(arguments.length),ue=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var _=0;_<ae.length;_++)ae[_]=arguments[_];if(E.serialize&&!E.asObject&&y(ae,this._serialize,this.serializers,this._stdErrSerialize),E.asObject?K.call(ue,f(this,b,ae,re)):K.apply(ue,ae),E.transmit){const P=E.transmit.level||u.level,X=o.levels.values[P],J=o.levels.values[b];if(J<X)return;m(this,{ts:re,methodLevel:b,methodValue:J,transmitLevel:P,transmitValue:o.levels.values[E.transmit.level||u.level],send:E.transmit.send,val:u.levelVal},ae)}}}(u[b]))}function f(E,u,b,K){E._serialize&&y(b,E._serialize,E.serializers,E._stdErrSerialize);const W=b.slice();let re=W[0];const ae={};K&&(ae.time=K),ae.level=o.levels.values[u];let ue=(E._childLevel|0)+1;if(ue<1&&(ue=1),re!==null&&typeof re=="object"){for(;ue--&&typeof W[0]=="object";)Object.assign(ae,W.shift());re=W.length?i(W.shift(),W):void 0}else typeof re=="string"&&(re=i(W.shift(),W));return re!==void 0&&(ae.msg=re),ae}function y(E,u,b,K){for(const W in E)if(K&&E[W]instanceof Error)E[W]=o.stdSerializers.err(E[W]);else if(typeof E[W]=="object"&&!Array.isArray(E[W]))for(const re in E[W])u&&u.indexOf(re)>-1&&re in b&&(E[W][re]=b[re](E[W][re]))}function g(E,u,b){return function(){const K=new Array(1+arguments.length);K[0]=u;for(var W=1;W<K.length;W++)K[W]=arguments[W-1];return E[b].apply(this,K)}}function m(E,u,b){const K=u.send,W=u.ts,re=u.methodLevel,ae=u.methodValue,ue=u.val,_=E._logEvent.bindings;y(b,E._serialize||Object.keys(E.serializers),E.serializers,E._stdErrSerialize===void 0?!0:E._stdErrSerialize),E._logEvent.ts=W,E._logEvent.messages=b.filter(function(P){return _.indexOf(P)===-1}),E._logEvent.level.label=re,E._logEvent.level.value=ae,K(re,E._logEvent,ue),E._logEvent=D(_)}function D(E){return{ts:0,messages:[],bindings:E||[],level:{label:"",value:0}}}function I(E){const u={type:E.constructor.name,msg:E.message,stack:E.stack};for(const b in E)u[b]===void 0&&(u[b]=E[b]);return u}function A(E){return typeof E.timestamp=="function"?E.timestamp:E.timestamp===!1?te:T}function O(){return{}}function q(E){return E}function B(){}function te(){return!1}function T(){return Date.now()}function L(){return Math.round(Date.now()/1e3)}function x(){return new Date(Date.now()).toISOString()}function C(){function E(u){return typeof u<"u"&&u}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return E(self)||E(window)||E(this)||{}}}return Ua}var Pi={},Xl;function Pd(){return Xl||(Xl=1,Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.PINO_CUSTOM_CONTEXT_KEY=Pi.PINO_LOGGER_DEFAULTS=void 0,Pi.PINO_LOGGER_DEFAULTS={level:"info"},Pi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Pi}var Kt={},Zl;function b3(){if(Zl)return Kt;Zl=1,Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.generateChildLogger=Kt.formatChildLoggerContext=Kt.getLoggerContext=Kt.setBrowserLoggerContext=Kt.getBrowserLoggerContext=Kt.getDefaultLoggerOptions=void 0;const i=Pd();function e(f){return Object.assign(Object.assign({},f),{level:(f==null?void 0:f.level)||i.PINO_LOGGER_DEFAULTS.level})}Kt.getDefaultLoggerOptions=e;function t(f,y=i.PINO_CUSTOM_CONTEXT_KEY){return f[y]||""}Kt.getBrowserLoggerContext=t;function s(f,y,g=i.PINO_CUSTOM_CONTEXT_KEY){return f[g]=y,f}Kt.setBrowserLoggerContext=s;function o(f,y=i.PINO_CUSTOM_CONTEXT_KEY){let g="";return typeof f.bindings>"u"?g=t(f,y):g=f.bindings().context||"",g}Kt.getLoggerContext=o;function c(f,y,g=i.PINO_CUSTOM_CONTEXT_KEY){const m=o(f,g);return m.trim()?`${m}/${y}`:y}Kt.formatChildLoggerContext=c;function d(f,y,g=i.PINO_CUSTOM_CONTEXT_KEY){const m=c(f,y,g),D=f.child({context:m});return s(D,m,g)}return Kt.generateChildLogger=d,Kt}(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.pino=void 0;const e=Lr,t=e.__importDefault(w3());Object.defineProperty(i,"pino",{enumerable:!0,get:function(){return t.default}}),e.__exportStar(Pd(),i),e.__exportStar(b3(),i)})(ze);class _3 extends $i{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}let E3=class extends $i{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}},D3=class{constructor(e,t){this.logger=e,this.core=t}},I3=class extends $i{constructor(e,t){super(),this.relayer=e,this.logger=t}},S3=class extends $i{constructor(e){super()}},x3=class{constructor(e,t,s,o){this.core=e,this.logger=t,this.name=s}};class O3 extends $i{constructor(e,t){super(),this.relayer=e,this.logger=t}}let P3=class extends $i{constructor(e,t){super(),this.core=e,this.logger=t}},C3=class{constructor(e,t){this.projectId=e,this.logger=t}},A3=class{constructor(e,t){this.projectId=e,this.logger=t}},R3=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},N3=class{constructor(e){this.client=e}};var xc={},Cd={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=xe,t=lr;i.DIGEST_LENGTH=64,i.BLOCK_SIZE=128;var s=function(){function f(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},f.prototype.update=function(y,g){if(g===void 0&&(g=y.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var m=0;if(this._bytesHashed+=g,this._bufferLength>0){for(;this._bufferLength<i.BLOCK_SIZE&&g>0;)this._buffer[this._bufferLength++]=y[m++],g--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(g>=this.blockSize&&(m=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,y,m,g),g%=this.blockSize);g>0;)this._buffer[this._bufferLength++]=y[m++],g--;return this},f.prototype.finish=function(y){if(!this._finished){var g=this._bytesHashed,m=this._bufferLength,D=g/536870912|0,I=g<<3,A=g%128<112?128:256;this._buffer[m]=128;for(var O=m+1;O<A-8;O++)this._buffer[O]=0;e.writeUint32BE(D,this._buffer,A-8),e.writeUint32BE(I,this._buffer,A-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,A),this._finished=!0}for(var O=0;O<this.digestLength/8;O++)e.writeUint32BE(this._stateHi[O],y,O*8),e.writeUint32BE(this._stateLo[O],y,O*8+4);return this},f.prototype.digest=function(){var y=new Uint8Array(this.digestLength);return this.finish(y),y},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(y){return this._stateHi.set(y.stateHi),this._stateLo.set(y.stateLo),this._bufferLength=y.bufferLength,y.buffer&&this._buffer.set(y.buffer),this._bytesHashed=y.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(y){t.wipe(y.stateHi),t.wipe(y.stateLo),y.buffer&&t.wipe(y.buffer),y.bufferLength=0,y.bytesHashed=0},f}();i.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(f,y,g,m,D,I,A){for(var O=g[0],q=g[1],B=g[2],te=g[3],T=g[4],L=g[5],x=g[6],C=g[7],E=m[0],u=m[1],b=m[2],K=m[3],W=m[4],re=m[5],ae=m[6],ue=m[7],_,P,X,J,H,k,G,Z;A>=128;){for(var ve=0;ve<16;ve++){var ie=8*ve+I;f[ve]=e.readUint32BE(D,ie),y[ve]=e.readUint32BE(D,ie+4)}for(var ve=0;ve<80;ve++){var me=O,we=q,ye=B,j=te,F=T,U=L,l=x,R=C,ne=E,ce=u,be=b,Me=K,Be=W,Te=re,at=ae,ct=ue;if(_=C,P=ue,H=P&65535,k=P>>>16,G=_&65535,Z=_>>>16,_=(T>>>14|W<<18)^(T>>>18|W<<14)^(W>>>9|T<<23),P=(W>>>14|T<<18)^(W>>>18|T<<14)^(T>>>9|W<<23),H+=P&65535,k+=P>>>16,G+=_&65535,Z+=_>>>16,_=T&L^~T&x,P=W&re^~W&ae,H+=P&65535,k+=P>>>16,G+=_&65535,Z+=_>>>16,_=o[ve*2],P=o[ve*2+1],H+=P&65535,k+=P>>>16,G+=_&65535,Z+=_>>>16,_=f[ve%16],P=y[ve%16],H+=P&65535,k+=P>>>16,G+=_&65535,Z+=_>>>16,k+=H>>>16,G+=k>>>16,Z+=G>>>16,X=G&65535|Z<<16,J=H&65535|k<<16,_=X,P=J,H=P&65535,k=P>>>16,G=_&65535,Z=_>>>16,_=(O>>>28|E<<4)^(E>>>2|O<<30)^(E>>>7|O<<25),P=(E>>>28|O<<4)^(O>>>2|E<<30)^(O>>>7|E<<25),H+=P&65535,k+=P>>>16,G+=_&65535,Z+=_>>>16,_=O&q^O&B^q&B,P=E&u^E&b^u&b,H+=P&65535,k+=P>>>16,G+=_&65535,Z+=_>>>16,k+=H>>>16,G+=k>>>16,Z+=G>>>16,R=G&65535|Z<<16,ct=H&65535|k<<16,_=j,P=Me,H=P&65535,k=P>>>16,G=_&65535,Z=_>>>16,_=X,P=J,H+=P&65535,k+=P>>>16,G+=_&65535,Z+=_>>>16,k+=H>>>16,G+=k>>>16,Z+=G>>>16,j=G&65535|Z<<16,Me=H&65535|k<<16,q=me,B=we,te=ye,T=j,L=F,x=U,C=l,O=R,u=ne,b=ce,K=be,W=Me,re=Be,ae=Te,ue=at,E=ct,ve%16===15)for(var ie=0;ie<16;ie++)_=f[ie],P=y[ie],H=P&65535,k=P>>>16,G=_&65535,Z=_>>>16,_=f[(ie+9)%16],P=y[(ie+9)%16],H+=P&65535,k+=P>>>16,G+=_&65535,Z+=_>>>16,X=f[(ie+1)%16],J=y[(ie+1)%16],_=(X>>>1|J<<31)^(X>>>8|J<<24)^X>>>7,P=(J>>>1|X<<31)^(J>>>8|X<<24)^(J>>>7|X<<25),H+=P&65535,k+=P>>>16,G+=_&65535,Z+=_>>>16,X=f[(ie+14)%16],J=y[(ie+14)%16],_=(X>>>19|J<<13)^(J>>>29|X<<3)^X>>>6,P=(J>>>19|X<<13)^(X>>>29|J<<3)^(J>>>6|X<<26),H+=P&65535,k+=P>>>16,G+=_&65535,Z+=_>>>16,k+=H>>>16,G+=k>>>16,Z+=G>>>16,f[ie]=G&65535|Z<<16,y[ie]=H&65535|k<<16}_=O,P=E,H=P&65535,k=P>>>16,G=_&65535,Z=_>>>16,_=g[0],P=m[0],H+=P&65535,k+=P>>>16,G+=_&65535,Z+=_>>>16,k+=H>>>16,G+=k>>>16,Z+=G>>>16,g[0]=O=G&65535|Z<<16,m[0]=E=H&65535|k<<16,_=q,P=u,H=P&65535,k=P>>>16,G=_&65535,Z=_>>>16,_=g[1],P=m[1],H+=P&65535,k+=P>>>16,G+=_&65535,Z+=_>>>16,k+=H>>>16,G+=k>>>16,Z+=G>>>16,g[1]=q=G&65535|Z<<16,m[1]=u=H&65535|k<<16,_=B,P=b,H=P&65535,k=P>>>16,G=_&65535,Z=_>>>16,_=g[2],P=m[2],H+=P&65535,k+=P>>>16,G+=_&65535,Z+=_>>>16,k+=H>>>16,G+=k>>>16,Z+=G>>>16,g[2]=B=G&65535|Z<<16,m[2]=b=H&65535|k<<16,_=te,P=K,H=P&65535,k=P>>>16,G=_&65535,Z=_>>>16,_=g[3],P=m[3],H+=P&65535,k+=P>>>16,G+=_&65535,Z+=_>>>16,k+=H>>>16,G+=k>>>16,Z+=G>>>16,g[3]=te=G&65535|Z<<16,m[3]=K=H&65535|k<<16,_=T,P=W,H=P&65535,k=P>>>16,G=_&65535,Z=_>>>16,_=g[4],P=m[4],H+=P&65535,k+=P>>>16,G+=_&65535,Z+=_>>>16,k+=H>>>16,G+=k>>>16,Z+=G>>>16,g[4]=T=G&65535|Z<<16,m[4]=W=H&65535|k<<16,_=L,P=re,H=P&65535,k=P>>>16,G=_&65535,Z=_>>>16,_=g[5],P=m[5],H+=P&65535,k+=P>>>16,G+=_&65535,Z+=_>>>16,k+=H>>>16,G+=k>>>16,Z+=G>>>16,g[5]=L=G&65535|Z<<16,m[5]=re=H&65535|k<<16,_=x,P=ae,H=P&65535,k=P>>>16,G=_&65535,Z=_>>>16,_=g[6],P=m[6],H+=P&65535,k+=P>>>16,G+=_&65535,Z+=_>>>16,k+=H>>>16,G+=k>>>16,Z+=G>>>16,g[6]=x=G&65535|Z<<16,m[6]=ae=H&65535|k<<16,_=C,P=ue,H=P&65535,k=P>>>16,G=_&65535,Z=_>>>16,_=g[7],P=m[7],H+=P&65535,k+=P>>>16,G+=_&65535,Z+=_>>>16,k+=H>>>16,G+=k>>>16,Z+=G>>>16,g[7]=C=G&65535|Z<<16,m[7]=ue=H&65535|k<<16,I+=128,A-=128}return I}function d(f){var y=new s;y.update(f);var g=y.digest();return y.clean(),g}i.hash=d})(Cd);(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.convertSecretKeyToX25519=i.convertPublicKeyToX25519=i.verify=i.sign=i.extractPublicKeyFromSecretKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.SEED_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=i.SIGNATURE_LENGTH=void 0;const e=on,t=Cd,s=lr;i.SIGNATURE_LENGTH=64,i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=64,i.SEED_LENGTH=32;function o(j){const F=new Float64Array(16);if(j)for(let U=0;U<j.length;U++)F[U]=j[U];return F}const c=new Uint8Array(32);c[0]=9;const d=o(),f=o([1]),y=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),g=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),m=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),D=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),I=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function A(j,F){for(let U=0;U<16;U++)j[U]=F[U]|0}function O(j){let F=1;for(let U=0;U<16;U++){let l=j[U]+F+65535;F=Math.floor(l/65536),j[U]=l-F*65536}j[0]+=F-1+37*(F-1)}function q(j,F,U){const l=~(U-1);for(let R=0;R<16;R++){const ne=l&(j[R]^F[R]);j[R]^=ne,F[R]^=ne}}function B(j,F){const U=o(),l=o();for(let R=0;R<16;R++)l[R]=F[R];O(l),O(l),O(l);for(let R=0;R<2;R++){U[0]=l[0]-65517;for(let ce=1;ce<15;ce++)U[ce]=l[ce]-65535-(U[ce-1]>>16&1),U[ce-1]&=65535;U[15]=l[15]-32767-(U[14]>>16&1);const ne=U[15]>>16&1;U[14]&=65535,q(l,U,1-ne)}for(let R=0;R<16;R++)j[2*R]=l[R]&255,j[2*R+1]=l[R]>>8}function te(j,F){let U=0;for(let l=0;l<32;l++)U|=j[l]^F[l];return(1&U-1>>>8)-1}function T(j,F){const U=new Uint8Array(32),l=new Uint8Array(32);return B(U,j),B(l,F),te(U,l)}function L(j){const F=new Uint8Array(32);return B(F,j),F[0]&1}function x(j,F){for(let U=0;U<16;U++)j[U]=F[2*U]+(F[2*U+1]<<8);j[15]&=32767}function C(j,F,U){for(let l=0;l<16;l++)j[l]=F[l]+U[l]}function E(j,F,U){for(let l=0;l<16;l++)j[l]=F[l]-U[l]}function u(j,F,U){let l,R,ne=0,ce=0,be=0,Me=0,Be=0,Te=0,at=0,ct=0,$e=0,_e=0,Pe=0,Ce=0,Le=0,Ie=0,Ae=0,Ee=0,Re=0,qe=0,He=0,Ke=0,Ve=0,We=0,Ge=0,Je=0,fr=0,Dr=0,ei=0,gi=0,Mi=0,ji=0,fn=0,mt=U[0],wt=U[1],bt=U[2],_t=U[3],gt=U[4],Et=U[5],Dt=U[6],It=U[7],dt=U[8],St=U[9],pt=U[10],xt=U[11],Ot=U[12],Pt=U[13],Ct=U[14],At=U[15];l=F[0],ne+=l*mt,ce+=l*wt,be+=l*bt,Me+=l*_t,Be+=l*gt,Te+=l*Et,at+=l*Dt,ct+=l*It,$e+=l*dt,_e+=l*St,Pe+=l*pt,Ce+=l*xt,Le+=l*Ot,Ie+=l*Pt,Ae+=l*Ct,Ee+=l*At,l=F[1],ce+=l*mt,be+=l*wt,Me+=l*bt,Be+=l*_t,Te+=l*gt,at+=l*Et,ct+=l*Dt,$e+=l*It,_e+=l*dt,Pe+=l*St,Ce+=l*pt,Le+=l*xt,Ie+=l*Ot,Ae+=l*Pt,Ee+=l*Ct,Re+=l*At,l=F[2],be+=l*mt,Me+=l*wt,Be+=l*bt,Te+=l*_t,at+=l*gt,ct+=l*Et,$e+=l*Dt,_e+=l*It,Pe+=l*dt,Ce+=l*St,Le+=l*pt,Ie+=l*xt,Ae+=l*Ot,Ee+=l*Pt,Re+=l*Ct,qe+=l*At,l=F[3],Me+=l*mt,Be+=l*wt,Te+=l*bt,at+=l*_t,ct+=l*gt,$e+=l*Et,_e+=l*Dt,Pe+=l*It,Ce+=l*dt,Le+=l*St,Ie+=l*pt,Ae+=l*xt,Ee+=l*Ot,Re+=l*Pt,qe+=l*Ct,He+=l*At,l=F[4],Be+=l*mt,Te+=l*wt,at+=l*bt,ct+=l*_t,$e+=l*gt,_e+=l*Et,Pe+=l*Dt,Ce+=l*It,Le+=l*dt,Ie+=l*St,Ae+=l*pt,Ee+=l*xt,Re+=l*Ot,qe+=l*Pt,He+=l*Ct,Ke+=l*At,l=F[5],Te+=l*mt,at+=l*wt,ct+=l*bt,$e+=l*_t,_e+=l*gt,Pe+=l*Et,Ce+=l*Dt,Le+=l*It,Ie+=l*dt,Ae+=l*St,Ee+=l*pt,Re+=l*xt,qe+=l*Ot,He+=l*Pt,Ke+=l*Ct,Ve+=l*At,l=F[6],at+=l*mt,ct+=l*wt,$e+=l*bt,_e+=l*_t,Pe+=l*gt,Ce+=l*Et,Le+=l*Dt,Ie+=l*It,Ae+=l*dt,Ee+=l*St,Re+=l*pt,qe+=l*xt,He+=l*Ot,Ke+=l*Pt,Ve+=l*Ct,We+=l*At,l=F[7],ct+=l*mt,$e+=l*wt,_e+=l*bt,Pe+=l*_t,Ce+=l*gt,Le+=l*Et,Ie+=l*Dt,Ae+=l*It,Ee+=l*dt,Re+=l*St,qe+=l*pt,He+=l*xt,Ke+=l*Ot,Ve+=l*Pt,We+=l*Ct,Ge+=l*At,l=F[8],$e+=l*mt,_e+=l*wt,Pe+=l*bt,Ce+=l*_t,Le+=l*gt,Ie+=l*Et,Ae+=l*Dt,Ee+=l*It,Re+=l*dt,qe+=l*St,He+=l*pt,Ke+=l*xt,Ve+=l*Ot,We+=l*Pt,Ge+=l*Ct,Je+=l*At,l=F[9],_e+=l*mt,Pe+=l*wt,Ce+=l*bt,Le+=l*_t,Ie+=l*gt,Ae+=l*Et,Ee+=l*Dt,Re+=l*It,qe+=l*dt,He+=l*St,Ke+=l*pt,Ve+=l*xt,We+=l*Ot,Ge+=l*Pt,Je+=l*Ct,fr+=l*At,l=F[10],Pe+=l*mt,Ce+=l*wt,Le+=l*bt,Ie+=l*_t,Ae+=l*gt,Ee+=l*Et,Re+=l*Dt,qe+=l*It,He+=l*dt,Ke+=l*St,Ve+=l*pt,We+=l*xt,Ge+=l*Ot,Je+=l*Pt,fr+=l*Ct,Dr+=l*At,l=F[11],Ce+=l*mt,Le+=l*wt,Ie+=l*bt,Ae+=l*_t,Ee+=l*gt,Re+=l*Et,qe+=l*Dt,He+=l*It,Ke+=l*dt,Ve+=l*St,We+=l*pt,Ge+=l*xt,Je+=l*Ot,fr+=l*Pt,Dr+=l*Ct,ei+=l*At,l=F[12],Le+=l*mt,Ie+=l*wt,Ae+=l*bt,Ee+=l*_t,Re+=l*gt,qe+=l*Et,He+=l*Dt,Ke+=l*It,Ve+=l*dt,We+=l*St,Ge+=l*pt,Je+=l*xt,fr+=l*Ot,Dr+=l*Pt,ei+=l*Ct,gi+=l*At,l=F[13],Ie+=l*mt,Ae+=l*wt,Ee+=l*bt,Re+=l*_t,qe+=l*gt,He+=l*Et,Ke+=l*Dt,Ve+=l*It,We+=l*dt,Ge+=l*St,Je+=l*pt,fr+=l*xt,Dr+=l*Ot,ei+=l*Pt,gi+=l*Ct,Mi+=l*At,l=F[14],Ae+=l*mt,Ee+=l*wt,Re+=l*bt,qe+=l*_t,He+=l*gt,Ke+=l*Et,Ve+=l*Dt,We+=l*It,Ge+=l*dt,Je+=l*St,fr+=l*pt,Dr+=l*xt,ei+=l*Ot,gi+=l*Pt,Mi+=l*Ct,ji+=l*At,l=F[15],Ee+=l*mt,Re+=l*wt,qe+=l*bt,He+=l*_t,Ke+=l*gt,Ve+=l*Et,We+=l*Dt,Ge+=l*It,Je+=l*dt,fr+=l*St,Dr+=l*pt,ei+=l*xt,gi+=l*Ot,Mi+=l*Pt,ji+=l*Ct,fn+=l*At,ne+=38*Re,ce+=38*qe,be+=38*He,Me+=38*Ke,Be+=38*Ve,Te+=38*We,at+=38*Ge,ct+=38*Je,$e+=38*fr,_e+=38*Dr,Pe+=38*ei,Ce+=38*gi,Le+=38*Mi,Ie+=38*ji,Ae+=38*fn,R=1,l=ne+R+65535,R=Math.floor(l/65536),ne=l-R*65536,l=ce+R+65535,R=Math.floor(l/65536),ce=l-R*65536,l=be+R+65535,R=Math.floor(l/65536),be=l-R*65536,l=Me+R+65535,R=Math.floor(l/65536),Me=l-R*65536,l=Be+R+65535,R=Math.floor(l/65536),Be=l-R*65536,l=Te+R+65535,R=Math.floor(l/65536),Te=l-R*65536,l=at+R+65535,R=Math.floor(l/65536),at=l-R*65536,l=ct+R+65535,R=Math.floor(l/65536),ct=l-R*65536,l=$e+R+65535,R=Math.floor(l/65536),$e=l-R*65536,l=_e+R+65535,R=Math.floor(l/65536),_e=l-R*65536,l=Pe+R+65535,R=Math.floor(l/65536),Pe=l-R*65536,l=Ce+R+65535,R=Math.floor(l/65536),Ce=l-R*65536,l=Le+R+65535,R=Math.floor(l/65536),Le=l-R*65536,l=Ie+R+65535,R=Math.floor(l/65536),Ie=l-R*65536,l=Ae+R+65535,R=Math.floor(l/65536),Ae=l-R*65536,l=Ee+R+65535,R=Math.floor(l/65536),Ee=l-R*65536,ne+=R-1+37*(R-1),R=1,l=ne+R+65535,R=Math.floor(l/65536),ne=l-R*65536,l=ce+R+65535,R=Math.floor(l/65536),ce=l-R*65536,l=be+R+65535,R=Math.floor(l/65536),be=l-R*65536,l=Me+R+65535,R=Math.floor(l/65536),Me=l-R*65536,l=Be+R+65535,R=Math.floor(l/65536),Be=l-R*65536,l=Te+R+65535,R=Math.floor(l/65536),Te=l-R*65536,l=at+R+65535,R=Math.floor(l/65536),at=l-R*65536,l=ct+R+65535,R=Math.floor(l/65536),ct=l-R*65536,l=$e+R+65535,R=Math.floor(l/65536),$e=l-R*65536,l=_e+R+65535,R=Math.floor(l/65536),_e=l-R*65536,l=Pe+R+65535,R=Math.floor(l/65536),Pe=l-R*65536,l=Ce+R+65535,R=Math.floor(l/65536),Ce=l-R*65536,l=Le+R+65535,R=Math.floor(l/65536),Le=l-R*65536,l=Ie+R+65535,R=Math.floor(l/65536),Ie=l-R*65536,l=Ae+R+65535,R=Math.floor(l/65536),Ae=l-R*65536,l=Ee+R+65535,R=Math.floor(l/65536),Ee=l-R*65536,ne+=R-1+37*(R-1),j[0]=ne,j[1]=ce,j[2]=be,j[3]=Me,j[4]=Be,j[5]=Te,j[6]=at,j[7]=ct,j[8]=$e,j[9]=_e,j[10]=Pe,j[11]=Ce,j[12]=Le,j[13]=Ie,j[14]=Ae,j[15]=Ee}function b(j,F){u(j,F,F)}function K(j,F){const U=o();let l;for(l=0;l<16;l++)U[l]=F[l];for(l=253;l>=0;l--)b(U,U),l!==2&&l!==4&&u(U,U,F);for(l=0;l<16;l++)j[l]=U[l]}function W(j,F){const U=o();let l;for(l=0;l<16;l++)U[l]=F[l];for(l=250;l>=0;l--)b(U,U),l!==1&&u(U,U,F);for(l=0;l<16;l++)j[l]=U[l]}function re(j,F){const U=o(),l=o(),R=o(),ne=o(),ce=o(),be=o(),Me=o(),Be=o(),Te=o();E(U,j[1],j[0]),E(Te,F[1],F[0]),u(U,U,Te),C(l,j[0],j[1]),C(Te,F[0],F[1]),u(l,l,Te),u(R,j[3],F[3]),u(R,R,g),u(ne,j[2],F[2]),C(ne,ne,ne),E(ce,l,U),E(be,ne,R),C(Me,ne,R),C(Be,l,U),u(j[0],ce,be),u(j[1],Be,Me),u(j[2],Me,be),u(j[3],ce,Be)}function ae(j,F,U){for(let l=0;l<4;l++)q(j[l],F[l],U)}function ue(j,F){const U=o(),l=o(),R=o();K(R,F[2]),u(U,F[0],R),u(l,F[1],R),B(j,l),j[31]^=L(U)<<7}function _(j,F,U){A(j[0],d),A(j[1],f),A(j[2],f),A(j[3],d);for(let l=255;l>=0;--l){const R=U[l/8|0]>>(l&7)&1;ae(j,F,R),re(F,j),re(j,j),ae(j,F,R)}}function P(j,F){const U=[o(),o(),o(),o()];A(U[0],m),A(U[1],D),A(U[2],f),u(U[3],m,D),_(j,U,F)}function X(j){if(j.length!==i.SEED_LENGTH)throw new Error(`ed25519: seed must be ${i.SEED_LENGTH} bytes`);const F=(0,t.hash)(j);F[0]&=248,F[31]&=127,F[31]|=64;const U=new Uint8Array(32),l=[o(),o(),o(),o()];P(l,F),ue(U,l);const R=new Uint8Array(64);return R.set(j),R.set(U,32),{publicKey:U,secretKey:R}}i.generateKeyPairFromSeed=X;function J(j){const F=(0,e.randomBytes)(32,j),U=X(F);return(0,s.wipe)(F),U}i.generateKeyPair=J;function H(j){if(j.length!==i.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${i.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(j.subarray(32))}i.extractPublicKeyFromSecretKey=H;const k=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function G(j,F){let U,l,R,ne;for(l=63;l>=32;--l){for(U=0,R=l-32,ne=l-12;R<ne;++R)F[R]+=U-16*F[l]*k[R-(l-32)],U=Math.floor((F[R]+128)/256),F[R]-=U*256;F[R]+=U,F[l]=0}for(U=0,R=0;R<32;R++)F[R]+=U-(F[31]>>4)*k[R],U=F[R]>>8,F[R]&=255;for(R=0;R<32;R++)F[R]-=U*k[R];for(l=0;l<32;l++)F[l+1]+=F[l]>>8,j[l]=F[l]&255}function Z(j){const F=new Float64Array(64);for(let U=0;U<64;U++)F[U]=j[U];for(let U=0;U<64;U++)j[U]=0;G(j,F)}function ve(j,F){const U=new Float64Array(64),l=[o(),o(),o(),o()],R=(0,t.hash)(j.subarray(0,32));R[0]&=248,R[31]&=127,R[31]|=64;const ne=new Uint8Array(64);ne.set(R.subarray(32),32);const ce=new t.SHA512;ce.update(ne.subarray(32)),ce.update(F);const be=ce.digest();ce.clean(),Z(be),P(l,be),ue(ne,l),ce.reset(),ce.update(ne.subarray(0,32)),ce.update(j.subarray(32)),ce.update(F);const Me=ce.digest();Z(Me);for(let Be=0;Be<32;Be++)U[Be]=be[Be];for(let Be=0;Be<32;Be++)for(let Te=0;Te<32;Te++)U[Be+Te]+=Me[Be]*R[Te];return G(ne.subarray(32),U),ne}i.sign=ve;function ie(j,F){const U=o(),l=o(),R=o(),ne=o(),ce=o(),be=o(),Me=o();return A(j[2],f),x(j[1],F),b(R,j[1]),u(ne,R,y),E(R,R,j[2]),C(ne,j[2],ne),b(ce,ne),b(be,ce),u(Me,be,ce),u(U,Me,R),u(U,U,ne),W(U,U),u(U,U,R),u(U,U,ne),u(U,U,ne),u(j[0],U,ne),b(l,j[0]),u(l,l,ne),T(l,R)&&u(j[0],j[0],I),b(l,j[0]),u(l,l,ne),T(l,R)?-1:(L(j[0])===F[31]>>7&&E(j[0],d,j[0]),u(j[3],j[0],j[1]),0)}function me(j,F,U){const l=new Uint8Array(32),R=[o(),o(),o(),o()],ne=[o(),o(),o(),o()];if(U.length!==i.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${i.SIGNATURE_LENGTH} bytes`);if(ie(ne,j))return!1;const ce=new t.SHA512;ce.update(U.subarray(0,32)),ce.update(j),ce.update(F);const be=ce.digest();return Z(be),_(R,ne,be),P(ne,U.subarray(32)),re(R,ne),ue(l,R),!te(U,l)}i.verify=me;function we(j){let F=[o(),o(),o(),o()];if(ie(F,j))throw new Error("Ed25519: invalid public key");let U=o(),l=o(),R=F[1];C(U,f,R),E(l,f,R),K(l,l),u(U,U,l);let ne=new Uint8Array(32);return B(ne,U),ne}i.convertPublicKeyToX25519=we;function ye(j){const F=(0,t.hash)(j.subarray(0,32));F[0]&=248,F[31]&=127,F[31]|=64;const U=new Uint8Array(F.subarray(0,32));return(0,s.wipe)(F),U}i.convertSecretKeyToX25519=ye})(xc);const T3="EdDSA",U3="JWT",Ad=".",Rd="base64url",$3="utf8",L3="utf8",M3=":",j3="did",q3="key",ef="base58btc",F3="z",z3="K36",B3=32;function Qs(i){return Yt(rr(Ri(i),$3),Rd)}function Nd(i){const e=rr(z3,ef),t=F3+Yt(Ya([e,i]),ef);return[j3,q3,t].join(M3)}function H3(i){return Yt(i,Rd)}function k3(i){return rr([Qs(i.header),Qs(i.payload)].join(Ad),L3)}function K3(i){return[Qs(i.header),Qs(i.payload),H3(i.signature)].join(Ad)}function tf(i=on.randomBytes(B3)){return xc.generateKeyPairFromSeed(i)}async function V3(i,e,t,s,o=fe.fromMiliseconds(Date.now())){const c={alg:T3,typ:U3},d=Nd(s.publicKey),f=o+t,y={iss:d,sub:i,aud:e,iat:o,exp:f},g=k3({header:c,payload:y}),m=xc.sign(s.secretKey,g);return K3({header:c,payload:y,signature:m})}const W3="PARSE_ERROR",G3="INVALID_REQUEST",Y3="METHOD_NOT_FOUND",J3="INVALID_PARAMS",Td="INTERNAL_ERROR",Oc="SERVER_ERROR",Q3=[-32700,-32600,-32601,-32602,-32603],jn={[W3]:{code:-32700,message:"Parse error"},[G3]:{code:-32600,message:"Invalid Request"},[Y3]:{code:-32601,message:"Method not found"},[J3]:{code:-32602,message:"Invalid params"},[Td]:{code:-32603,message:"Internal error"},[Oc]:{code:-32e3,message:"Server error"}},Ud=Oc;function X3(i){return Q3.includes(i)}function rf(i){return Object.keys(jn).includes(i)?jn[i]:jn[Ud]}function Z3(i){const e=Object.values(jn).find(t=>t.code===i);return e||jn[Ud]}function $d(i,e,t){return i.message.includes("getaddrinfo ENOTFOUND")||i.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):i}var Ld={},Vr={},nf;function e6(){if(nf)return Vr;nf=1,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.isBrowserCryptoAvailable=Vr.getSubtleCrypto=Vr.getBrowerCrypto=void 0;function i(){return(Ci===null||Ci===void 0?void 0:Ci.crypto)||(Ci===null||Ci===void 0?void 0:Ci.msCrypto)||{}}Vr.getBrowerCrypto=i;function e(){const s=i();return s.subtle||s.webkitSubtle}Vr.getSubtleCrypto=e;function t(){return!!i()&&!!e()}return Vr.isBrowserCryptoAvailable=t,Vr}var Wr={},sf;function t6(){if(sf)return Wr;sf=1,Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.isBrowser=Wr.isNode=Wr.isReactNative=void 0;function i(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Wr.isReactNative=i;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Wr.isNode=e;function t(){return!i()&&!e()}return Wr.isBrowser=t,Wr}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=Lr;e.__exportStar(e6(),i),e.__exportStar(t6(),i)})(Ld);function Pc(i=3){const e=Date.now()*Math.pow(10,i),t=Math.floor(Math.random()*Math.pow(10,i));return e+t}function Md(i=6){return BigInt(Pc(i))}function sn(i,e,t){return{id:t||Pc(),jsonrpc:"2.0",method:i,params:e}}function so(i,e){return{id:i,jsonrpc:"2.0",result:e}}function oo(i,e,t){return{id:i,jsonrpc:"2.0",error:r6(e,t)}}function r6(i,e){return typeof i>"u"?rf(Td):(typeof i=="string"&&(i=Object.assign(Object.assign({},rf(Oc)),{message:i})),typeof e<"u"&&(i.data=e),X3(i.code)&&(i=Z3(i.code)),i)}class i6{}class n6 extends i6{constructor(){super()}}class s6 extends n6{constructor(e){super()}}const o6="^https?:",a6="^wss?:";function c6(i){const e=i.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function jd(i,e){const t=c6(i);return typeof t>"u"?!1:new RegExp(e).test(t)}function of(i){return jd(i,o6)}function af(i){return jd(i,a6)}function u6(i){return new RegExp("wss?://localhost(:d{2,5})?").test(i)}function qd(i){return typeof i=="object"&&"id"in i&&"jsonrpc"in i&&i.jsonrpc==="2.0"}function Cc(i){return qd(i)&&"method"in i}function ao(i){return qd(i)&&(Qr(i)||Cr(i))}function Qr(i){return"result"in i}function Cr(i){return"error"in i}class Xr extends s6{constructor(e){super(e),this.events=new Er.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(sn(e.method,e.params||[],e.id||Md().toString()),t)}async requestStrict(e,t){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${e.id}`,c=>{Cr(c)?o(c.error):s(c.result)});try{await this.connection.send(e,t)}catch(c){o(c)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),ao(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const h6=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),l6=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",cf=i=>i.split("?")[0],uf=10,f6=h6();let d6=class{constructor(e){if(this.url=e,this.events=new Er.EventEmitter,this.registering=!1,!af(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Ri(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!af(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,s)=>{const o=new URLSearchParams(e).get("origin"),c=Ld.isReactNative()?{headers:{origin:o}}:{rejectUnauthorized:!u6(e)},d=new f6(e,[],c);l6()?d.onerror=f=>{const y=f;s(this.emitError(y.error))}:d.on("error",f=>{s(this.emitError(f))}),d.onopen=()=>{this.onOpen(d),t(d)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Gn(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=oo(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return $d(e,cf(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>uf&&this.events.setMaxListeners(uf)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${cf(this.url)}`));return this.events.emit("register_error",t),t}};function p6(i,e){return e=e||{},new Promise(function(t,s){var o=new XMLHttpRequest,c=[],d=[],f={},y=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:y,headers:{keys:function(){return c},entries:function(){return d},get:function(m){return f[m.toLowerCase()]},has:function(m){return m.toLowerCase()in f}}}};for(var g in o.open(e.method||"get",i,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(m,D,I){c.push(D=D.toLowerCase()),d.push([D,I]),f[D]=f[D]?f[D]+","+I:I}),t(y())},o.onerror=s,o.withCredentials=e.credentials=="include",e.headers)o.setRequestHeader(g,e.headers[g]);o.send(e.body||null)})}const g6=Object.freeze(Object.defineProperty({__proto__:null,default:p6},Symbol.toStringTag,{value:"Module"})),hf=fc(g6);var y6=self.fetch||(self.fetch=hf.default||hf);const v6=Vf(y6);var m6={};function w6(i,e){if(i.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<i.length;o++){var c=i.charAt(o),d=c.charCodeAt(0);if(t[d]!==255)throw new TypeError(c+" is ambiguous");t[d]=o}var f=i.length,y=i.charAt(0),g=Math.log(f)/Math.log(256),m=Math.log(256)/Math.log(f);function D(O){if(O instanceof Uint8Array||(ArrayBuffer.isView(O)?O=new Uint8Array(O.buffer,O.byteOffset,O.byteLength):Array.isArray(O)&&(O=Uint8Array.from(O))),!(O instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(O.length===0)return"";for(var q=0,B=0,te=0,T=O.length;te!==T&&O[te]===0;)te++,q++;for(var L=(T-te)*m+1>>>0,x=new Uint8Array(L);te!==T;){for(var C=O[te],E=0,u=L-1;(C!==0||E<B)&&u!==-1;u--,E++)C+=256*x[u]>>>0,x[u]=C%f>>>0,C=C/f>>>0;if(C!==0)throw new Error("Non-zero carry");B=E,te++}for(var b=L-B;b!==L&&x[b]===0;)b++;for(var K=y.repeat(q);b<L;++b)K+=i.charAt(x[b]);return K}function I(O){if(typeof O!="string")throw new TypeError("Expected String");if(O.length===0)return new Uint8Array;var q=0;if(O[q]!==" "){for(var B=0,te=0;O[q]===y;)B++,q++;for(var T=(O.length-q)*g+1>>>0,L=new Uint8Array(T);O[q];){var x=t[O.charCodeAt(q)];if(x===255)return;for(var C=0,E=T-1;(x!==0||C<te)&&E!==-1;E--,C++)x+=f*L[E]>>>0,L[E]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");te=C,q++}if(O[q]!==" "){for(var u=T-te;u!==T&&L[u]===0;)u++;for(var b=new Uint8Array(B+(T-u)),K=B;u!==T;)b[K++]=L[u++];return b}}}function A(O){var q=I(O);if(q)return q;throw new Error(`Non-${e} character`)}return{encode:D,decodeUnsafe:I,decode:A}}var b6=w6,_6=b6;const Fd=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},E6=i=>new TextEncoder().encode(i),D6=i=>new TextDecoder().decode(i);class I6{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class S6{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return zd(this,e)}}class x6{constructor(e){this.decoders=e}or(e){return zd(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const zd=(i,e)=>new x6({...i.decoders||{[i.prefix]:i},...e.decoders||{[e.prefix]:e}});class O6{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new I6(e,t,s),this.decoder=new S6(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const co=({name:i,prefix:e,encode:t,decode:s})=>new O6(i,e,t,s),Yn=({prefix:i,name:e,alphabet:t})=>{const{encode:s,decode:o}=_6(t,e);return co({prefix:i,name:e,encode:s,decode:c=>Fd(o(c))})},P6=(i,e,t,s)=>{const o={};for(let m=0;m<e.length;++m)o[e[m]]=m;let c=i.length;for(;i[c-1]==="=";)--c;const d=new Uint8Array(c*t/8|0);let f=0,y=0,g=0;for(let m=0;m<c;++m){const D=o[i[m]];if(D===void 0)throw new SyntaxError(`Non-${s} character`);y=y<<t|D,f+=t,f>=8&&(f-=8,d[g++]=255&y>>f)}if(f>=t||255&y<<8-f)throw new SyntaxError("Unexpected end of data");return d},C6=(i,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let c="",d=0,f=0;for(let y=0;y<i.length;++y)for(f=f<<8|i[y],d+=8;d>t;)d-=t,c+=e[o&f>>d];if(d&&(c+=e[o&f<<t-d]),s)for(;c.length*t&7;)c+="=";return c},Mt=({name:i,prefix:e,bitsPerChar:t,alphabet:s})=>co({prefix:e,name:i,encode(o){return C6(o,s,t)},decode(o){return P6(o,s,t,i)}}),A6=co({prefix:"\0",name:"identity",encode:i=>D6(i),decode:i=>E6(i)});var R6=Object.freeze({__proto__:null,identity:A6});const N6=Mt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var T6=Object.freeze({__proto__:null,base2:N6});const U6=Mt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var $6=Object.freeze({__proto__:null,base8:U6});const L6=Yn({prefix:"9",name:"base10",alphabet:"0123456789"});var M6=Object.freeze({__proto__:null,base10:L6});const j6=Mt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),q6=Mt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var F6=Object.freeze({__proto__:null,base16:j6,base16upper:q6});const z6=Mt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),B6=Mt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),H6=Mt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),k6=Mt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),K6=Mt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),V6=Mt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),W6=Mt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),G6=Mt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Y6=Mt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var J6=Object.freeze({__proto__:null,base32:z6,base32upper:B6,base32pad:H6,base32padupper:k6,base32hex:K6,base32hexupper:V6,base32hexpad:W6,base32hexpadupper:G6,base32z:Y6});const Q6=Yn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),X6=Yn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Z6=Object.freeze({__proto__:null,base36:Q6,base36upper:X6});const e2=Yn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),t2=Yn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var r2=Object.freeze({__proto__:null,base58btc:e2,base58flickr:t2});const i2=Mt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),n2=Mt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),s2=Mt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),o2=Mt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var a2=Object.freeze({__proto__:null,base64:i2,base64pad:n2,base64url:s2,base64urlpad:o2});const Bd=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),c2=Bd.reduce((i,e,t)=>(i[t]=e,i),[]),u2=Bd.reduce((i,e,t)=>(i[e.codePointAt(0)]=t,i),[]);function h2(i){return i.reduce((e,t)=>(e+=c2[t],e),"")}function l2(i){const e=[];for(const t of i){const s=u2[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const f2=co({prefix:"🚀",name:"base256emoji",encode:h2,decode:l2});var d2=Object.freeze({__proto__:null,base256emoji:f2}),p2=Hd,lf=128,g2=127,y2=~g2,v2=Math.pow(2,31);function Hd(i,e,t){e=e||[],t=t||0;for(var s=t;i>=v2;)e[t++]=i&255|lf,i/=128;for(;i&y2;)e[t++]=i&255|lf,i>>>=7;return e[t]=i|0,Hd.bytes=t-s+1,e}var m2=sc,w2=128,ff=127;function sc(i,s){var t=0,s=s||0,o=0,c=s,d,f=i.length;do{if(c>=f)throw sc.bytes=0,new RangeError("Could not decode varint");d=i[c++],t+=o<28?(d&ff)<<o:(d&ff)*Math.pow(2,o),o+=7}while(d>=w2);return sc.bytes=c-s,t}var b2=Math.pow(2,7),_2=Math.pow(2,14),E2=Math.pow(2,21),D2=Math.pow(2,28),I2=Math.pow(2,35),S2=Math.pow(2,42),x2=Math.pow(2,49),O2=Math.pow(2,56),P2=Math.pow(2,63),C2=function(i){return i<b2?1:i<_2?2:i<E2?3:i<D2?4:i<I2?5:i<S2?6:i<x2?7:i<O2?8:i<P2?9:10},A2={encode:p2,decode:m2,encodingLength:C2},kd=A2;const df=(i,e,t=0)=>(kd.encode(i,e,t),e),pf=i=>kd.encodingLength(i),oc=(i,e)=>{const t=e.byteLength,s=pf(i),o=s+pf(t),c=new Uint8Array(o+t);return df(i,c,0),df(t,c,s),c.set(e,o),new R2(i,t,e,c)};class R2{constructor(e,t,s,o){this.code=e,this.size=t,this.digest=s,this.bytes=o}}const Kd=({name:i,code:e,encode:t})=>new N2(i,e,t);class N2{constructor(e,t,s){this.name=e,this.code=t,this.encode=s}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?oc(this.code,t):t.then(s=>oc(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Vd=i=>async e=>new Uint8Array(await crypto.subtle.digest(i,e)),T2=Kd({name:"sha2-256",code:18,encode:Vd("SHA-256")}),U2=Kd({name:"sha2-512",code:19,encode:Vd("SHA-512")});var $2=Object.freeze({__proto__:null,sha256:T2,sha512:U2});const Wd=0,L2="identity",Gd=Fd,M2=i=>oc(Wd,Gd(i)),j2={code:Wd,name:L2,encode:Gd,digest:M2};var q2=Object.freeze({__proto__:null,identity:j2});new TextEncoder,new TextDecoder;const gf={...R6,...T6,...$6,...M6,...F6,...J6,...Z6,...r2,...a2,...d2};({...$2,...q2});function Yd(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function F2(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Yd(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function Jd(i,e,t,s){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:t},decoder:{decode:s}}}const yf=Jd("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),$a=Jd("ascii","a",i=>{let e="a";for(let t=0;t<i.length;t++)e+=String.fromCharCode(i[t]);return e},i=>{i=i.substring(1);const e=F2(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e}),z2={utf8:yf,"utf-8":yf,hex:gf.base16,latin1:$a,ascii:$a,binary:$a,...gf};function B2(i,e="utf8"){const t=z2[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Yd(globalThis.Buffer.from(i,"utf-8")):t.decoder.decode(`${t.prefix}${i}`)}const Qd="wc",H2=2,Ac="core",li=`${Qd}@2:${Ac}:`,k2={name:Ac,logger:"error"},K2={database:":memory:"},V2="crypto",vf="client_ed25519_seed",W2=fe.ONE_DAY,G2="keychain",Y2="0.3",J2="messages",Q2="0.3",X2=fe.SIX_HOURS,Z2="publisher",Xd="irn",eI="error",Zd="wss://relay.walletconnect.com",mf="wss://relay.walletconnect.org",tI="relayer",zt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},rI="_subscription",Gr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},iI=fe.ONE_SECOND,nI="2.11.2",sI=1e4,oI="0.3",aI="WALLETCONNECT_CLIENT_ID",Pr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},cI="subscription",uI="0.3",hI=fe.FIVE_SECONDS*1e3,lI="pairing",fI="0.3",Nn={wc_pairingDelete:{req:{ttl:fe.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:fe.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:fe.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:fe.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:fe.ONE_DAY,prompt:!1,tag:0},res:{ttl:fe.ONE_DAY,prompt:!1,tag:0}}},Ln={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Ur={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},dI="history",pI="0.3",gI="expirer",_r={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},yI="0.3",La="verify-api",rn="https://verify.walletconnect.com",ac="https://verify.walletconnect.org",vI=[rn,ac],mI="echo",wI="https://echo.walletconnect.com";class bI{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=G2,this.version=Y2,this.initialized=!1,this.storagePrefix=li,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:c}=se("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(c)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=e,this.logger=ze.generateChildLogger(t,this.name)}get context(){return ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,md(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?wd(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}}class _I{constructor(e,t,s){this.core=e,this.logger=t,this.name=V2,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),c=tf(o);return Nd(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=wE();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const c=await this.getClientSeed(),d=tf(c),f=rc();return await V3(f,o,W2,d)},this.generateSharedKey=(o,c,d)=>{this.isInitialized();const f=this.getPrivateKey(o),y=bE(f,c);return this.setSymKey(y,d)},this.setSymKey=async(o,c)=>{this.isInitialized();const d=c||_E(o);return await this.keychain.set(d,o),d},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,c,d)=>{this.isInitialized();const f=vd(d),y=Ri(c);if(Cl(f)){const I=f.senderPublicKey,A=f.receiverPublicKey;o=await this.generateSharedKey(I,A)}const g=this.getSymKey(o),{type:m,senderPublicKey:D}=f;return DE({type:m,symKey:g,message:y,senderPublicKey:D})},this.decode=async(o,c,d)=>{this.isInitialized();const f=xE(c,d);if(Cl(f)){const y=f.receiverPublicKey,g=f.senderPublicKey;o=await this.generateSharedKey(y,g)}try{const y=this.getSymKey(o),g=IE({symKey:y,encoded:c});return Gn(g)}catch(y){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(y)}},this.getPayloadType=o=>{const c=Ys(o);return Kn(c.type)},this.getPayloadSenderPublicKey=o=>{const c=Ys(o);return c.senderPublicKey?Yt(c.senderPublicKey,Gt):void 0},this.core=e,this.logger=ze.generateChildLogger(t,this.name),this.keychain=s||new bI(this.core,this.logger)}get context(){return ze.getLoggerContext(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(vf)}catch{e=rc(),await this.keychain.set(vf,e)}return B2(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}}class EI extends D3{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=J2,this.version=Q2,this.initialized=!1,this.storagePrefix=li,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const c=nn(o);let d=this.messages.get(s);return typeof d>"u"&&(d={}),typeof d[c]<"u"||(d[c]=o,this.messages.set(s,d),await this.persist()),c},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const c=this.get(s),d=nn(o);return typeof c[d]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=ze.generateChildLogger(e,this.name),this.core=t}get context(){return ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,md(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?wd(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}}class DI extends I3{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new Er.EventEmitter,this.name=Z2,this.queue=new Map,this.publishTimeout=fe.toMiliseconds(fe.TEN_SECONDS*2),this.needsTransportRestart=!1,this.publish=async(s,o,c)=>{var d;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}});try{const f=(c==null?void 0:c.ttl)||X2,y=ic(c),g=(c==null?void 0:c.prompt)||!1,m=(c==null?void 0:c.tag)||0,D=(c==null?void 0:c.id)||Md().toString(),I={topic:s,message:o,opts:{ttl:f,relay:y,prompt:g,tag:m,id:D}},A=setTimeout(()=>this.queue.set(D,I),this.publishTimeout);try{await await zn(this.rpcPublish(s,o,f,y,g,m,D),this.publishTimeout,`Failed to publish payload, please try again. id:${D} tag:${m}`),this.removeRequestFromQueue(D),this.relayer.events.emit(zt.publish,I)}catch(O){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(d=c==null?void 0:c.internal)!=null&&d.throwOnFailedPublish)throw this.removeRequestFromQueue(D),O;return}finally{clearTimeout(A)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}})}catch(f){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(f),f}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=e,this.logger=ze.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return ze.getLoggerContext(this.logger)}rpcPublish(e,t,s,o,c,d,f){var y,g,m,D;const I={method:ks(o.protocol).publish,params:{topic:e,message:t,ttl:s,prompt:c,tag:d},id:f};return Wt((y=I.params)==null?void 0:y.prompt)&&((g=I.params)==null||delete g.prompt),Wt((m=I.params)==null?void 0:m.tag)&&((D=I.params)==null||delete D.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:I}),this.relayer.request(I)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:s,opts:o}=e;await this.publish(t,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(ln.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(zt.connection_stalled);return}this.checkQueue()}),this.relayer.on(zt.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class II{constructor(){this.map=new Map,this.set=(e,t)=>{const s=this.get(e);this.exists(e,t)||this.map.set(e,[...s,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const s=this.get(e);if(!this.exists(e,t))return;const o=s.filter(c=>c!==t);if(!o.length){this.map.delete(e);return}this.map.set(e,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var SI=Object.defineProperty,xI=Object.defineProperties,OI=Object.getOwnPropertyDescriptors,wf=Object.getOwnPropertySymbols,PI=Object.prototype.hasOwnProperty,CI=Object.prototype.propertyIsEnumerable,bf=(i,e,t)=>e in i?SI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Tn=(i,e)=>{for(var t in e||(e={}))PI.call(e,t)&&bf(i,t,e[t]);if(wf)for(var t of wf(e))CI.call(e,t)&&bf(i,t,e[t]);return i},Ma=(i,e)=>xI(i,OI(e));class AI extends O3{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new II,this.events=new Er.EventEmitter,this.name=cI,this.version=uI,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=li,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const c=ic(o),d={topic:s,relay:c};this.pending.set(s,d);const f=await this.rpcSubscribe(s,c);return this.onSubscribe(f,d),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),f}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>{if(this.topics.includes(s))return!0;const o=`${this.pendingSubscriptionWatchLabel}_${s}`;return await new Promise((c,d)=>{const f=new fe.Watch;f.start(o);const y=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(y),f.stop(o),c(!0)),f.elapsed(o)>=hI&&(clearInterval(y),f.stop(o),d(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=ze.generateChildLogger(t,this.name),this.clientId=""}get context(){return ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let s=!1;try{s=this.getSubscription(e).topic===t}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const s=this.topicMap.get(e);await Promise.all(s.map(async o=>await this.unsubscribeById(e,o,t)))}async unsubscribeById(e,t,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}});try{const o=ic(s);await this.rpcUnsubscribe(e,t,o);const c=nt("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(e,t){const s={method:ks(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await zn(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(zt.connection_stalled)}return nn(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,s={method:ks(t.protocol).batchSubscribe,params:{topics:e.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await zn(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(zt.connection_stalled)}}rpcUnsubscribe(e,t,s){const o={method:ks(s.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(e,t){this.setSubscription(e,Ma(Tn({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,Tn({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,s){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,s),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))}addSubscription(e,t){this.subscriptions.set(e,Tn({},t)),this.topicMap.set(t.topic,e),this.events.emit(Pr.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:s}=se("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const s=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(s.topic,e),this.events.emit(Pr.deleted,Ma(Tn({},s),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Pr.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Pr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);$r(t)&&this.onBatchSubscribe(t.map((s,o)=>Ma(Tn({},e[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(ln.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(zt.connect,async()=>{await this.onConnect()}),this.relayer.on(zt.disconnect,()=>{this.onDisconnect()}),this.events.on(Pr.created,async e=>{const t=Pr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(Pr.deleted,async e=>{const t=Pr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var RI=Object.defineProperty,_f=Object.getOwnPropertySymbols,NI=Object.prototype.hasOwnProperty,TI=Object.prototype.propertyIsEnumerable,Ef=(i,e,t)=>e in i?RI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,UI=(i,e)=>{for(var t in e||(e={}))NI.call(e,t)&&Ef(i,t,e[t]);if(_f)for(var t of _f(e))TI.call(e,t)&&Ef(i,t,e[t]);return i};class $I extends S3{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new Er.EventEmitter,this.name=tI,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.requestsInFlight=new Map,this.request=async t=>{this.logger.debug("Publishing Request Payload");const s=t.id;try{await this.toEstablishConnection();const o=this.provider.request(t);return this.requestsInFlight.set(s,{promise:o,request:t}),await o}catch(o){throw this.logger.debug("Failed to Publish Request"),this.logger.error(o),o}finally{this.requestsInFlight.delete(s)}},this.onPayloadHandler=t=>{this.onProviderPayload(t)},this.onConnectHandler=()=>{this.events.emit(zt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=t=>{this.logger.error(t),this.events.emit(zt.error,t),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(Gr.payload,this.onPayloadHandler),this.provider.on(Gr.connect,this.onConnectHandler),this.provider.on(Gr.disconnect,this.onDisconnectHandler),this.provider.on(Gr.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?ze.generateChildLogger(e.logger,this.name):ze.pino(ze.getDefaultLoggerOptions({level:e.logger||eI})),this.messages=new EI(this.logger,e.core),this.subscriber=new AI(this,this.logger),this.publisher=new DI(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||Zd,this.projectId=e.projectId,this.bundleId=NE(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${mf}...`),await this.restartTransport(mf)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},sI)}get context(){return ze.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,t,s){this.isInitialized(),await this.publisher.publish(e,t,s),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}async subscribe(e,t){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"";if(o)return o;let c;const d=f=>{f.topic===e&&(this.subscriber.off(Pr.created,d),c())};return await Promise.all([new Promise(f=>{c=f,this.subscriber.on(Pr.created,d)}),new Promise(async f=>{o=await this.subscriber.subscribe(e,t),f()})]),o}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportClose(){this.requestsInFlight.size>0&&(this.logger.debug("Waiting for all in-flight requests to finish before closing transport..."),this.requestsInFlight.forEach(async e=>{await e.promise})),this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await zn(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(e){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(t=>{if(!this.initialized)return t();this.subscriber.once(Pr.resubscribed,()=>{t()})}),new Promise(async(t,s)=>{try{await zn(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){s(o);return}t()})])}catch(t){this.logger.error(t);const s=t;if(!this.isConnectionStalled(s.message))throw t;this.provider.events.emit(Gr.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(e){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Fl())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Xr(new d6(jE({sdkVersion:nI,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:s}=e;await this.messages.set(t,s)}async shouldIgnoreMessageEvent(e){const{topic:t,message:s}=e;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;const o=this.messages.has(t,s);return o&&this.logger.debug(`Ignoring duplicate message: ${s}`),o}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Cc(e)){if(!e.method.endsWith(rI))return;const t=e.params,{topic:s,message:o,publishedAt:c}=t.data,d={topic:s,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(UI({type:"event",event:t.id},d)),this.events.emit(t.id,d),await this.acknowledgePayload(e),await this.onMessageEvent(d)}else ao(e)&&this.events.emit(zt.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(zt.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=so(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(Gr.payload,this.onPayloadHandler),this.provider.off(Gr.connect,this.onConnectHandler),this.provider.off(Gr.disconnect,this.onDisconnectHandler),this.provider.off(Gr.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(zt.connection_stalled,()=>{this.restartTransport().catch(t=>this.logger.error(t))});let e=await Fl();ND(async t=>{this.initialized&&e!==t&&(e=t,t?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(zt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(e=>this.logger.error(e))},fe.toMiliseconds(iI)))}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(e=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var LI=Object.defineProperty,Df=Object.getOwnPropertySymbols,MI=Object.prototype.hasOwnProperty,jI=Object.prototype.propertyIsEnumerable,If=(i,e,t)=>e in i?LI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Sf=(i,e)=>{for(var t in e||(e={}))MI.call(e,t)&&If(i,t,e[t]);if(Df)for(var t of Df(e))jI.call(e,t)&&If(i,t,e[t]);return i};class uo extends x3{constructor(e,t,s,o=li,c=void 0){super(e,t,s,o),this.core=e,this.logger=t,this.name=s,this.map=new Map,this.version=oI,this.cached=[],this.initialized=!1,this.storagePrefix=li,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(d=>{this.getKey&&d!==null&&!Wt(d)?this.map.set(this.getKey(d),d):uD(d)?this.map.set(d.id,d):hD(d)&&this.map.set(d.topic,d)}),this.cached=[],this.initialized=!0)},this.set=async(d,f)=>{this.isInitialized(),this.map.has(d)?await this.update(d,f):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:d,value:f}),this.map.set(d,f),await this.persist())},this.get=d=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:d}),this.getData(d)),this.getAll=d=>(this.isInitialized(),d?this.values.filter(f=>Object.keys(d).every(y=>S1(f[y],d[y]))):this.values),this.update=async(d,f)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:d,update:f});const y=Sf(Sf({},this.getData(d)),f);this.map.set(d,y),await this.persist()},this.delete=async(d,f)=>{this.isInitialized(),this.map.has(d)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:d,reason:f}),this.map.delete(d),await this.persist())},this.logger=ze.generateChildLogger(t,this.name),this.storagePrefix=o,this.getKey=c}get context(){return ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){const{message:s}=se("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}}class qI{constructor(e,t){this.core=e,this.logger=t,this.name=lI,this.version=fI,this.events=new dc,this.initialized=!1,this.storagePrefix=li,this.ignoredPayloadTypes=[Ti],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=rc(),o=await this.core.crypto.setSymKey(s),c=ur(fe.FIVE_MINUTES),d={protocol:Xd},f={topic:o,expiry:c,relay:d,active:!1},y=eD({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:d,expiryTimestamp:c});return await this.pairings.set(o,f),await this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:y}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:c,relay:d,expiryTimestamp:f}=$l(s.uri);let y;if(this.pairings.keys.includes(o)&&(y=this.pairings.get(o),y.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);const g=f||ur(fe.FIVE_MINUTES),m={topic:o,relay:d,expiry:g,active:!1};return await this.pairings.set(o,m),this.core.expirer.set(o,g),s.activatePairing&&await this.activate({topic:o}),this.events.emit(Ln.create,m),this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(c,o),await this.core.relayer.subscribe(o,{relay:d})),m},this.activate=async({topic:s})=>{this.isInitialized();const o=ur(fe.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const c=await this.sendRequest(o,"wc_pairingPing",{}),{done:d,resolve:f,reject:y}=tn();this.events.once(ft("pairing_ping",c),({error:g})=>{g?y(g):f()}),await d()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",nt("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,c)=>{const d=sn(o,c),f=await this.core.crypto.encode(s,d),y=Nn[o].req;return this.core.history.set(s,d),this.core.relayer.publish(s,f,y),d.id},this.sendResult=async(s,o,c)=>{const d=so(s,c),f=await this.core.crypto.encode(o,d),y=await this.core.history.get(o,s),g=Nn[y.request.method].res;await this.core.relayer.publish(o,f,g),await this.core.history.resolve(d)},this.sendError=async(s,o,c)=>{const d=oo(s,c),f=await this.core.crypto.encode(o,d),y=await this.core.history.get(o,s),g=Nn[y.request.method]?Nn[y.request.method].res:Nn.unregistered_method.res;await this.core.relayer.publish(o,f,g),await this.core.history.resolve(d)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,nt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>hi(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:c}=s;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:c}=s,d=(await this.core.history.get(o,c.id)).request.method;switch(d){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(d)}},this.onPairingPingRequest=async(s,o)=>{const{id:c}=o;try{this.isValidPing({topic:s}),await this.sendResult(c,s,!0),this.events.emit(Ln.ping,{id:c,topic:s})}catch(d){await this.sendError(c,s,d),this.logger.error(d)}},this.onPairingPingResponse=(s,o)=>{const{id:c}=o;setTimeout(()=>{Qr(o)?this.events.emit(ft("pairing_ping",c),{}):Cr(o)&&this.events.emit(ft("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(Ln.delete,{id:c,topic:s})}catch(d){await this.sendError(c,s,d),this.logger.error(d)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:c,method:d}=o;try{if(this.registeredMethods.includes(d))return;const f=nt("WC_METHOD_UNSUPPORTED",d);await this.sendError(c,s,f),this.logger.error(f)}catch(f){await this.sendError(c,s,f),this.logger.error(f)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(nt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var o;if(!tr(s)){const{message:d}=se("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(d)}if(!cD(s.uri)){const{message:d}=se("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(d)}const c=$l(s.uri);if(!((o=c==null?void 0:c.relay)!=null&&o.protocol)){const{message:d}=se("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(d)}if(!(c!=null&&c.symKey)){const{message:d}=se("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(d)}if(c!=null&&c.expiryTimestamp&&fe.toMiliseconds(c==null?void 0:c.expiryTimestamp)<Date.now()){const{message:d}=se("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(d)}},this.isValidPing=async s=>{if(!tr(s)){const{message:c}=se("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!tr(s)){const{message:c}=se("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!Tt(s,!1)){const{message:o}=se("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=se("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(hi(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=se("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=e,this.logger=ze.generateChildLogger(t,this.name),this.pairings=new uo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return ze.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(zt.message,async e=>{const{topic:t,message:s}=e;if(!this.pairings.keys.includes(t)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(t,s);try{Cc(o)?(this.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):ao(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.core.history.delete(t,o.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(_r.expired,async e=>{const{topic:t}=_d(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(Ln.expire,{topic:t}))})}}class FI extends E3{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new Er.EventEmitter,this.name=dI,this.version=pI,this.cached=[],this.initialized=!1,this.storagePrefix=li,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:c}),this.records.has(o.id))return;const d={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:c,expiry:ur(fe.THIRTY_DAYS)};this.records.set(d.id,d),this.events.emit(Ur.created,d)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=Cr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(Ur.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===s){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(Ur.deleted,c)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=ze.generateChildLogger(t,this.name)}get context(){return ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const s={topic:t.topic,request:sn(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(s)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:s}=se("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Ur.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Ur.created,e=>{const t=Ur.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(Ur.updated,e=>{const t=Ur.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(Ur.deleted,e=>{const t=Ur.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.core.heartbeat.on(ln.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{fe.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}}class zI extends P3{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new Er.EventEmitter,this.name=gI,this.version=yI,this.cached=[],this.initialized=!1,this.storagePrefix=li,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const c=this.formatTarget(s),d={target:c,expiry:o};this.expirations.set(c,d),this.checkExpiry(c,d),this.events.emit(_r.created,{target:c,expiration:d})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(_r.deleted,{target:o,expiration:c})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=ze.generateChildLogger(t,this.name)}get context(){return ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return qE(e);if(typeof e=="number")return FE(e);const{message:t}=se("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(_r.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:s}=se("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}checkExpiry(e,t){const{expiry:s}=t;fe.toMiliseconds(s)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(_r.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(ln.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(_r.created,e=>{const t=_r.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(_r.expired,e=>{const t=_r.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(_r.deleted,e=>{const t=_r.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}}class BI extends C3{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.name=La,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||cn()||!un())return;const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c)}if(!this.initialized){this.removeIframe(),this.verifyUrl=ac;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);let c;try{c=await this.fetchAttestation(s.attestationId,o)}catch(d){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${o}`),this.logger.info(d),c=await this.fetchAttestation(s.attestationId,ac)}return c},this.fetchAttestation=async(s,o)=>{this.logger.info(`resolving attestation: ${s} from url: ${o}`);const c=this.startAbortTimer(fe.ONE_SECOND*2),d=await fetch(`${o}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(c),d.status===200?await d.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const o=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),s())};await Promise.race([new Promise(c=>{if(document.getElementById(La))return c();window.addEventListener("message",o);const d=document.createElement("iframe");d.id=La,d.src=`${this.verifyUrl}/${this.projectId}`,d.style.display="none",document.body.append(d),this.iframe=d,s=c}),new Promise((c,d)=>setTimeout(()=>{window.removeEventListener("message",o),d("verify iframe load timeout")},fe.toMiliseconds(fe.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let o=s||rn;return vI.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${rn}`),o=rn),o},this.logger=ze.generateChildLogger(t,this.name),this.verifyUrl=rn,this.abortController=new AbortController,this.isDevEnv=Dc()&&m6.IS_VITEST}get context(){return ze.getLoggerContext(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),fe.toMiliseconds(e))}}class HI extends A3{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.context=mI,this.registerDeviceToken=async s=>{const{clientId:o,token:c,notificationType:d,enableEncrypted:f=!1}=s,y=`${wI}/${this.projectId}/clients`;await v6(y,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:o,type:d,token:c,always_raw:f})})},this.logger=ze.generateChildLogger(t,this.context)}}var kI=Object.defineProperty,xf=Object.getOwnPropertySymbols,KI=Object.prototype.hasOwnProperty,VI=Object.prototype.propertyIsEnumerable,Of=(i,e,t)=>e in i?kI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Pf=(i,e)=>{for(var t in e||(e={}))KI.call(e,t)&&Of(i,t,e[t]);if(xf)for(var t of xf(e))VI.call(e,t)&&Of(i,t,e[t]);return i};class Rc extends _3{constructor(e){super(e),this.protocol=Qd,this.version=H2,this.name=Ac,this.events=new Er.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||Zd,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:ze.pino(ze.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||k2.logger}));this.logger=ze.generateChildLogger(t,this.name),this.heartbeat=new ln.HeartBeat,this.crypto=new _I(this,this.logger,e==null?void 0:e.keychain),this.history=new FI(this,this.logger),this.expirer=new zI(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new f3(Pf(Pf({},K2),e==null?void 0:e.storageOptions)),this.relayer=new $I({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new qI(this,this.logger),this.verify=new BI(this.projectId||"",this.logger),this.echoClient=new HI(this.projectId||"",this.logger)}static async init(e){const t=new Rc(e);await t.initialize();const s=await t.crypto.getClientId();return await t.storage.setItem(aI,s),t}get context(){return ze.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const WI=Rc,ep="wc",tp=2,rp="client",Nc=`${ep}@${tp}:${rp}:`,ja={name:rp,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Cf="WALLETCONNECT_DEEPLINK_CHOICE",GI="proposal",ip="Proposal expired",YI="session",zs=fe.SEVEN_DAYS,JI="engine",Yr={wc_sessionPropose:{req:{ttl:fe.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:fe.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:fe.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:fe.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:fe.ONE_DAY,prompt:!1,tag:1104},res:{ttl:fe.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:fe.ONE_DAY,prompt:!1,tag:1106},res:{ttl:fe.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:fe.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:fe.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:fe.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:fe.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:fe.ONE_DAY,prompt:!1,tag:1112},res:{ttl:fe.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:fe.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:fe.THIRTY_SECONDS,prompt:!1,tag:1115}}},qa={min:fe.FIVE_MINUTES,max:fe.SEVEN_DAYS},Jr={idle:"IDLE",active:"ACTIVE"},QI="request",XI=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var ZI=Object.defineProperty,eS=Object.defineProperties,tS=Object.getOwnPropertyDescriptors,Af=Object.getOwnPropertySymbols,rS=Object.prototype.hasOwnProperty,iS=Object.prototype.propertyIsEnumerable,Rf=(i,e,t)=>e in i?ZI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Vt=(i,e)=>{for(var t in e||(e={}))rS.call(e,t)&&Rf(i,t,e[t]);if(Af)for(var t of Af(e))iS.call(e,t)&&Rf(i,t,e[t]);return i},en=(i,e)=>eS(i,tS(e));class nS extends N3{constructor(e){super(e),this.name=JI,this.events=new dc,this.initialized=!1,this.ignoredPayloadTypes=[Ti],this.requestQueue={state:Jr.idle,queue:[]},this.sessionRequestQueue={state:Jr.idle,queue:[]},this.requestQueueDelay=fe.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Yr)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},fe.toMiliseconds(this.requestQueueDelay)))},this.connect=async t=>{await this.isInitialized();const s=en(Vt({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:d,sessionProperties:f,relays:y}=s;let g=o,m,D=!1;if(g&&(D=this.client.core.pairing.pairings.get(g).active),!g||!D){const{topic:x,uri:C}=await this.client.core.pairing.create();g=x,m=C}const I=await this.client.core.crypto.generateKeyPair(),A=Yr.wc_sessionPropose.req.ttl||fe.FIVE_MINUTES,O=ur(A),q=Vt({requiredNamespaces:c,optionalNamespaces:d,relays:y??[{protocol:Xd}],proposer:{publicKey:I,metadata:this.client.metadata},expiryTimestamp:O},f&&{sessionProperties:f}),{reject:B,resolve:te,done:T}=tn(A,ip);if(this.events.once(ft("session_connect"),async({error:x,session:C})=>{if(x)B(x);else if(C){C.self.publicKey=I;const E=en(Vt({},C),{requiredNamespaces:q.requiredNamespaces,optionalNamespaces:q.optionalNamespaces});await this.client.session.set(C.topic,E),await this.setExpiry(C.topic,C.expiry),g&&await this.client.core.pairing.updateMetadata({topic:g,metadata:C.peer.metadata}),te(E)}}),!g){const{message:x}=se("NO_MATCHING_KEY",`connect() pairing topic: ${g}`);throw new Error(x)}const L=await this.sendRequest({topic:g,method:"wc_sessionPropose",params:q,throwOnFailedPublish:!0});return await this.setProposal(L,Vt({id:L},q)),{uri:m,approval:T}},this.pair=async t=>(await this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{await this.isInitialized(),await this.isValidApprove(t);const{id:s,relayProtocol:o,namespaces:c,sessionProperties:d}=t,f=this.client.proposal.get(s);let{pairingTopic:y,proposer:g,requiredNamespaces:m,optionalNamespaces:D}=f;y=y||"";const I=await this.client.core.crypto.generateKeyPair(),A=g.publicKey,O=await this.client.core.crypto.generateSharedKey(I,A);y&&s&&(await this.client.core.pairing.updateMetadata({topic:y,metadata:g.metadata}),await this.sendResult({id:s,topic:y,result:{relay:{protocol:o??"irn"},responderPublicKey:I}}),await this.client.proposal.delete(s,nt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:y}));const q=Vt({relay:{protocol:o??"irn"},namespaces:c,pairingTopic:y,controller:{publicKey:I,metadata:this.client.metadata},expiry:ur(zs)},d&&{sessionProperties:d});await this.client.core.relayer.subscribe(O);const B=en(Vt({},q),{topic:O,requiredNamespaces:m,optionalNamespaces:D,pairingTopic:y,acknowledged:!1,self:q.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:I});await this.client.session.set(O,B);try{await this.sendRequest({topic:O,method:"wc_sessionSettle",params:q,throwOnFailedPublish:!0})}catch(te){throw this.client.logger.error(te),this.client.session.delete(O,nt("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(O),te}return await this.setExpiry(O,ur(zs)),{topic:O,acknowledged:()=>new Promise(te=>setTimeout(()=>te(this.client.session.get(O)),500))}},this.reject=async t=>{await this.isInitialized(),await this.isValidReject(t);const{id:s,reason:o}=t,{pairingTopic:c}=this.client.proposal.get(s);c&&(await this.sendError(s,c,o),await this.client.proposal.delete(s,nt("USER_DISCONNECTED")))},this.update=async t=>{await this.isInitialized(),await this.isValidUpdate(t);const{topic:s,namespaces:o}=t,c=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:d,resolve:f,reject:y}=tn();return this.events.once(ft("session_update",c),({error:g})=>{g?y(g):f()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:d}},this.extend=async t=>{await this.isInitialized(),await this.isValidExtend(t);const{topic:s}=t,o=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:c,resolve:d,reject:f}=tn();return this.events.once(ft("session_extend",o),({error:y})=>{y?f(y):d()}),await this.setExpiry(s,ur(zs)),{acknowledged:c}},this.request=async t=>{await this.isInitialized(),await this.isValidRequest(t);const{chainId:s,request:o,topic:c,expiry:d=Yr.wc_sessionRequest.req.ttl}=t,f=Pc(),{done:y,resolve:g,reject:m}=tn(d,"Request expired. Please try again.");return this.events.once(ft("session_request",f),({error:D,result:I})=>{D?m(D):g(I)}),await Promise.all([new Promise(async D=>{await this.sendRequest({clientRpcId:f,topic:c,method:"wc_sessionRequest",params:{request:en(Vt({},o),{expiryTimestamp:ur(d)}),chainId:s},expiry:d,throwOnFailedPublish:!0}).catch(I=>m(I)),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:s,id:f}),D()}),new Promise(async D=>{const I=await BE(this.client.core.storage,Cf);zE({id:f,topic:c,wcDeepLink:I}),D()}),y()]).then(D=>D[2])},this.respond=async t=>{await this.isInitialized(),await this.isValidRespond(t);const{topic:s,response:o}=t,{id:c}=o;Qr(o)?await this.sendResult({id:c,topic:s,result:o.result,throwOnFailedPublish:!0}):Cr(o)&&await this.sendError(c,s,o.error),this.cleanupAfterResponse(t)},this.ping=async t=>{await this.isInitialized(),await this.isValidPing(t);const{topic:s}=t;if(this.client.session.keys.includes(s)){const o=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:c,resolve:d,reject:f}=tn();this.events.once(ft("session_ping",o),({error:y})=>{y?f(y):d()}),await c()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async t=>{await this.isInitialized(),await this.isValidEmit(t);const{topic:s,event:o,chainId:c}=t;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:o,chainId:c}})},this.disconnect=async t=>{await this.isInitialized(),await this.isValidDisconnect(t);const{topic:s}=t;if(this.client.session.keys.includes(s))await this.sendRequest({topic:s,method:"wc_sessionDelete",params:nt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:s,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(s))await this.client.core.pairing.disconnect({topic:s});else{const{message:o}=se("MISMATCHED_TOPIC",`Session or pairing topic not found: ${s}`);throw new Error(o)}},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(s=>oD(s,t))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const s=this.client.core.pairing.pairings.get(t.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var d,f;return((d=c.peerMetadata)==null?void 0:d.url)&&((f=c.peerMetadata)==null?void 0:f.url)===t.peer.metadata.url&&c.topic&&c.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async t=>{const{topic:s,expirerHasDeleted:o=!1,emitEvent:c=!0,id:d=0}=t,{self:f}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,nt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(f.publicKey)&&await this.client.core.crypto.deleteKeyPair(f.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),o||this.client.core.expirer.del(s),this.client.core.storage.removeItem(Cf).catch(y=>this.client.logger.warn(y)),this.getPendingSessionRequests().forEach(y=>{y.topic===s&&this.deletePendingSessionRequest(y.id,nt("USER_DISCONNECTED"))}),c&&this.client.events.emit("session_delete",{id:d,topic:s})},this.deleteProposal=async(t,s)=>{await Promise.all([this.client.proposal.delete(t,nt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,s),o?Promise.resolve():this.client.core.expirer.del(t)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==t),o&&(this.sessionRequestQueue.state=Jr.idle,this.client.events.emit("session_request_expire",{id:t}))},this.setExpiry=async(t,s)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:s}),this.client.core.expirer.set(t,s)},this.setProposal=async(t,s)=>{await this.client.proposal.set(t,s),this.client.core.expirer.set(t,ur(Yr.wc_sessionPropose.req.ttl))},this.setPendingSessionRequest=async t=>{const{id:s,topic:o,params:c,verifyContext:d}=t,f=c.request.expiryTimestamp||ur(Yr.wc_sessionRequest.req.ttl);await this.client.pendingRequest.set(s,{id:s,topic:o,params:c,verifyContext:d}),f&&this.client.core.expirer.set(s,f)},this.sendRequest=async t=>{const{topic:s,method:o,params:c,expiry:d,relayRpcId:f,clientRpcId:y,throwOnFailedPublish:g}=t,m=sn(o,c,y);if(un()&&XI.includes(o)){const A=nn(JSON.stringify(m));this.client.core.verify.register({attestationId:A})}const D=await this.client.core.crypto.encode(s,m),I=Yr[o].req;return d&&(I.ttl=d),f&&(I.id=f),this.client.core.history.set(s,m),g?(I.internal=en(Vt({},I.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,D,I)):this.client.core.relayer.publish(s,D,I).catch(A=>this.client.logger.error(A)),m.id},this.sendResult=async t=>{const{id:s,topic:o,result:c,throwOnFailedPublish:d}=t,f=so(s,c),y=await this.client.core.crypto.encode(o,f),g=await this.client.core.history.get(o,s),m=Yr[g.request.method].res;d?(m.internal=en(Vt({},m.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,y,m)):this.client.core.relayer.publish(o,y,m).catch(D=>this.client.logger.error(D)),await this.client.core.history.resolve(f)},this.sendError=async(t,s,o)=>{const c=oo(t,o),d=await this.client.core.crypto.encode(s,c),f=await this.client.core.history.get(s,t),y=Yr[f.request.method].res;this.client.core.relayer.publish(s,d,y),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const t=[],s=[];this.client.session.getAll().forEach(o=>{let c=!1;hi(o.expiry)&&(c=!0),this.client.core.crypto.keychain.has(o.topic)||(c=!0),c&&t.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{hi(o.expiryTimestamp)&&s.push(o.id)}),await Promise.all([...t.map(o=>this.deleteSession({topic:o})),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===Jr.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Jr.active;const t=this.requestQueue.queue.shift();if(t)try{this.processRequest(t),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=Jr.idle},this.processRequest=t=>{const{topic:s,payload:o}=t,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async t=>{const{topic:s,payload:o}=t,c=(await this.client.core.history.get(s,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:s}=t,{message:o}=se("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(t,s)=>{const{params:o,id:c}=s;try{this.isValidConnect(Vt({},s.params));const d=o.expiryTimestamp||ur(Yr.wc_sessionPropose.req.ttl),f=Vt({id:c,pairingTopic:t,expiryTimestamp:d},o);await this.setProposal(c,f);const y=nn(JSON.stringify(s)),g=await this.getVerifyContext(y,f.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:f,verifyContext:g})}catch(d){await this.sendError(c,t,d),this.client.logger.error(d)}},this.onSessionProposeResponse=async(t,s)=>{const{id:o}=s;if(Qr(s)){const{result:c}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const d=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:d});const f=d.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});const y=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:y});const g=await this.client.core.crypto.generateSharedKey(f,y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:g});const m=await this.client.core.relayer.subscribe(g);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:m}),await this.client.core.pairing.activate({topic:t})}else Cr(s)&&(await this.client.proposal.delete(o,nt("USER_DISCONNECTED")),this.events.emit(ft("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidSessionSettleRequest(c);const{relay:d,controller:f,expiry:y,namespaces:g,sessionProperties:m,pairingTopic:D}=s.params,I=Vt({topic:t,relay:d,expiry:y,namespaces:g,acknowledged:!0,pairingTopic:D,requiredNamespaces:{},optionalNamespaces:{},controller:f.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:f.publicKey,metadata:f.metadata}},m&&{sessionProperties:m});await this.sendResult({id:s.id,topic:t,result:!0}),this.events.emit(ft("session_connect"),{session:I}),this.cleanupDuplicatePairings(I)}catch(d){await this.sendError(o,t,d),this.client.logger.error(d)}},this.onSessionSettleResponse=async(t,s)=>{const{id:o}=s;Qr(s)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(ft("session_approve",o),{})):Cr(s)&&(await this.client.session.delete(t,nt("USER_DISCONNECTED")),this.events.emit(ft("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(t,s)=>{const{params:o,id:c}=s;try{const d=`${t}_session_update`,f=js.get(d);if(f&&this.isRequestOutOfSync(f,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(Vt({topic:t},o)),await this.client.session.update(t,{namespaces:o.namespaces}),await this.sendResult({id:c,topic:t,result:!0}),this.client.events.emit("session_update",{id:c,topic:t,params:o}),js.set(d,c)}catch(d){await this.sendError(c,t,d),this.client.logger.error(d)}},this.isRequestOutOfSync=(t,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(t.toString().slice(0,-3)),this.onSessionUpdateResponse=(t,s)=>{const{id:o}=s;Qr(s)?this.events.emit(ft("session_update",o),{}):Cr(s)&&this.events.emit(ft("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(t,s)=>{const{id:o}=s;try{this.isValidExtend({topic:t}),await this.setExpiry(t,ur(zs)),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_extend",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(t,s)=>{const{id:o}=s;Qr(s)?this.events.emit(ft("session_extend",o),{}):Cr(s)&&this.events.emit(ft("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(t,s)=>{const{id:o}=s;try{this.isValidPing({topic:t}),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_ping",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionPingResponse=(t,s)=>{const{id:o}=s;setTimeout(()=>{Qr(s)?this.events.emit(ft("session_ping",o),{}):Cr(s)&&this.events.emit(ft("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(t,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:t,reason:s.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(zt.publish,async()=>{c(await this.deleteSession({topic:t,id:o}))})}),this.sendResult({id:o,topic:t,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:t,error:nt("USER_DISCONNECTED")})])}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidRequest(Vt({topic:t},c));const d=nn(JSON.stringify(sn("wc_sessionRequest",c,o))),f=this.client.session.get(t),y=await this.getVerifyContext(d,f.peer.metadata),g={id:o,topic:t,params:c,verifyContext:y};await this.setPendingSessionRequest(g),this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue()}catch(d){await this.sendError(o,t,d),this.client.logger.error(d)}},this.onSessionRequestResponse=(t,s)=>{const{id:o}=s;Qr(s)?this.events.emit(ft("session_request",o),{result:s.result}):Cr(s)&&this.events.emit(ft("session_request",o),{error:s.error})},this.onSessionEventRequest=async(t,s)=>{const{id:o,params:c}=s;try{const d=`${t}_session_event_${c.event.name}`,f=js.get(d);if(f&&this.isRequestOutOfSync(f,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(Vt({topic:t},c)),this.client.events.emit("session_event",{id:o,topic:t,params:c}),js.set(d,o)}catch(d){await this.sendError(o,t,d),this.client.logger.error(d)}},this.addSessionRequestToSessionRequestQueue=t=>{this.sessionRequestQueue.queue.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Jr.idle,this.processSessionRequestQueue()},fe.toMiliseconds(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:t,error:s})=>{const o=this.client.core.history.pending;o.length>0&&o.filter(c=>c.topic===t&&c.request.method==="wc_sessionRequest").forEach(c=>{this.events.emit(ft("session_request",c.request.id),{error:s})})},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===Jr.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=Jr.active,this.client.events.emit("session_request",t)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=t=>{if(t.active)return;const s=this.client.proposal.getAll().find(o=>o.pairingTopic===t.topic);s&&this.onSessionProposeRequest(t.topic,sn("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async t=>{if(!tr(t)){const{message:y}=se("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(y)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:d,relays:f}=t;if(Wt(s)||await this.isValidPairingTopic(s),!mD(f,!0)){const{message:y}=se("MISSING_OR_INVALID",`connect() relays: ${f}`);throw new Error(y)}!Wt(o)&&Bn(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!Wt(c)&&Bn(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),Wt(d)||this.validateSessionProps(d,"sessionProperties")},this.validateNamespaces=(t,s)=>{const o=vD(t,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async t=>{if(!tr(t))throw new Error(se("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:s,namespaces:o,relayProtocol:c,sessionProperties:d}=t;await this.isValidProposalId(s);const f=this.client.proposal.get(s),y=Oa(o,"approve()");if(y)throw new Error(y.message);const g=jl(f.requiredNamespaces,o,"approve()");if(g)throw new Error(g.message);if(!Tt(c,!0)){const{message:m}=se("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(m)}Wt(d)||this.validateSessionProps(d,"sessionProperties")},this.isValidReject=async t=>{if(!tr(t)){const{message:c}=se("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(c)}const{id:s,reason:o}=t;if(await this.isValidProposalId(s),!bD(o)){const{message:c}=se("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidSessionSettleRequest=t=>{if(!tr(t)){const{message:g}=se("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(g)}const{relay:s,controller:o,namespaces:c,expiry:d}=t;if(!Dd(s)){const{message:g}=se("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(g)}const f=lD(o,"onSessionSettleRequest()");if(f)throw new Error(f.message);const y=Oa(c,"onSessionSettleRequest()");if(y)throw new Error(y.message);if(hi(d)){const{message:g}=se("EXPIRED","onSessionSettleRequest()");throw new Error(g)}},this.isValidUpdate=async t=>{if(!tr(t)){const{message:y}=se("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(y)}const{topic:s,namespaces:o}=t;await this.isValidSessionTopic(s);const c=this.client.session.get(s),d=Oa(o,"update()");if(d)throw new Error(d.message);const f=jl(c.requiredNamespaces,o,"update()");if(f)throw new Error(f.message)},this.isValidExtend=async t=>{if(!tr(t)){const{message:o}=se("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionTopic(s)},this.isValidRequest=async t=>{if(!tr(t)){const{message:y}=se("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(y)}const{topic:s,request:o,chainId:c,expiry:d}=t;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!Ml(f,c)){const{message:y}=se("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(y)}if(!_D(o)){const{message:y}=se("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(y)}if(!ID(f,c,o.method)){const{message:y}=se("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(y)}if(d&&!PD(d,qa)){const{message:y}=se("MISSING_OR_INVALID",`request() expiry: ${d}. Expiry must be a number (in seconds) between ${qa.min} and ${qa.max}`);throw new Error(y)}},this.isValidRespond=async t=>{var s;if(!tr(t)){const{message:d}=se("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(d)}const{topic:o,response:c}=t;try{await this.isValidSessionTopic(o)}catch(d){throw(s=t==null?void 0:t.response)!=null&&s.id&&this.cleanupAfterResponse(t),d}if(!ED(c)){const{message:d}=se("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(c)}`);throw new Error(d)}},this.isValidPing=async t=>{if(!tr(t)){const{message:o}=se("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async t=>{if(!tr(t)){const{message:f}=se("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(f)}const{topic:s,event:o,chainId:c}=t;await this.isValidSessionTopic(s);const{namespaces:d}=this.client.session.get(s);if(!Ml(d,c)){const{message:f}=se("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(f)}if(!DD(o)){const{message:f}=se("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}if(!SD(d,c,o.name)){const{message:f}=se("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}},this.isValidDisconnect=async t=>{if(!tr(t)){const{message:o}=se("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(t,s)=>{const o={verified:{verifyUrl:s.verifyUrl||rn,validation:"UNKNOWN",origin:s.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:t,verifyUrl:s.verifyUrl});c&&(o.verified.origin=c.origin,o.verified.isScam=c.isScam,o.verified.validation=c.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.info(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(t,s)=>{Object.values(t).forEach(o=>{if(!Tt(o,!1)){const{message:c}=se("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}async isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(zt.message,async e=>{const{topic:t,message:s}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(t,s);try{Cc(o)?(this.client.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):ao(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.client.core.history.delete(t,o.id)):this.onRelayEventUnknownPayload({topic:t,payload:o})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(_r.expired,async e=>{const{topic:t,id:s}=_d(e.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,se("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(Ln.create,e=>this.onPairingCreated(e))}isValidPairingTopic(e){if(!Tt(e,!1)){const{message:t}=se("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=se("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(hi(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=se("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Tt(e,!1)){const{message:t}=se("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(!this.client.session.keys.includes(e)){const{message:t}=se("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(hi(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=se("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=se("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Tt(e,!1)){const{message:t}=se("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=se("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!wD(e)){const{message:t}=se("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=se("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(hi(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=se("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class sS extends uo{constructor(e,t){super(e,t,GI,Nc),this.core=e,this.logger=t}}let oS=class extends uo{constructor(e,t){super(e,t,YI,Nc),this.core=e,this.logger=t}};class aS extends uo{constructor(e,t){super(e,t,QI,Nc,s=>s.id),this.core=e,this.logger=t}}let cS=class np extends R3{constructor(e){super(e),this.protocol=ep,this.version=tp,this.name=ja.name,this.events=new Er.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(e==null?void 0:e.name)||ja.name,this.metadata=(e==null?void 0:e.metadata)||UE();const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:ze.pino(ze.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||ja.logger}));this.core=(e==null?void 0:e.core)||new WI(e),this.logger=ze.generateChildLogger(t,this.name),this.session=new oS(this.core,this.logger),this.proposal=new sS(this.core,this.logger),this.pendingRequest=new aS(this.core,this.logger),this.engine=new nS(this)}static async init(e){const t=new np(e);return await t.initialize(),t}get context(){return ze.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var cc={exports:{}};(function(i,e){var t=typeof self<"u"?self:Ci,s=function(){function c(){this.fetch=!1,this.DOMException=t.DOMException}return c.prototype=t,new c}();(function(c){(function(d){var f={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function y(_){return _&&DataView.prototype.isPrototypeOf(_)}if(f.arrayBuffer)var g=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],m=ArrayBuffer.isView||function(_){return _&&g.indexOf(Object.prototype.toString.call(_))>-1};function D(_){if(typeof _!="string"&&(_=String(_)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(_))throw new TypeError("Invalid character in header field name");return _.toLowerCase()}function I(_){return typeof _!="string"&&(_=String(_)),_}function A(_){var P={next:function(){var X=_.shift();return{done:X===void 0,value:X}}};return f.iterable&&(P[Symbol.iterator]=function(){return P}),P}function O(_){this.map={},_ instanceof O?_.forEach(function(P,X){this.append(X,P)},this):Array.isArray(_)?_.forEach(function(P){this.append(P[0],P[1])},this):_&&Object.getOwnPropertyNames(_).forEach(function(P){this.append(P,_[P])},this)}O.prototype.append=function(_,P){_=D(_),P=I(P);var X=this.map[_];this.map[_]=X?X+", "+P:P},O.prototype.delete=function(_){delete this.map[D(_)]},O.prototype.get=function(_){return _=D(_),this.has(_)?this.map[_]:null},O.prototype.has=function(_){return this.map.hasOwnProperty(D(_))},O.prototype.set=function(_,P){this.map[D(_)]=I(P)},O.prototype.forEach=function(_,P){for(var X in this.map)this.map.hasOwnProperty(X)&&_.call(P,this.map[X],X,this)},O.prototype.keys=function(){var _=[];return this.forEach(function(P,X){_.push(X)}),A(_)},O.prototype.values=function(){var _=[];return this.forEach(function(P){_.push(P)}),A(_)},O.prototype.entries=function(){var _=[];return this.forEach(function(P,X){_.push([X,P])}),A(_)},f.iterable&&(O.prototype[Symbol.iterator]=O.prototype.entries);function q(_){if(_.bodyUsed)return Promise.reject(new TypeError("Already read"));_.bodyUsed=!0}function B(_){return new Promise(function(P,X){_.onload=function(){P(_.result)},_.onerror=function(){X(_.error)}})}function te(_){var P=new FileReader,X=B(P);return P.readAsArrayBuffer(_),X}function T(_){var P=new FileReader,X=B(P);return P.readAsText(_),X}function L(_){for(var P=new Uint8Array(_),X=new Array(P.length),J=0;J<P.length;J++)X[J]=String.fromCharCode(P[J]);return X.join("")}function x(_){if(_.slice)return _.slice(0);var P=new Uint8Array(_.byteLength);return P.set(new Uint8Array(_)),P.buffer}function C(){return this.bodyUsed=!1,this._initBody=function(_){this._bodyInit=_,_?typeof _=="string"?this._bodyText=_:f.blob&&Blob.prototype.isPrototypeOf(_)?this._bodyBlob=_:f.formData&&FormData.prototype.isPrototypeOf(_)?this._bodyFormData=_:f.searchParams&&URLSearchParams.prototype.isPrototypeOf(_)?this._bodyText=_.toString():f.arrayBuffer&&f.blob&&y(_)?(this._bodyArrayBuffer=x(_.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):f.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(_)||m(_))?this._bodyArrayBuffer=x(_):this._bodyText=_=Object.prototype.toString.call(_):this._bodyText="",this.headers.get("content-type")||(typeof _=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):f.searchParams&&URLSearchParams.prototype.isPrototypeOf(_)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},f.blob&&(this.blob=function(){var _=q(this);if(_)return _;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?q(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(te)}),this.text=function(){var _=q(this);if(_)return _;if(this._bodyBlob)return T(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(L(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},f.formData&&(this.formData=function(){return this.text().then(K)}),this.json=function(){return this.text().then(JSON.parse)},this}var E=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function u(_){var P=_.toUpperCase();return E.indexOf(P)>-1?P:_}function b(_,P){P=P||{};var X=P.body;if(_ instanceof b){if(_.bodyUsed)throw new TypeError("Already read");this.url=_.url,this.credentials=_.credentials,P.headers||(this.headers=new O(_.headers)),this.method=_.method,this.mode=_.mode,this.signal=_.signal,!X&&_._bodyInit!=null&&(X=_._bodyInit,_.bodyUsed=!0)}else this.url=String(_);if(this.credentials=P.credentials||this.credentials||"same-origin",(P.headers||!this.headers)&&(this.headers=new O(P.headers)),this.method=u(P.method||this.method||"GET"),this.mode=P.mode||this.mode||null,this.signal=P.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&X)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(X)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})};function K(_){var P=new FormData;return _.trim().split("&").forEach(function(X){if(X){var J=X.split("="),H=J.shift().replace(/\+/g," "),k=J.join("=").replace(/\+/g," ");P.append(decodeURIComponent(H),decodeURIComponent(k))}}),P}function W(_){var P=new O,X=_.replace(/\r?\n[\t ]+/g," ");return X.split(/\r?\n/).forEach(function(J){var H=J.split(":"),k=H.shift().trim();if(k){var G=H.join(":").trim();P.append(k,G)}}),P}C.call(b.prototype);function re(_,P){P||(P={}),this.type="default",this.status=P.status===void 0?200:P.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in P?P.statusText:"OK",this.headers=new O(P.headers),this.url=P.url||"",this._initBody(_)}C.call(re.prototype),re.prototype.clone=function(){return new re(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new O(this.headers),url:this.url})},re.error=function(){var _=new re(null,{status:0,statusText:""});return _.type="error",_};var ae=[301,302,303,307,308];re.redirect=function(_,P){if(ae.indexOf(P)===-1)throw new RangeError("Invalid status code");return new re(null,{status:P,headers:{location:_}})},d.DOMException=c.DOMException;try{new d.DOMException}catch{d.DOMException=function(P,X){this.message=P,this.name=X;var J=Error(P);this.stack=J.stack},d.DOMException.prototype=Object.create(Error.prototype),d.DOMException.prototype.constructor=d.DOMException}function ue(_,P){return new Promise(function(X,J){var H=new b(_,P);if(H.signal&&H.signal.aborted)return J(new d.DOMException("Aborted","AbortError"));var k=new XMLHttpRequest;function G(){k.abort()}k.onload=function(){var Z={status:k.status,statusText:k.statusText,headers:W(k.getAllResponseHeaders()||"")};Z.url="responseURL"in k?k.responseURL:Z.headers.get("X-Request-URL");var ve="response"in k?k.response:k.responseText;X(new re(ve,Z))},k.onerror=function(){J(new TypeError("Network request failed"))},k.ontimeout=function(){J(new TypeError("Network request failed"))},k.onabort=function(){J(new d.DOMException("Aborted","AbortError"))},k.open(H.method,H.url,!0),H.credentials==="include"?k.withCredentials=!0:H.credentials==="omit"&&(k.withCredentials=!1),"responseType"in k&&f.blob&&(k.responseType="blob"),H.headers.forEach(function(Z,ve){k.setRequestHeader(ve,Z)}),H.signal&&(H.signal.addEventListener("abort",G),k.onreadystatechange=function(){k.readyState===4&&H.signal.removeEventListener("abort",G)}),k.send(typeof H._bodyInit>"u"?null:H._bodyInit)})}return ue.polyfill=!0,c.fetch||(c.fetch=ue,c.Headers=O,c.Request=b,c.Response=re),d.Headers=O,d.Request=b,d.Response=re,d.fetch=ue,Object.defineProperty(d,"__esModule",{value:!0}),d})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=s;e=o.fetch,e.default=o.fetch,e.fetch=o.fetch,e.Headers=o.Headers,e.Request=o.Request,e.Response=o.Response,i.exports=e})(cc,cc.exports);var uS=cc.exports;const Nf=Vf(uS),hS={Accept:"application/json","Content-Type":"application/json"},lS="POST",Tf={headers:hS,method:lS},Uf=10;class pi{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new Er.EventEmitter,this.isAvailable=!1,this.registering=!1,!of(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,t){this.isAvailable||await this.register();try{const s=Ri(e),c=await(await Nf(this.url,Object.assign(Object.assign({},Tf),{body:s}))).json();this.onPayload({data:c})}catch(s){this.onError(e.id,s)}}async register(e=this.url){if(!of(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=Ri({id:1,jsonrpc:"2.0",method:"test",params:[]});await Nf(e,Object.assign(Object.assign({},Tf),{body:t}))}this.onOpen()}catch(t){const s=this.parseError(t);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Gn(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=oo(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return $d(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Uf&&this.events.setMaxListeners(Uf)}}const $f="error",fS="wss://relay.walletconnect.com",dS="wc",pS="universal_provider",Lf=`${dS}@2:${pS}:`,gS="https://rpc.walletconnect.com/v1/",Zr={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Un=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},uc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(i,e){(function(){var t,s="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",d="Expected a function",f="Invalid `variable` option passed into `_.template`",y="__lodash_hash_undefined__",g=500,m="__lodash_placeholder__",D=1,I=2,A=4,O=1,q=2,B=1,te=2,T=4,L=8,x=16,C=32,E=64,u=128,b=256,K=512,W=30,re="...",ae=800,ue=16,_=1,P=2,X=3,J=1/0,H=9007199254740991,k=17976931348623157e292,G=NaN,Z=4294967295,ve=Z-1,ie=Z>>>1,me=[["ary",u],["bind",B],["bindKey",te],["curry",L],["curryRight",x],["flip",K],["partial",C],["partialRight",E],["rearg",b]],we="[object Arguments]",ye="[object Array]",j="[object AsyncFunction]",F="[object Boolean]",U="[object Date]",l="[object DOMException]",R="[object Error]",ne="[object Function]",ce="[object GeneratorFunction]",be="[object Map]",Me="[object Number]",Be="[object Null]",Te="[object Object]",at="[object Promise]",ct="[object Proxy]",$e="[object RegExp]",_e="[object Set]",Pe="[object String]",Ce="[object Symbol]",Le="[object Undefined]",Ie="[object WeakMap]",Ae="[object WeakSet]",Ee="[object ArrayBuffer]",Re="[object DataView]",qe="[object Float32Array]",He="[object Float64Array]",Ke="[object Int8Array]",Ve="[object Int16Array]",We="[object Int32Array]",Ge="[object Uint8Array]",Je="[object Uint8ClampedArray]",fr="[object Uint16Array]",Dr="[object Uint32Array]",ei=/\b__p \+= '';/g,gi=/\b(__p \+=) '' \+/g,Mi=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ji=/&(?:amp|lt|gt|quot|#39);/g,fn=/[&<>"']/g,mt=RegExp(ji.source),wt=RegExp(fn.source),bt=/<%-([\s\S]+?)%>/g,_t=/<%([\s\S]+?)%>/g,gt=/<%=([\s\S]+?)%>/g,Et=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Dt=/^\w*$/,It=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,dt=/[\\^$.*+?()[\]{}|]/g,St=RegExp(dt.source),pt=/^\s+/,xt=/\s/,Ot=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Pt=/\{\n\/\* \[wrapped with (.+)\] \*/,Ct=/,? & /,At=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ap=/[()=,{}\[\]\/\s]/,cp=/\\(\\)?/g,up=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,$c=/\w*$/,hp=/^[-+]0x[0-9a-f]+$/i,lp=/^0b[01]+$/i,fp=/^\[object .+?Constructor\]$/,dp=/^0o[0-7]+$/i,pp=/^(?:0|[1-9]\d*)$/,gp=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Jn=/($^)/,yp=/['\n\r\u2028\u2029\\]/g,Qn="\\ud800-\\udfff",vp="\\u0300-\\u036f",mp="\\ufe20-\\ufe2f",wp="\\u20d0-\\u20ff",Lc=vp+mp+wp,Mc="\\u2700-\\u27bf",jc="a-z\\xdf-\\xf6\\xf8-\\xff",bp="\\xac\\xb1\\xd7\\xf7",_p="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ep="\\u2000-\\u206f",Dp=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",qc="A-Z\\xc0-\\xd6\\xd8-\\xde",Fc="\\ufe0e\\ufe0f",zc=bp+_p+Ep+Dp,ho="['’]",Ip="["+Qn+"]",Bc="["+zc+"]",Xn="["+Lc+"]",Hc="\\d+",Sp="["+Mc+"]",kc="["+jc+"]",Kc="[^"+Qn+zc+Hc+Mc+jc+qc+"]",lo="\\ud83c[\\udffb-\\udfff]",xp="(?:"+Xn+"|"+lo+")",Vc="[^"+Qn+"]",fo="(?:\\ud83c[\\udde6-\\uddff]){2}",po="[\\ud800-\\udbff][\\udc00-\\udfff]",qi="["+qc+"]",Wc="\\u200d",Gc="(?:"+kc+"|"+Kc+")",Op="(?:"+qi+"|"+Kc+")",Yc="(?:"+ho+"(?:d|ll|m|re|s|t|ve))?",Jc="(?:"+ho+"(?:D|LL|M|RE|S|T|VE))?",Qc=xp+"?",Xc="["+Fc+"]?",Pp="(?:"+Wc+"(?:"+[Vc,fo,po].join("|")+")"+Xc+Qc+")*",Cp="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ap="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Zc=Xc+Qc+Pp,Rp="(?:"+[Sp,fo,po].join("|")+")"+Zc,Np="(?:"+[Vc+Xn+"?",Xn,fo,po,Ip].join("|")+")",Tp=RegExp(ho,"g"),Up=RegExp(Xn,"g"),go=RegExp(lo+"(?="+lo+")|"+Np+Zc,"g"),$p=RegExp([qi+"?"+kc+"+"+Yc+"(?="+[Bc,qi,"$"].join("|")+")",Op+"+"+Jc+"(?="+[Bc,qi+Gc,"$"].join("|")+")",qi+"?"+Gc+"+"+Yc,qi+"+"+Jc,Ap,Cp,Hc,Rp].join("|"),"g"),Lp=RegExp("["+Wc+Qn+Lc+Fc+"]"),Mp=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,jp=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],qp=-1,rt={};rt[qe]=rt[He]=rt[Ke]=rt[Ve]=rt[We]=rt[Ge]=rt[Je]=rt[fr]=rt[Dr]=!0,rt[we]=rt[ye]=rt[Ee]=rt[F]=rt[Re]=rt[U]=rt[R]=rt[ne]=rt[be]=rt[Me]=rt[Te]=rt[$e]=rt[_e]=rt[Pe]=rt[Ie]=!1;var et={};et[we]=et[ye]=et[Ee]=et[Re]=et[F]=et[U]=et[qe]=et[He]=et[Ke]=et[Ve]=et[We]=et[be]=et[Me]=et[Te]=et[$e]=et[_e]=et[Pe]=et[Ce]=et[Ge]=et[Je]=et[fr]=et[Dr]=!0,et[R]=et[ne]=et[Ie]=!1;var Fp={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},zp={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Bp={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Hp={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},kp=parseFloat,Kp=parseInt,eu=typeof Un=="object"&&Un&&Un.Object===Object&&Un,Vp=typeof self=="object"&&self&&self.Object===Object&&self,Ut=eu||Vp||Function("return this")(),yo=e&&!e.nodeType&&e,yi=yo&&!0&&i&&!i.nodeType&&i,tu=yi&&yi.exports===yo,vo=tu&&eu.process,dr=function(){try{var $=yi&&yi.require&&yi.require("util").types;return $||vo&&vo.binding&&vo.binding("util")}catch{}}(),ru=dr&&dr.isArrayBuffer,iu=dr&&dr.isDate,nu=dr&&dr.isMap,su=dr&&dr.isRegExp,ou=dr&&dr.isSet,au=dr&&dr.isTypedArray;function ir($,V,z){switch(z.length){case 0:return $.call(V);case 1:return $.call(V,z[0]);case 2:return $.call(V,z[0],z[1]);case 3:return $.call(V,z[0],z[1],z[2])}return $.apply(V,z)}function Wp($,V,z,he){for(var De=-1,Ye=$==null?0:$.length;++De<Ye;){var yt=$[De];V(he,yt,z(yt),$)}return he}function pr($,V){for(var z=-1,he=$==null?0:$.length;++z<he&&V($[z],z,$)!==!1;);return $}function Gp($,V){for(var z=$==null?0:$.length;z--&&V($[z],z,$)!==!1;);return $}function cu($,V){for(var z=-1,he=$==null?0:$.length;++z<he;)if(!V($[z],z,$))return!1;return!0}function ti($,V){for(var z=-1,he=$==null?0:$.length,De=0,Ye=[];++z<he;){var yt=$[z];V(yt,z,$)&&(Ye[De++]=yt)}return Ye}function Zn($,V){var z=$==null?0:$.length;return!!z&&Fi($,V,0)>-1}function mo($,V,z){for(var he=-1,De=$==null?0:$.length;++he<De;)if(z(V,$[he]))return!0;return!1}function it($,V){for(var z=-1,he=$==null?0:$.length,De=Array(he);++z<he;)De[z]=V($[z],z,$);return De}function ri($,V){for(var z=-1,he=V.length,De=$.length;++z<he;)$[De+z]=V[z];return $}function wo($,V,z,he){var De=-1,Ye=$==null?0:$.length;for(he&&Ye&&(z=$[++De]);++De<Ye;)z=V(z,$[De],De,$);return z}function Yp($,V,z,he){var De=$==null?0:$.length;for(he&&De&&(z=$[--De]);De--;)z=V(z,$[De],De,$);return z}function bo($,V){for(var z=-1,he=$==null?0:$.length;++z<he;)if(V($[z],z,$))return!0;return!1}var Jp=_o("length");function Qp($){return $.split("")}function Xp($){return $.match(At)||[]}function uu($,V,z){var he;return z($,function(De,Ye,yt){if(V(De,Ye,yt))return he=Ye,!1}),he}function es($,V,z,he){for(var De=$.length,Ye=z+(he?1:-1);he?Ye--:++Ye<De;)if(V($[Ye],Ye,$))return Ye;return-1}function Fi($,V,z){return V===V?hg($,V,z):es($,hu,z)}function Zp($,V,z,he){for(var De=z-1,Ye=$.length;++De<Ye;)if(he($[De],V))return De;return-1}function hu($){return $!==$}function lu($,V){var z=$==null?0:$.length;return z?Do($,V)/z:G}function _o($){return function(V){return V==null?t:V[$]}}function Eo($){return function(V){return $==null?t:$[V]}}function fu($,V,z,he,De){return De($,function(Ye,yt,Ze){z=he?(he=!1,Ye):V(z,Ye,yt,Ze)}),z}function eg($,V){var z=$.length;for($.sort(V);z--;)$[z]=$[z].value;return $}function Do($,V){for(var z,he=-1,De=$.length;++he<De;){var Ye=V($[he]);Ye!==t&&(z=z===t?Ye:z+Ye)}return z}function Io($,V){for(var z=-1,he=Array($);++z<$;)he[z]=V(z);return he}function tg($,V){return it(V,function(z){return[z,$[z]]})}function du($){return $&&$.slice(0,vu($)+1).replace(pt,"")}function nr($){return function(V){return $(V)}}function So($,V){return it(V,function(z){return $[z]})}function dn($,V){return $.has(V)}function pu($,V){for(var z=-1,he=$.length;++z<he&&Fi(V,$[z],0)>-1;);return z}function gu($,V){for(var z=$.length;z--&&Fi(V,$[z],0)>-1;);return z}function rg($,V){for(var z=$.length,he=0;z--;)$[z]===V&&++he;return he}var ig=Eo(Fp),ng=Eo(zp);function sg($){return"\\"+Hp[$]}function og($,V){return $==null?t:$[V]}function zi($){return Lp.test($)}function ag($){return Mp.test($)}function cg($){for(var V,z=[];!(V=$.next()).done;)z.push(V.value);return z}function xo($){var V=-1,z=Array($.size);return $.forEach(function(he,De){z[++V]=[De,he]}),z}function yu($,V){return function(z){return $(V(z))}}function ii($,V){for(var z=-1,he=$.length,De=0,Ye=[];++z<he;){var yt=$[z];(yt===V||yt===m)&&($[z]=m,Ye[De++]=z)}return Ye}function ts($){var V=-1,z=Array($.size);return $.forEach(function(he){z[++V]=he}),z}function ug($){var V=-1,z=Array($.size);return $.forEach(function(he){z[++V]=[he,he]}),z}function hg($,V,z){for(var he=z-1,De=$.length;++he<De;)if($[he]===V)return he;return-1}function lg($,V,z){for(var he=z+1;he--;)if($[he]===V)return he;return he}function Bi($){return zi($)?dg($):Jp($)}function Ir($){return zi($)?pg($):Qp($)}function vu($){for(var V=$.length;V--&&xt.test($.charAt(V)););return V}var fg=Eo(Bp);function dg($){for(var V=go.lastIndex=0;go.test($);)++V;return V}function pg($){return $.match(go)||[]}function gg($){return $.match($p)||[]}var yg=function $(V){V=V==null?Ut:Hi.defaults(Ut.Object(),V,Hi.pick(Ut,jp));var z=V.Array,he=V.Date,De=V.Error,Ye=V.Function,yt=V.Math,Ze=V.Object,Oo=V.RegExp,vg=V.String,gr=V.TypeError,rs=z.prototype,mg=Ye.prototype,ki=Ze.prototype,is=V["__core-js_shared__"],ns=mg.toString,Xe=ki.hasOwnProperty,wg=0,mu=function(){var r=/[^.]+$/.exec(is&&is.keys&&is.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),ss=ki.toString,bg=ns.call(Ze),_g=Ut._,Eg=Oo("^"+ns.call(Xe).replace(dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),os=tu?V.Buffer:t,ni=V.Symbol,as=V.Uint8Array,wu=os?os.allocUnsafe:t,cs=yu(Ze.getPrototypeOf,Ze),bu=Ze.create,_u=ki.propertyIsEnumerable,us=rs.splice,Eu=ni?ni.isConcatSpreadable:t,pn=ni?ni.iterator:t,vi=ni?ni.toStringTag:t,hs=function(){try{var r=Ei(Ze,"defineProperty");return r({},"",{}),r}catch{}}(),Dg=V.clearTimeout!==Ut.clearTimeout&&V.clearTimeout,Ig=he&&he.now!==Ut.Date.now&&he.now,Sg=V.setTimeout!==Ut.setTimeout&&V.setTimeout,ls=yt.ceil,fs=yt.floor,Po=Ze.getOwnPropertySymbols,xg=os?os.isBuffer:t,Du=V.isFinite,Og=rs.join,Pg=yu(Ze.keys,Ze),vt=yt.max,jt=yt.min,Cg=he.now,Ag=V.parseInt,Iu=yt.random,Rg=rs.reverse,Co=Ei(V,"DataView"),gn=Ei(V,"Map"),Ao=Ei(V,"Promise"),Ki=Ei(V,"Set"),yn=Ei(V,"WeakMap"),vn=Ei(Ze,"create"),ds=yn&&new yn,Vi={},Ng=Di(Co),Tg=Di(gn),Ug=Di(Ao),$g=Di(Ki),Lg=Di(yn),ps=ni?ni.prototype:t,mn=ps?ps.valueOf:t,Su=ps?ps.toString:t;function v(r){if(ut(r)&&!Se(r)&&!(r instanceof Fe)){if(r instanceof yr)return r;if(Xe.call(r,"__wrapped__"))return xh(r)}return new yr(r)}var Wi=function(){function r(){}return function(n){if(!ot(n))return{};if(bu)return bu(n);r.prototype=n;var a=new r;return r.prototype=t,a}}();function gs(){}function yr(r,n){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=t}v.templateSettings={escape:bt,evaluate:_t,interpolate:gt,variable:"",imports:{_:v}},v.prototype=gs.prototype,v.prototype.constructor=v,yr.prototype=Wi(gs.prototype),yr.prototype.constructor=yr;function Fe(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Z,this.__views__=[]}function Mg(){var r=new Fe(this.__wrapped__);return r.__actions__=Jt(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=Jt(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=Jt(this.__views__),r}function jg(){if(this.__filtered__){var r=new Fe(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function qg(){var r=this.__wrapped__.value(),n=this.__dir__,a=Se(r),h=n<0,p=a?r.length:0,w=Q0(0,p,this.__views__),S=w.start,N=w.end,M=N-S,Y=h?N:S-1,Q=this.__iteratees__,ee=Q.length,oe=0,le=jt(M,this.__takeCount__);if(!a||!h&&p==M&&le==M)return Yu(r,this.__actions__);var pe=[];e:for(;M--&&oe<le;){Y+=n;for(var Ne=-1,ge=r[Y];++Ne<ee;){var je=Q[Ne],ke=je.iteratee,ar=je.type,kt=ke(ge);if(ar==P)ge=kt;else if(!kt){if(ar==_)continue e;break e}}pe[oe++]=ge}return pe}Fe.prototype=Wi(gs.prototype),Fe.prototype.constructor=Fe;function mi(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var h=r[n];this.set(h[0],h[1])}}function Fg(){this.__data__=vn?vn(null):{},this.size=0}function zg(r){var n=this.has(r)&&delete this.__data__[r];return this.size-=n?1:0,n}function Bg(r){var n=this.__data__;if(vn){var a=n[r];return a===y?t:a}return Xe.call(n,r)?n[r]:t}function Hg(r){var n=this.__data__;return vn?n[r]!==t:Xe.call(n,r)}function kg(r,n){var a=this.__data__;return this.size+=this.has(r)?0:1,a[r]=vn&&n===t?y:n,this}mi.prototype.clear=Fg,mi.prototype.delete=zg,mi.prototype.get=Bg,mi.prototype.has=Hg,mi.prototype.set=kg;function Mr(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var h=r[n];this.set(h[0],h[1])}}function Kg(){this.__data__=[],this.size=0}function Vg(r){var n=this.__data__,a=ys(n,r);if(a<0)return!1;var h=n.length-1;return a==h?n.pop():us.call(n,a,1),--this.size,!0}function Wg(r){var n=this.__data__,a=ys(n,r);return a<0?t:n[a][1]}function Gg(r){return ys(this.__data__,r)>-1}function Yg(r,n){var a=this.__data__,h=ys(a,r);return h<0?(++this.size,a.push([r,n])):a[h][1]=n,this}Mr.prototype.clear=Kg,Mr.prototype.delete=Vg,Mr.prototype.get=Wg,Mr.prototype.has=Gg,Mr.prototype.set=Yg;function jr(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var h=r[n];this.set(h[0],h[1])}}function Jg(){this.size=0,this.__data__={hash:new mi,map:new(gn||Mr),string:new mi}}function Qg(r){var n=Ps(this,r).delete(r);return this.size-=n?1:0,n}function Xg(r){return Ps(this,r).get(r)}function Zg(r){return Ps(this,r).has(r)}function e0(r,n){var a=Ps(this,r),h=a.size;return a.set(r,n),this.size+=a.size==h?0:1,this}jr.prototype.clear=Jg,jr.prototype.delete=Qg,jr.prototype.get=Xg,jr.prototype.has=Zg,jr.prototype.set=e0;function wi(r){var n=-1,a=r==null?0:r.length;for(this.__data__=new jr;++n<a;)this.add(r[n])}function t0(r){return this.__data__.set(r,y),this}function r0(r){return this.__data__.has(r)}wi.prototype.add=wi.prototype.push=t0,wi.prototype.has=r0;function Sr(r){var n=this.__data__=new Mr(r);this.size=n.size}function i0(){this.__data__=new Mr,this.size=0}function n0(r){var n=this.__data__,a=n.delete(r);return this.size=n.size,a}function s0(r){return this.__data__.get(r)}function o0(r){return this.__data__.has(r)}function a0(r,n){var a=this.__data__;if(a instanceof Mr){var h=a.__data__;if(!gn||h.length<o-1)return h.push([r,n]),this.size=++a.size,this;a=this.__data__=new jr(h)}return a.set(r,n),this.size=a.size,this}Sr.prototype.clear=i0,Sr.prototype.delete=n0,Sr.prototype.get=s0,Sr.prototype.has=o0,Sr.prototype.set=a0;function xu(r,n){var a=Se(r),h=!a&&Ii(r),p=!a&&!h&&ui(r),w=!a&&!h&&!p&&Qi(r),S=a||h||p||w,N=S?Io(r.length,vg):[],M=N.length;for(var Y in r)(n||Xe.call(r,Y))&&!(S&&(Y=="length"||p&&(Y=="offset"||Y=="parent")||w&&(Y=="buffer"||Y=="byteLength"||Y=="byteOffset")||Br(Y,M)))&&N.push(Y);return N}function Ou(r){var n=r.length;return n?r[zo(0,n-1)]:t}function c0(r,n){return Cs(Jt(r),bi(n,0,r.length))}function u0(r){return Cs(Jt(r))}function Ro(r,n,a){(a!==t&&!xr(r[n],a)||a===t&&!(n in r))&&qr(r,n,a)}function wn(r,n,a){var h=r[n];(!(Xe.call(r,n)&&xr(h,a))||a===t&&!(n in r))&&qr(r,n,a)}function ys(r,n){for(var a=r.length;a--;)if(xr(r[a][0],n))return a;return-1}function h0(r,n,a,h){return si(r,function(p,w,S){n(h,p,a(p),S)}),h}function Pu(r,n){return r&&Rr(n,Rt(n),r)}function l0(r,n){return r&&Rr(n,Xt(n),r)}function qr(r,n,a){n=="__proto__"&&hs?hs(r,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[n]=a}function No(r,n){for(var a=-1,h=n.length,p=z(h),w=r==null;++a<h;)p[a]=w?t:fa(r,n[a]);return p}function bi(r,n,a){return r===r&&(a!==t&&(r=r<=a?r:a),n!==t&&(r=r>=n?r:n)),r}function vr(r,n,a,h,p,w){var S,N=n&D,M=n&I,Y=n&A;if(a&&(S=p?a(r,h,p,w):a(r)),S!==t)return S;if(!ot(r))return r;var Q=Se(r);if(Q){if(S=Z0(r),!N)return Jt(r,S)}else{var ee=qt(r),oe=ee==ne||ee==ce;if(ui(r))return Xu(r,N);if(ee==Te||ee==we||oe&&!p){if(S=M||oe?{}:vh(r),!N)return M?B0(r,l0(S,r)):z0(r,Pu(S,r))}else{if(!et[ee])return p?r:{};S=ey(r,ee,N)}}w||(w=new Sr);var le=w.get(r);if(le)return le;w.set(r,S),Vh(r)?r.forEach(function(ge){S.add(vr(ge,n,a,ge,r,w))}):kh(r)&&r.forEach(function(ge,je){S.set(je,vr(ge,n,a,je,r,w))});var pe=Y?M?Xo:Qo:M?Xt:Rt,Ne=Q?t:pe(r);return pr(Ne||r,function(ge,je){Ne&&(je=ge,ge=r[je]),wn(S,je,vr(ge,n,a,je,r,w))}),S}function f0(r){var n=Rt(r);return function(a){return Cu(a,r,n)}}function Cu(r,n,a){var h=a.length;if(r==null)return!h;for(r=Ze(r);h--;){var p=a[h],w=n[p],S=r[p];if(S===t&&!(p in r)||!w(S))return!1}return!0}function Au(r,n,a){if(typeof r!="function")throw new gr(d);return xn(function(){r.apply(t,a)},n)}function bn(r,n,a,h){var p=-1,w=Zn,S=!0,N=r.length,M=[],Y=n.length;if(!N)return M;a&&(n=it(n,nr(a))),h?(w=mo,S=!1):n.length>=o&&(w=dn,S=!1,n=new wi(n));e:for(;++p<N;){var Q=r[p],ee=a==null?Q:a(Q);if(Q=h||Q!==0?Q:0,S&&ee===ee){for(var oe=Y;oe--;)if(n[oe]===ee)continue e;M.push(Q)}else w(n,ee,h)||M.push(Q)}return M}var si=ih(Ar),Ru=ih(Uo,!0);function d0(r,n){var a=!0;return si(r,function(h,p,w){return a=!!n(h,p,w),a}),a}function vs(r,n,a){for(var h=-1,p=r.length;++h<p;){var w=r[h],S=n(w);if(S!=null&&(N===t?S===S&&!or(S):a(S,N)))var N=S,M=w}return M}function p0(r,n,a,h){var p=r.length;for(a=Oe(a),a<0&&(a=-a>p?0:p+a),h=h===t||h>p?p:Oe(h),h<0&&(h+=p),h=a>h?0:Gh(h);a<h;)r[a++]=n;return r}function Nu(r,n){var a=[];return si(r,function(h,p,w){n(h,p,w)&&a.push(h)}),a}function $t(r,n,a,h,p){var w=-1,S=r.length;for(a||(a=ry),p||(p=[]);++w<S;){var N=r[w];n>0&&a(N)?n>1?$t(N,n-1,a,h,p):ri(p,N):h||(p[p.length]=N)}return p}var To=nh(),Tu=nh(!0);function Ar(r,n){return r&&To(r,n,Rt)}function Uo(r,n){return r&&Tu(r,n,Rt)}function ms(r,n){return ti(n,function(a){return Hr(r[a])})}function _i(r,n){n=ai(n,r);for(var a=0,h=n.length;r!=null&&a<h;)r=r[Nr(n[a++])];return a&&a==h?r:t}function Uu(r,n,a){var h=n(r);return Se(r)?h:ri(h,a(r))}function Bt(r){return r==null?r===t?Le:Be:vi&&vi in Ze(r)?J0(r):uy(r)}function $o(r,n){return r>n}function g0(r,n){return r!=null&&Xe.call(r,n)}function y0(r,n){return r!=null&&n in Ze(r)}function v0(r,n,a){return r>=jt(n,a)&&r<vt(n,a)}function Lo(r,n,a){for(var h=a?mo:Zn,p=r[0].length,w=r.length,S=w,N=z(w),M=1/0,Y=[];S--;){var Q=r[S];S&&n&&(Q=it(Q,nr(n))),M=jt(Q.length,M),N[S]=!a&&(n||p>=120&&Q.length>=120)?new wi(S&&Q):t}Q=r[0];var ee=-1,oe=N[0];e:for(;++ee<p&&Y.length<M;){var le=Q[ee],pe=n?n(le):le;if(le=a||le!==0?le:0,!(oe?dn(oe,pe):h(Y,pe,a))){for(S=w;--S;){var Ne=N[S];if(!(Ne?dn(Ne,pe):h(r[S],pe,a)))continue e}oe&&oe.push(pe),Y.push(le)}}return Y}function m0(r,n,a,h){return Ar(r,function(p,w,S){n(h,a(p),w,S)}),h}function _n(r,n,a){n=ai(n,r),r=_h(r,n);var h=r==null?r:r[Nr(wr(n))];return h==null?t:ir(h,r,a)}function $u(r){return ut(r)&&Bt(r)==we}function w0(r){return ut(r)&&Bt(r)==Ee}function b0(r){return ut(r)&&Bt(r)==U}function En(r,n,a,h,p){return r===n?!0:r==null||n==null||!ut(r)&&!ut(n)?r!==r&&n!==n:_0(r,n,a,h,En,p)}function _0(r,n,a,h,p,w){var S=Se(r),N=Se(n),M=S?ye:qt(r),Y=N?ye:qt(n);M=M==we?Te:M,Y=Y==we?Te:Y;var Q=M==Te,ee=Y==Te,oe=M==Y;if(oe&&ui(r)){if(!ui(n))return!1;S=!0,Q=!1}if(oe&&!Q)return w||(w=new Sr),S||Qi(r)?ph(r,n,a,h,p,w):G0(r,n,M,a,h,p,w);if(!(a&O)){var le=Q&&Xe.call(r,"__wrapped__"),pe=ee&&Xe.call(n,"__wrapped__");if(le||pe){var Ne=le?r.value():r,ge=pe?n.value():n;return w||(w=new Sr),p(Ne,ge,a,h,w)}}return oe?(w||(w=new Sr),Y0(r,n,a,h,p,w)):!1}function E0(r){return ut(r)&&qt(r)==be}function Mo(r,n,a,h){var p=a.length,w=p,S=!h;if(r==null)return!w;for(r=Ze(r);p--;){var N=a[p];if(S&&N[2]?N[1]!==r[N[0]]:!(N[0]in r))return!1}for(;++p<w;){N=a[p];var M=N[0],Y=r[M],Q=N[1];if(S&&N[2]){if(Y===t&&!(M in r))return!1}else{var ee=new Sr;if(h)var oe=h(Y,Q,M,r,n,ee);if(!(oe===t?En(Q,Y,O|q,h,ee):oe))return!1}}return!0}function Lu(r){if(!ot(r)||ny(r))return!1;var n=Hr(r)?Eg:fp;return n.test(Di(r))}function D0(r){return ut(r)&&Bt(r)==$e}function I0(r){return ut(r)&&qt(r)==_e}function S0(r){return ut(r)&&$s(r.length)&&!!rt[Bt(r)]}function Mu(r){return typeof r=="function"?r:r==null?Zt:typeof r=="object"?Se(r)?Fu(r[0],r[1]):qu(r):sl(r)}function jo(r){if(!Sn(r))return Pg(r);var n=[];for(var a in Ze(r))Xe.call(r,a)&&a!="constructor"&&n.push(a);return n}function x0(r){if(!ot(r))return cy(r);var n=Sn(r),a=[];for(var h in r)h=="constructor"&&(n||!Xe.call(r,h))||a.push(h);return a}function qo(r,n){return r<n}function ju(r,n){var a=-1,h=Qt(r)?z(r.length):[];return si(r,function(p,w,S){h[++a]=n(p,w,S)}),h}function qu(r){var n=ea(r);return n.length==1&&n[0][2]?wh(n[0][0],n[0][1]):function(a){return a===r||Mo(a,r,n)}}function Fu(r,n){return ra(r)&&mh(n)?wh(Nr(r),n):function(a){var h=fa(a,r);return h===t&&h===n?da(a,r):En(n,h,O|q)}}function ws(r,n,a,h,p){r!==n&&To(n,function(w,S){if(p||(p=new Sr),ot(w))O0(r,n,S,a,ws,h,p);else{var N=h?h(na(r,S),w,S+"",r,n,p):t;N===t&&(N=w),Ro(r,S,N)}},Xt)}function O0(r,n,a,h,p,w,S){var N=na(r,a),M=na(n,a),Y=S.get(M);if(Y){Ro(r,a,Y);return}var Q=w?w(N,M,a+"",r,n,S):t,ee=Q===t;if(ee){var oe=Se(M),le=!oe&&ui(M),pe=!oe&&!le&&Qi(M);Q=M,oe||le||pe?Se(N)?Q=N:ht(N)?Q=Jt(N):le?(ee=!1,Q=Xu(M,!0)):pe?(ee=!1,Q=Zu(M,!0)):Q=[]:On(M)||Ii(M)?(Q=N,Ii(N)?Q=Yh(N):(!ot(N)||Hr(N))&&(Q=vh(M))):ee=!1}ee&&(S.set(M,Q),p(Q,M,h,w,S),S.delete(M)),Ro(r,a,Q)}function zu(r,n){var a=r.length;if(a)return n+=n<0?a:0,Br(n,a)?r[n]:t}function Bu(r,n,a){n.length?n=it(n,function(w){return Se(w)?function(S){return _i(S,w.length===1?w[0]:w)}:w}):n=[Zt];var h=-1;n=it(n,nr(de()));var p=ju(r,function(w,S,N){var M=it(n,function(Y){return Y(w)});return{criteria:M,index:++h,value:w}});return eg(p,function(w,S){return F0(w,S,a)})}function P0(r,n){return Hu(r,n,function(a,h){return da(r,h)})}function Hu(r,n,a){for(var h=-1,p=n.length,w={};++h<p;){var S=n[h],N=_i(r,S);a(N,S)&&Dn(w,ai(S,r),N)}return w}function C0(r){return function(n){return _i(n,r)}}function Fo(r,n,a,h){var p=h?Zp:Fi,w=-1,S=n.length,N=r;for(r===n&&(n=Jt(n)),a&&(N=it(r,nr(a)));++w<S;)for(var M=0,Y=n[w],Q=a?a(Y):Y;(M=p(N,Q,M,h))>-1;)N!==r&&us.call(N,M,1),us.call(r,M,1);return r}function ku(r,n){for(var a=r?n.length:0,h=a-1;a--;){var p=n[a];if(a==h||p!==w){var w=p;Br(p)?us.call(r,p,1):ko(r,p)}}return r}function zo(r,n){return r+fs(Iu()*(n-r+1))}function A0(r,n,a,h){for(var p=-1,w=vt(ls((n-r)/(a||1)),0),S=z(w);w--;)S[h?w:++p]=r,r+=a;return S}function Bo(r,n){var a="";if(!r||n<1||n>H)return a;do n%2&&(a+=r),n=fs(n/2),n&&(r+=r);while(n);return a}function Ue(r,n){return sa(bh(r,n,Zt),r+"")}function R0(r){return Ou(Xi(r))}function N0(r,n){var a=Xi(r);return Cs(a,bi(n,0,a.length))}function Dn(r,n,a,h){if(!ot(r))return r;n=ai(n,r);for(var p=-1,w=n.length,S=w-1,N=r;N!=null&&++p<w;){var M=Nr(n[p]),Y=a;if(M==="__proto__"||M==="constructor"||M==="prototype")return r;if(p!=S){var Q=N[M];Y=h?h(Q,M,N):t,Y===t&&(Y=ot(Q)?Q:Br(n[p+1])?[]:{})}wn(N,M,Y),N=N[M]}return r}var Ku=ds?function(r,n){return ds.set(r,n),r}:Zt,T0=hs?function(r,n){return hs(r,"toString",{configurable:!0,enumerable:!1,value:ga(n),writable:!0})}:Zt;function U0(r){return Cs(Xi(r))}function mr(r,n,a){var h=-1,p=r.length;n<0&&(n=-n>p?0:p+n),a=a>p?p:a,a<0&&(a+=p),p=n>a?0:a-n>>>0,n>>>=0;for(var w=z(p);++h<p;)w[h]=r[h+n];return w}function $0(r,n){var a;return si(r,function(h,p,w){return a=n(h,p,w),!a}),!!a}function bs(r,n,a){var h=0,p=r==null?h:r.length;if(typeof n=="number"&&n===n&&p<=ie){for(;h<p;){var w=h+p>>>1,S=r[w];S!==null&&!or(S)&&(a?S<=n:S<n)?h=w+1:p=w}return p}return Ho(r,n,Zt,a)}function Ho(r,n,a,h){var p=0,w=r==null?0:r.length;if(w===0)return 0;n=a(n);for(var S=n!==n,N=n===null,M=or(n),Y=n===t;p<w;){var Q=fs((p+w)/2),ee=a(r[Q]),oe=ee!==t,le=ee===null,pe=ee===ee,Ne=or(ee);if(S)var ge=h||pe;else Y?ge=pe&&(h||oe):N?ge=pe&&oe&&(h||!le):M?ge=pe&&oe&&!le&&(h||!Ne):le||Ne?ge=!1:ge=h?ee<=n:ee<n;ge?p=Q+1:w=Q}return jt(w,ve)}function Vu(r,n){for(var a=-1,h=r.length,p=0,w=[];++a<h;){var S=r[a],N=n?n(S):S;if(!a||!xr(N,M)){var M=N;w[p++]=S===0?0:S}}return w}function Wu(r){return typeof r=="number"?r:or(r)?G:+r}function sr(r){if(typeof r=="string")return r;if(Se(r))return it(r,sr)+"";if(or(r))return Su?Su.call(r):"";var n=r+"";return n=="0"&&1/r==-J?"-0":n}function oi(r,n,a){var h=-1,p=Zn,w=r.length,S=!0,N=[],M=N;if(a)S=!1,p=mo;else if(w>=o){var Y=n?null:V0(r);if(Y)return ts(Y);S=!1,p=dn,M=new wi}else M=n?[]:N;e:for(;++h<w;){var Q=r[h],ee=n?n(Q):Q;if(Q=a||Q!==0?Q:0,S&&ee===ee){for(var oe=M.length;oe--;)if(M[oe]===ee)continue e;n&&M.push(ee),N.push(Q)}else p(M,ee,a)||(M!==N&&M.push(ee),N.push(Q))}return N}function ko(r,n){return n=ai(n,r),r=_h(r,n),r==null||delete r[Nr(wr(n))]}function Gu(r,n,a,h){return Dn(r,n,a(_i(r,n)),h)}function _s(r,n,a,h){for(var p=r.length,w=h?p:-1;(h?w--:++w<p)&&n(r[w],w,r););return a?mr(r,h?0:w,h?w+1:p):mr(r,h?w+1:0,h?p:w)}function Yu(r,n){var a=r;return a instanceof Fe&&(a=a.value()),wo(n,function(h,p){return p.func.apply(p.thisArg,ri([h],p.args))},a)}function Ko(r,n,a){var h=r.length;if(h<2)return h?oi(r[0]):[];for(var p=-1,w=z(h);++p<h;)for(var S=r[p],N=-1;++N<h;)N!=p&&(w[p]=bn(w[p]||S,r[N],n,a));return oi($t(w,1),n,a)}function Ju(r,n,a){for(var h=-1,p=r.length,w=n.length,S={};++h<p;){var N=h<w?n[h]:t;a(S,r[h],N)}return S}function Vo(r){return ht(r)?r:[]}function Wo(r){return typeof r=="function"?r:Zt}function ai(r,n){return Se(r)?r:ra(r,n)?[r]:Sh(Qe(r))}var L0=Ue;function ci(r,n,a){var h=r.length;return a=a===t?h:a,!n&&a>=h?r:mr(r,n,a)}var Qu=Dg||function(r){return Ut.clearTimeout(r)};function Xu(r,n){if(n)return r.slice();var a=r.length,h=wu?wu(a):new r.constructor(a);return r.copy(h),h}function Go(r){var n=new r.constructor(r.byteLength);return new as(n).set(new as(r)),n}function M0(r,n){var a=n?Go(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.byteLength)}function j0(r){var n=new r.constructor(r.source,$c.exec(r));return n.lastIndex=r.lastIndex,n}function q0(r){return mn?Ze(mn.call(r)):{}}function Zu(r,n){var a=n?Go(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.length)}function eh(r,n){if(r!==n){var a=r!==t,h=r===null,p=r===r,w=or(r),S=n!==t,N=n===null,M=n===n,Y=or(n);if(!N&&!Y&&!w&&r>n||w&&S&&M&&!N&&!Y||h&&S&&M||!a&&M||!p)return 1;if(!h&&!w&&!Y&&r<n||Y&&a&&p&&!h&&!w||N&&a&&p||!S&&p||!M)return-1}return 0}function F0(r,n,a){for(var h=-1,p=r.criteria,w=n.criteria,S=p.length,N=a.length;++h<S;){var M=eh(p[h],w[h]);if(M){if(h>=N)return M;var Y=a[h];return M*(Y=="desc"?-1:1)}}return r.index-n.index}function th(r,n,a,h){for(var p=-1,w=r.length,S=a.length,N=-1,M=n.length,Y=vt(w-S,0),Q=z(M+Y),ee=!h;++N<M;)Q[N]=n[N];for(;++p<S;)(ee||p<w)&&(Q[a[p]]=r[p]);for(;Y--;)Q[N++]=r[p++];return Q}function rh(r,n,a,h){for(var p=-1,w=r.length,S=-1,N=a.length,M=-1,Y=n.length,Q=vt(w-N,0),ee=z(Q+Y),oe=!h;++p<Q;)ee[p]=r[p];for(var le=p;++M<Y;)ee[le+M]=n[M];for(;++S<N;)(oe||p<w)&&(ee[le+a[S]]=r[p++]);return ee}function Jt(r,n){var a=-1,h=r.length;for(n||(n=z(h));++a<h;)n[a]=r[a];return n}function Rr(r,n,a,h){var p=!a;a||(a={});for(var w=-1,S=n.length;++w<S;){var N=n[w],M=h?h(a[N],r[N],N,a,r):t;M===t&&(M=r[N]),p?qr(a,N,M):wn(a,N,M)}return a}function z0(r,n){return Rr(r,ta(r),n)}function B0(r,n){return Rr(r,gh(r),n)}function Es(r,n){return function(a,h){var p=Se(a)?Wp:h0,w=n?n():{};return p(a,r,de(h,2),w)}}function Gi(r){return Ue(function(n,a){var h=-1,p=a.length,w=p>1?a[p-1]:t,S=p>2?a[2]:t;for(w=r.length>3&&typeof w=="function"?(p--,w):t,S&&Ht(a[0],a[1],S)&&(w=p<3?t:w,p=1),n=Ze(n);++h<p;){var N=a[h];N&&r(n,N,h,w)}return n})}function ih(r,n){return function(a,h){if(a==null)return a;if(!Qt(a))return r(a,h);for(var p=a.length,w=n?p:-1,S=Ze(a);(n?w--:++w<p)&&h(S[w],w,S)!==!1;);return a}}function nh(r){return function(n,a,h){for(var p=-1,w=Ze(n),S=h(n),N=S.length;N--;){var M=S[r?N:++p];if(a(w[M],M,w)===!1)break}return n}}function H0(r,n,a){var h=n&B,p=In(r);function w(){var S=this&&this!==Ut&&this instanceof w?p:r;return S.apply(h?a:this,arguments)}return w}function sh(r){return function(n){n=Qe(n);var a=zi(n)?Ir(n):t,h=a?a[0]:n.charAt(0),p=a?ci(a,1).join(""):n.slice(1);return h[r]()+p}}function Yi(r){return function(n){return wo(il(rl(n).replace(Tp,"")),r,"")}}function In(r){return function(){var n=arguments;switch(n.length){case 0:return new r;case 1:return new r(n[0]);case 2:return new r(n[0],n[1]);case 3:return new r(n[0],n[1],n[2]);case 4:return new r(n[0],n[1],n[2],n[3]);case 5:return new r(n[0],n[1],n[2],n[3],n[4]);case 6:return new r(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new r(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var a=Wi(r.prototype),h=r.apply(a,n);return ot(h)?h:a}}function k0(r,n,a){var h=In(r);function p(){for(var w=arguments.length,S=z(w),N=w,M=Ji(p);N--;)S[N]=arguments[N];var Y=w<3&&S[0]!==M&&S[w-1]!==M?[]:ii(S,M);if(w-=Y.length,w<a)return hh(r,n,Ds,p.placeholder,t,S,Y,t,t,a-w);var Q=this&&this!==Ut&&this instanceof p?h:r;return ir(Q,this,S)}return p}function oh(r){return function(n,a,h){var p=Ze(n);if(!Qt(n)){var w=de(a,3);n=Rt(n),a=function(N){return w(p[N],N,p)}}var S=r(n,a,h);return S>-1?p[w?n[S]:S]:t}}function ah(r){return zr(function(n){var a=n.length,h=a,p=yr.prototype.thru;for(r&&n.reverse();h--;){var w=n[h];if(typeof w!="function")throw new gr(d);if(p&&!S&&Os(w)=="wrapper")var S=new yr([],!0)}for(h=S?h:a;++h<a;){w=n[h];var N=Os(w),M=N=="wrapper"?Zo(w):t;M&&ia(M[0])&&M[1]==(u|L|C|b)&&!M[4].length&&M[9]==1?S=S[Os(M[0])].apply(S,M[3]):S=w.length==1&&ia(w)?S[N]():S.thru(w)}return function(){var Y=arguments,Q=Y[0];if(S&&Y.length==1&&Se(Q))return S.plant(Q).value();for(var ee=0,oe=a?n[ee].apply(this,Y):Q;++ee<a;)oe=n[ee].call(this,oe);return oe}})}function Ds(r,n,a,h,p,w,S,N,M,Y){var Q=n&u,ee=n&B,oe=n&te,le=n&(L|x),pe=n&K,Ne=oe?t:In(r);function ge(){for(var je=arguments.length,ke=z(je),ar=je;ar--;)ke[ar]=arguments[ar];if(le)var kt=Ji(ge),cr=rg(ke,kt);if(h&&(ke=th(ke,h,p,le)),w&&(ke=rh(ke,w,S,le)),je-=cr,le&&je<Y){var lt=ii(ke,kt);return hh(r,n,Ds,ge.placeholder,a,ke,lt,N,M,Y-je)}var Or=ee?a:this,Kr=oe?Or[r]:r;return je=ke.length,N?ke=hy(ke,N):pe&&je>1&&ke.reverse(),Q&&M<je&&(ke.length=M),this&&this!==Ut&&this instanceof ge&&(Kr=Ne||In(Kr)),Kr.apply(Or,ke)}return ge}function ch(r,n){return function(a,h){return m0(a,r,n(h),{})}}function Is(r,n){return function(a,h){var p;if(a===t&&h===t)return n;if(a!==t&&(p=a),h!==t){if(p===t)return h;typeof a=="string"||typeof h=="string"?(a=sr(a),h=sr(h)):(a=Wu(a),h=Wu(h)),p=r(a,h)}return p}}function Yo(r){return zr(function(n){return n=it(n,nr(de())),Ue(function(a){var h=this;return r(n,function(p){return ir(p,h,a)})})})}function Ss(r,n){n=n===t?" ":sr(n);var a=n.length;if(a<2)return a?Bo(n,r):n;var h=Bo(n,ls(r/Bi(n)));return zi(n)?ci(Ir(h),0,r).join(""):h.slice(0,r)}function K0(r,n,a,h){var p=n&B,w=In(r);function S(){for(var N=-1,M=arguments.length,Y=-1,Q=h.length,ee=z(Q+M),oe=this&&this!==Ut&&this instanceof S?w:r;++Y<Q;)ee[Y]=h[Y];for(;M--;)ee[Y++]=arguments[++N];return ir(oe,p?a:this,ee)}return S}function uh(r){return function(n,a,h){return h&&typeof h!="number"&&Ht(n,a,h)&&(a=h=t),n=kr(n),a===t?(a=n,n=0):a=kr(a),h=h===t?n<a?1:-1:kr(h),A0(n,a,h,r)}}function xs(r){return function(n,a){return typeof n=="string"&&typeof a=="string"||(n=br(n),a=br(a)),r(n,a)}}function hh(r,n,a,h,p,w,S,N,M,Y){var Q=n&L,ee=Q?S:t,oe=Q?t:S,le=Q?w:t,pe=Q?t:w;n|=Q?C:E,n&=~(Q?E:C),n&T||(n&=~(B|te));var Ne=[r,n,p,le,ee,pe,oe,N,M,Y],ge=a.apply(t,Ne);return ia(r)&&Eh(ge,Ne),ge.placeholder=h,Dh(ge,r,n)}function Jo(r){var n=yt[r];return function(a,h){if(a=br(a),h=h==null?0:jt(Oe(h),292),h&&Du(a)){var p=(Qe(a)+"e").split("e"),w=n(p[0]+"e"+(+p[1]+h));return p=(Qe(w)+"e").split("e"),+(p[0]+"e"+(+p[1]-h))}return n(a)}}var V0=Ki&&1/ts(new Ki([,-0]))[1]==J?function(r){return new Ki(r)}:ma;function lh(r){return function(n){var a=qt(n);return a==be?xo(n):a==_e?ug(n):tg(n,r(n))}}function Fr(r,n,a,h,p,w,S,N){var M=n&te;if(!M&&typeof r!="function")throw new gr(d);var Y=h?h.length:0;if(Y||(n&=~(C|E),h=p=t),S=S===t?S:vt(Oe(S),0),N=N===t?N:Oe(N),Y-=p?p.length:0,n&E){var Q=h,ee=p;h=p=t}var oe=M?t:Zo(r),le=[r,n,a,h,p,Q,ee,w,S,N];if(oe&&ay(le,oe),r=le[0],n=le[1],a=le[2],h=le[3],p=le[4],N=le[9]=le[9]===t?M?0:r.length:vt(le[9]-Y,0),!N&&n&(L|x)&&(n&=~(L|x)),!n||n==B)var pe=H0(r,n,a);else n==L||n==x?pe=k0(r,n,N):(n==C||n==(B|C))&&!p.length?pe=K0(r,n,a,h):pe=Ds.apply(t,le);var Ne=oe?Ku:Eh;return Dh(Ne(pe,le),r,n)}function fh(r,n,a,h){return r===t||xr(r,ki[a])&&!Xe.call(h,a)?n:r}function dh(r,n,a,h,p,w){return ot(r)&&ot(n)&&(w.set(n,r),ws(r,n,t,dh,w),w.delete(n)),r}function W0(r){return On(r)?t:r}function ph(r,n,a,h,p,w){var S=a&O,N=r.length,M=n.length;if(N!=M&&!(S&&M>N))return!1;var Y=w.get(r),Q=w.get(n);if(Y&&Q)return Y==n&&Q==r;var ee=-1,oe=!0,le=a&q?new wi:t;for(w.set(r,n),w.set(n,r);++ee<N;){var pe=r[ee],Ne=n[ee];if(h)var ge=S?h(Ne,pe,ee,n,r,w):h(pe,Ne,ee,r,n,w);if(ge!==t){if(ge)continue;oe=!1;break}if(le){if(!bo(n,function(je,ke){if(!dn(le,ke)&&(pe===je||p(pe,je,a,h,w)))return le.push(ke)})){oe=!1;break}}else if(!(pe===Ne||p(pe,Ne,a,h,w))){oe=!1;break}}return w.delete(r),w.delete(n),oe}function G0(r,n,a,h,p,w,S){switch(a){case Re:if(r.byteLength!=n.byteLength||r.byteOffset!=n.byteOffset)return!1;r=r.buffer,n=n.buffer;case Ee:return!(r.byteLength!=n.byteLength||!w(new as(r),new as(n)));case F:case U:case Me:return xr(+r,+n);case R:return r.name==n.name&&r.message==n.message;case $e:case Pe:return r==n+"";case be:var N=xo;case _e:var M=h&O;if(N||(N=ts),r.size!=n.size&&!M)return!1;var Y=S.get(r);if(Y)return Y==n;h|=q,S.set(r,n);var Q=ph(N(r),N(n),h,p,w,S);return S.delete(r),Q;case Ce:if(mn)return mn.call(r)==mn.call(n)}return!1}function Y0(r,n,a,h,p,w){var S=a&O,N=Qo(r),M=N.length,Y=Qo(n),Q=Y.length;if(M!=Q&&!S)return!1;for(var ee=M;ee--;){var oe=N[ee];if(!(S?oe in n:Xe.call(n,oe)))return!1}var le=w.get(r),pe=w.get(n);if(le&&pe)return le==n&&pe==r;var Ne=!0;w.set(r,n),w.set(n,r);for(var ge=S;++ee<M;){oe=N[ee];var je=r[oe],ke=n[oe];if(h)var ar=S?h(ke,je,oe,n,r,w):h(je,ke,oe,r,n,w);if(!(ar===t?je===ke||p(je,ke,a,h,w):ar)){Ne=!1;break}ge||(ge=oe=="constructor")}if(Ne&&!ge){var kt=r.constructor,cr=n.constructor;kt!=cr&&"constructor"in r&&"constructor"in n&&!(typeof kt=="function"&&kt instanceof kt&&typeof cr=="function"&&cr instanceof cr)&&(Ne=!1)}return w.delete(r),w.delete(n),Ne}function zr(r){return sa(bh(r,t,Ch),r+"")}function Qo(r){return Uu(r,Rt,ta)}function Xo(r){return Uu(r,Xt,gh)}var Zo=ds?function(r){return ds.get(r)}:ma;function Os(r){for(var n=r.name+"",a=Vi[n],h=Xe.call(Vi,n)?a.length:0;h--;){var p=a[h],w=p.func;if(w==null||w==r)return p.name}return n}function Ji(r){var n=Xe.call(v,"placeholder")?v:r;return n.placeholder}function de(){var r=v.iteratee||ya;return r=r===ya?Mu:r,arguments.length?r(arguments[0],arguments[1]):r}function Ps(r,n){var a=r.__data__;return iy(n)?a[typeof n=="string"?"string":"hash"]:a.map}function ea(r){for(var n=Rt(r),a=n.length;a--;){var h=n[a],p=r[h];n[a]=[h,p,mh(p)]}return n}function Ei(r,n){var a=og(r,n);return Lu(a)?a:t}function J0(r){var n=Xe.call(r,vi),a=r[vi];try{r[vi]=t;var h=!0}catch{}var p=ss.call(r);return h&&(n?r[vi]=a:delete r[vi]),p}var ta=Po?function(r){return r==null?[]:(r=Ze(r),ti(Po(r),function(n){return _u.call(r,n)}))}:wa,gh=Po?function(r){for(var n=[];r;)ri(n,ta(r)),r=cs(r);return n}:wa,qt=Bt;(Co&&qt(new Co(new ArrayBuffer(1)))!=Re||gn&&qt(new gn)!=be||Ao&&qt(Ao.resolve())!=at||Ki&&qt(new Ki)!=_e||yn&&qt(new yn)!=Ie)&&(qt=function(r){var n=Bt(r),a=n==Te?r.constructor:t,h=a?Di(a):"";if(h)switch(h){case Ng:return Re;case Tg:return be;case Ug:return at;case $g:return _e;case Lg:return Ie}return n});function Q0(r,n,a){for(var h=-1,p=a.length;++h<p;){var w=a[h],S=w.size;switch(w.type){case"drop":r+=S;break;case"dropRight":n-=S;break;case"take":n=jt(n,r+S);break;case"takeRight":r=vt(r,n-S);break}}return{start:r,end:n}}function X0(r){var n=r.match(Pt);return n?n[1].split(Ct):[]}function yh(r,n,a){n=ai(n,r);for(var h=-1,p=n.length,w=!1;++h<p;){var S=Nr(n[h]);if(!(w=r!=null&&a(r,S)))break;r=r[S]}return w||++h!=p?w:(p=r==null?0:r.length,!!p&&$s(p)&&Br(S,p)&&(Se(r)||Ii(r)))}function Z0(r){var n=r.length,a=new r.constructor(n);return n&&typeof r[0]=="string"&&Xe.call(r,"index")&&(a.index=r.index,a.input=r.input),a}function vh(r){return typeof r.constructor=="function"&&!Sn(r)?Wi(cs(r)):{}}function ey(r,n,a){var h=r.constructor;switch(n){case Ee:return Go(r);case F:case U:return new h(+r);case Re:return M0(r,a);case qe:case He:case Ke:case Ve:case We:case Ge:case Je:case fr:case Dr:return Zu(r,a);case be:return new h;case Me:case Pe:return new h(r);case $e:return j0(r);case _e:return new h;case Ce:return q0(r)}}function ty(r,n){var a=n.length;if(!a)return r;var h=a-1;return n[h]=(a>1?"& ":"")+n[h],n=n.join(a>2?", ":" "),r.replace(Ot,`{
/* [wrapped with `+n+`] */
`)}function ry(r){return Se(r)||Ii(r)||!!(Eu&&r&&r[Eu])}function Br(r,n){var a=typeof r;return n=n??H,!!n&&(a=="number"||a!="symbol"&&pp.test(r))&&r>-1&&r%1==0&&r<n}function Ht(r,n,a){if(!ot(a))return!1;var h=typeof n;return(h=="number"?Qt(a)&&Br(n,a.length):h=="string"&&n in a)?xr(a[n],r):!1}function ra(r,n){if(Se(r))return!1;var a=typeof r;return a=="number"||a=="symbol"||a=="boolean"||r==null||or(r)?!0:Dt.test(r)||!Et.test(r)||n!=null&&r in Ze(n)}function iy(r){var n=typeof r;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?r!=="__proto__":r===null}function ia(r){var n=Os(r),a=v[n];if(typeof a!="function"||!(n in Fe.prototype))return!1;if(r===a)return!0;var h=Zo(a);return!!h&&r===h[0]}function ny(r){return!!mu&&mu in r}var sy=is?Hr:ba;function Sn(r){var n=r&&r.constructor,a=typeof n=="function"&&n.prototype||ki;return r===a}function mh(r){return r===r&&!ot(r)}function wh(r,n){return function(a){return a==null?!1:a[r]===n&&(n!==t||r in Ze(a))}}function oy(r){var n=Ts(r,function(h){return a.size===g&&a.clear(),h}),a=n.cache;return n}function ay(r,n){var a=r[1],h=n[1],p=a|h,w=p<(B|te|u),S=h==u&&a==L||h==u&&a==b&&r[7].length<=n[8]||h==(u|b)&&n[7].length<=n[8]&&a==L;if(!(w||S))return r;h&B&&(r[2]=n[2],p|=a&B?0:T);var N=n[3];if(N){var M=r[3];r[3]=M?th(M,N,n[4]):N,r[4]=M?ii(r[3],m):n[4]}return N=n[5],N&&(M=r[5],r[5]=M?rh(M,N,n[6]):N,r[6]=M?ii(r[5],m):n[6]),N=n[7],N&&(r[7]=N),h&u&&(r[8]=r[8]==null?n[8]:jt(r[8],n[8])),r[9]==null&&(r[9]=n[9]),r[0]=n[0],r[1]=p,r}function cy(r){var n=[];if(r!=null)for(var a in Ze(r))n.push(a);return n}function uy(r){return ss.call(r)}function bh(r,n,a){return n=vt(n===t?r.length-1:n,0),function(){for(var h=arguments,p=-1,w=vt(h.length-n,0),S=z(w);++p<w;)S[p]=h[n+p];p=-1;for(var N=z(n+1);++p<n;)N[p]=h[p];return N[n]=a(S),ir(r,this,N)}}function _h(r,n){return n.length<2?r:_i(r,mr(n,0,-1))}function hy(r,n){for(var a=r.length,h=jt(n.length,a),p=Jt(r);h--;){var w=n[h];r[h]=Br(w,a)?p[w]:t}return r}function na(r,n){if(!(n==="constructor"&&typeof r[n]=="function")&&n!="__proto__")return r[n]}var Eh=Ih(Ku),xn=Sg||function(r,n){return Ut.setTimeout(r,n)},sa=Ih(T0);function Dh(r,n,a){var h=n+"";return sa(r,ty(h,ly(X0(h),a)))}function Ih(r){var n=0,a=0;return function(){var h=Cg(),p=ue-(h-a);if(a=h,p>0){if(++n>=ae)return arguments[0]}else n=0;return r.apply(t,arguments)}}function Cs(r,n){var a=-1,h=r.length,p=h-1;for(n=n===t?h:n;++a<n;){var w=zo(a,p),S=r[w];r[w]=r[a],r[a]=S}return r.length=n,r}var Sh=oy(function(r){var n=[];return r.charCodeAt(0)===46&&n.push(""),r.replace(It,function(a,h,p,w){n.push(p?w.replace(cp,"$1"):h||a)}),n});function Nr(r){if(typeof r=="string"||or(r))return r;var n=r+"";return n=="0"&&1/r==-J?"-0":n}function Di(r){if(r!=null){try{return ns.call(r)}catch{}try{return r+""}catch{}}return""}function ly(r,n){return pr(me,function(a){var h="_."+a[0];n&a[1]&&!Zn(r,h)&&r.push(h)}),r.sort()}function xh(r){if(r instanceof Fe)return r.clone();var n=new yr(r.__wrapped__,r.__chain__);return n.__actions__=Jt(r.__actions__),n.__index__=r.__index__,n.__values__=r.__values__,n}function fy(r,n,a){(a?Ht(r,n,a):n===t)?n=1:n=vt(Oe(n),0);var h=r==null?0:r.length;if(!h||n<1)return[];for(var p=0,w=0,S=z(ls(h/n));p<h;)S[w++]=mr(r,p,p+=n);return S}function dy(r){for(var n=-1,a=r==null?0:r.length,h=0,p=[];++n<a;){var w=r[n];w&&(p[h++]=w)}return p}function py(){var r=arguments.length;if(!r)return[];for(var n=z(r-1),a=arguments[0],h=r;h--;)n[h-1]=arguments[h];return ri(Se(a)?Jt(a):[a],$t(n,1))}var gy=Ue(function(r,n){return ht(r)?bn(r,$t(n,1,ht,!0)):[]}),yy=Ue(function(r,n){var a=wr(n);return ht(a)&&(a=t),ht(r)?bn(r,$t(n,1,ht,!0),de(a,2)):[]}),vy=Ue(function(r,n){var a=wr(n);return ht(a)&&(a=t),ht(r)?bn(r,$t(n,1,ht,!0),t,a):[]});function my(r,n,a){var h=r==null?0:r.length;return h?(n=a||n===t?1:Oe(n),mr(r,n<0?0:n,h)):[]}function wy(r,n,a){var h=r==null?0:r.length;return h?(n=a||n===t?1:Oe(n),n=h-n,mr(r,0,n<0?0:n)):[]}function by(r,n){return r&&r.length?_s(r,de(n,3),!0,!0):[]}function _y(r,n){return r&&r.length?_s(r,de(n,3),!0):[]}function Ey(r,n,a,h){var p=r==null?0:r.length;return p?(a&&typeof a!="number"&&Ht(r,n,a)&&(a=0,h=p),p0(r,n,a,h)):[]}function Oh(r,n,a){var h=r==null?0:r.length;if(!h)return-1;var p=a==null?0:Oe(a);return p<0&&(p=vt(h+p,0)),es(r,de(n,3),p)}function Ph(r,n,a){var h=r==null?0:r.length;if(!h)return-1;var p=h-1;return a!==t&&(p=Oe(a),p=a<0?vt(h+p,0):jt(p,h-1)),es(r,de(n,3),p,!0)}function Ch(r){var n=r==null?0:r.length;return n?$t(r,1):[]}function Dy(r){var n=r==null?0:r.length;return n?$t(r,J):[]}function Iy(r,n){var a=r==null?0:r.length;return a?(n=n===t?1:Oe(n),$t(r,n)):[]}function Sy(r){for(var n=-1,a=r==null?0:r.length,h={};++n<a;){var p=r[n];h[p[0]]=p[1]}return h}function Ah(r){return r&&r.length?r[0]:t}function xy(r,n,a){var h=r==null?0:r.length;if(!h)return-1;var p=a==null?0:Oe(a);return p<0&&(p=vt(h+p,0)),Fi(r,n,p)}function Oy(r){var n=r==null?0:r.length;return n?mr(r,0,-1):[]}var Py=Ue(function(r){var n=it(r,Vo);return n.length&&n[0]===r[0]?Lo(n):[]}),Cy=Ue(function(r){var n=wr(r),a=it(r,Vo);return n===wr(a)?n=t:a.pop(),a.length&&a[0]===r[0]?Lo(a,de(n,2)):[]}),Ay=Ue(function(r){var n=wr(r),a=it(r,Vo);return n=typeof n=="function"?n:t,n&&a.pop(),a.length&&a[0]===r[0]?Lo(a,t,n):[]});function Ry(r,n){return r==null?"":Og.call(r,n)}function wr(r){var n=r==null?0:r.length;return n?r[n-1]:t}function Ny(r,n,a){var h=r==null?0:r.length;if(!h)return-1;var p=h;return a!==t&&(p=Oe(a),p=p<0?vt(h+p,0):jt(p,h-1)),n===n?lg(r,n,p):es(r,hu,p,!0)}function Ty(r,n){return r&&r.length?zu(r,Oe(n)):t}var Uy=Ue(Rh);function Rh(r,n){return r&&r.length&&n&&n.length?Fo(r,n):r}function $y(r,n,a){return r&&r.length&&n&&n.length?Fo(r,n,de(a,2)):r}function Ly(r,n,a){return r&&r.length&&n&&n.length?Fo(r,n,t,a):r}var My=zr(function(r,n){var a=r==null?0:r.length,h=No(r,n);return ku(r,it(n,function(p){return Br(p,a)?+p:p}).sort(eh)),h});function jy(r,n){var a=[];if(!(r&&r.length))return a;var h=-1,p=[],w=r.length;for(n=de(n,3);++h<w;){var S=r[h];n(S,h,r)&&(a.push(S),p.push(h))}return ku(r,p),a}function oa(r){return r==null?r:Rg.call(r)}function qy(r,n,a){var h=r==null?0:r.length;return h?(a&&typeof a!="number"&&Ht(r,n,a)?(n=0,a=h):(n=n==null?0:Oe(n),a=a===t?h:Oe(a)),mr(r,n,a)):[]}function Fy(r,n){return bs(r,n)}function zy(r,n,a){return Ho(r,n,de(a,2))}function By(r,n){var a=r==null?0:r.length;if(a){var h=bs(r,n);if(h<a&&xr(r[h],n))return h}return-1}function Hy(r,n){return bs(r,n,!0)}function ky(r,n,a){return Ho(r,n,de(a,2),!0)}function Ky(r,n){var a=r==null?0:r.length;if(a){var h=bs(r,n,!0)-1;if(xr(r[h],n))return h}return-1}function Vy(r){return r&&r.length?Vu(r):[]}function Wy(r,n){return r&&r.length?Vu(r,de(n,2)):[]}function Gy(r){var n=r==null?0:r.length;return n?mr(r,1,n):[]}function Yy(r,n,a){return r&&r.length?(n=a||n===t?1:Oe(n),mr(r,0,n<0?0:n)):[]}function Jy(r,n,a){var h=r==null?0:r.length;return h?(n=a||n===t?1:Oe(n),n=h-n,mr(r,n<0?0:n,h)):[]}function Qy(r,n){return r&&r.length?_s(r,de(n,3),!1,!0):[]}function Xy(r,n){return r&&r.length?_s(r,de(n,3)):[]}var Zy=Ue(function(r){return oi($t(r,1,ht,!0))}),ev=Ue(function(r){var n=wr(r);return ht(n)&&(n=t),oi($t(r,1,ht,!0),de(n,2))}),tv=Ue(function(r){var n=wr(r);return n=typeof n=="function"?n:t,oi($t(r,1,ht,!0),t,n)});function rv(r){return r&&r.length?oi(r):[]}function iv(r,n){return r&&r.length?oi(r,de(n,2)):[]}function nv(r,n){return n=typeof n=="function"?n:t,r&&r.length?oi(r,t,n):[]}function aa(r){if(!(r&&r.length))return[];var n=0;return r=ti(r,function(a){if(ht(a))return n=vt(a.length,n),!0}),Io(n,function(a){return it(r,_o(a))})}function Nh(r,n){if(!(r&&r.length))return[];var a=aa(r);return n==null?a:it(a,function(h){return ir(n,t,h)})}var sv=Ue(function(r,n){return ht(r)?bn(r,n):[]}),ov=Ue(function(r){return Ko(ti(r,ht))}),av=Ue(function(r){var n=wr(r);return ht(n)&&(n=t),Ko(ti(r,ht),de(n,2))}),cv=Ue(function(r){var n=wr(r);return n=typeof n=="function"?n:t,Ko(ti(r,ht),t,n)}),uv=Ue(aa);function hv(r,n){return Ju(r||[],n||[],wn)}function lv(r,n){return Ju(r||[],n||[],Dn)}var fv=Ue(function(r){var n=r.length,a=n>1?r[n-1]:t;return a=typeof a=="function"?(r.pop(),a):t,Nh(r,a)});function Th(r){var n=v(r);return n.__chain__=!0,n}function dv(r,n){return n(r),r}function As(r,n){return n(r)}var pv=zr(function(r){var n=r.length,a=n?r[0]:0,h=this.__wrapped__,p=function(w){return No(w,r)};return n>1||this.__actions__.length||!(h instanceof Fe)||!Br(a)?this.thru(p):(h=h.slice(a,+a+(n?1:0)),h.__actions__.push({func:As,args:[p],thisArg:t}),new yr(h,this.__chain__).thru(function(w){return n&&!w.length&&w.push(t),w}))});function gv(){return Th(this)}function yv(){return new yr(this.value(),this.__chain__)}function vv(){this.__values__===t&&(this.__values__=Wh(this.value()));var r=this.__index__>=this.__values__.length,n=r?t:this.__values__[this.__index__++];return{done:r,value:n}}function mv(){return this}function wv(r){for(var n,a=this;a instanceof gs;){var h=xh(a);h.__index__=0,h.__values__=t,n?p.__wrapped__=h:n=h;var p=h;a=a.__wrapped__}return p.__wrapped__=r,n}function bv(){var r=this.__wrapped__;if(r instanceof Fe){var n=r;return this.__actions__.length&&(n=new Fe(this)),n=n.reverse(),n.__actions__.push({func:As,args:[oa],thisArg:t}),new yr(n,this.__chain__)}return this.thru(oa)}function _v(){return Yu(this.__wrapped__,this.__actions__)}var Ev=Es(function(r,n,a){Xe.call(r,a)?++r[a]:qr(r,a,1)});function Dv(r,n,a){var h=Se(r)?cu:d0;return a&&Ht(r,n,a)&&(n=t),h(r,de(n,3))}function Iv(r,n){var a=Se(r)?ti:Nu;return a(r,de(n,3))}var Sv=oh(Oh),xv=oh(Ph);function Ov(r,n){return $t(Rs(r,n),1)}function Pv(r,n){return $t(Rs(r,n),J)}function Cv(r,n,a){return a=a===t?1:Oe(a),$t(Rs(r,n),a)}function Uh(r,n){var a=Se(r)?pr:si;return a(r,de(n,3))}function $h(r,n){var a=Se(r)?Gp:Ru;return a(r,de(n,3))}var Av=Es(function(r,n,a){Xe.call(r,a)?r[a].push(n):qr(r,a,[n])});function Rv(r,n,a,h){r=Qt(r)?r:Xi(r),a=a&&!h?Oe(a):0;var p=r.length;return a<0&&(a=vt(p+a,0)),Ls(r)?a<=p&&r.indexOf(n,a)>-1:!!p&&Fi(r,n,a)>-1}var Nv=Ue(function(r,n,a){var h=-1,p=typeof n=="function",w=Qt(r)?z(r.length):[];return si(r,function(S){w[++h]=p?ir(n,S,a):_n(S,n,a)}),w}),Tv=Es(function(r,n,a){qr(r,a,n)});function Rs(r,n){var a=Se(r)?it:ju;return a(r,de(n,3))}function Uv(r,n,a,h){return r==null?[]:(Se(n)||(n=n==null?[]:[n]),a=h?t:a,Se(a)||(a=a==null?[]:[a]),Bu(r,n,a))}var $v=Es(function(r,n,a){r[a?0:1].push(n)},function(){return[[],[]]});function Lv(r,n,a){var h=Se(r)?wo:fu,p=arguments.length<3;return h(r,de(n,4),a,p,si)}function Mv(r,n,a){var h=Se(r)?Yp:fu,p=arguments.length<3;return h(r,de(n,4),a,p,Ru)}function jv(r,n){var a=Se(r)?ti:Nu;return a(r,Us(de(n,3)))}function qv(r){var n=Se(r)?Ou:R0;return n(r)}function Fv(r,n,a){(a?Ht(r,n,a):n===t)?n=1:n=Oe(n);var h=Se(r)?c0:N0;return h(r,n)}function zv(r){var n=Se(r)?u0:U0;return n(r)}function Bv(r){if(r==null)return 0;if(Qt(r))return Ls(r)?Bi(r):r.length;var n=qt(r);return n==be||n==_e?r.size:jo(r).length}function Hv(r,n,a){var h=Se(r)?bo:$0;return a&&Ht(r,n,a)&&(n=t),h(r,de(n,3))}var kv=Ue(function(r,n){if(r==null)return[];var a=n.length;return a>1&&Ht(r,n[0],n[1])?n=[]:a>2&&Ht(n[0],n[1],n[2])&&(n=[n[0]]),Bu(r,$t(n,1),[])}),Ns=Ig||function(){return Ut.Date.now()};function Kv(r,n){if(typeof n!="function")throw new gr(d);return r=Oe(r),function(){if(--r<1)return n.apply(this,arguments)}}function Lh(r,n,a){return n=a?t:n,n=r&&n==null?r.length:n,Fr(r,u,t,t,t,t,n)}function Mh(r,n){var a;if(typeof n!="function")throw new gr(d);return r=Oe(r),function(){return--r>0&&(a=n.apply(this,arguments)),r<=1&&(n=t),a}}var ca=Ue(function(r,n,a){var h=B;if(a.length){var p=ii(a,Ji(ca));h|=C}return Fr(r,h,n,a,p)}),jh=Ue(function(r,n,a){var h=B|te;if(a.length){var p=ii(a,Ji(jh));h|=C}return Fr(n,h,r,a,p)});function qh(r,n,a){n=a?t:n;var h=Fr(r,L,t,t,t,t,t,n);return h.placeholder=qh.placeholder,h}function Fh(r,n,a){n=a?t:n;var h=Fr(r,x,t,t,t,t,t,n);return h.placeholder=Fh.placeholder,h}function zh(r,n,a){var h,p,w,S,N,M,Y=0,Q=!1,ee=!1,oe=!0;if(typeof r!="function")throw new gr(d);n=br(n)||0,ot(a)&&(Q=!!a.leading,ee="maxWait"in a,w=ee?vt(br(a.maxWait)||0,n):w,oe="trailing"in a?!!a.trailing:oe);function le(lt){var Or=h,Kr=p;return h=p=t,Y=lt,S=r.apply(Kr,Or),S}function pe(lt){return Y=lt,N=xn(je,n),Q?le(lt):S}function Ne(lt){var Or=lt-M,Kr=lt-Y,ol=n-Or;return ee?jt(ol,w-Kr):ol}function ge(lt){var Or=lt-M,Kr=lt-Y;return M===t||Or>=n||Or<0||ee&&Kr>=w}function je(){var lt=Ns();if(ge(lt))return ke(lt);N=xn(je,Ne(lt))}function ke(lt){return N=t,oe&&h?le(lt):(h=p=t,S)}function ar(){N!==t&&Qu(N),Y=0,h=M=p=N=t}function kt(){return N===t?S:ke(Ns())}function cr(){var lt=Ns(),Or=ge(lt);if(h=arguments,p=this,M=lt,Or){if(N===t)return pe(M);if(ee)return Qu(N),N=xn(je,n),le(M)}return N===t&&(N=xn(je,n)),S}return cr.cancel=ar,cr.flush=kt,cr}var Vv=Ue(function(r,n){return Au(r,1,n)}),Wv=Ue(function(r,n,a){return Au(r,br(n)||0,a)});function Gv(r){return Fr(r,K)}function Ts(r,n){if(typeof r!="function"||n!=null&&typeof n!="function")throw new gr(d);var a=function(){var h=arguments,p=n?n.apply(this,h):h[0],w=a.cache;if(w.has(p))return w.get(p);var S=r.apply(this,h);return a.cache=w.set(p,S)||w,S};return a.cache=new(Ts.Cache||jr),a}Ts.Cache=jr;function Us(r){if(typeof r!="function")throw new gr(d);return function(){var n=arguments;switch(n.length){case 0:return!r.call(this);case 1:return!r.call(this,n[0]);case 2:return!r.call(this,n[0],n[1]);case 3:return!r.call(this,n[0],n[1],n[2])}return!r.apply(this,n)}}function Yv(r){return Mh(2,r)}var Jv=L0(function(r,n){n=n.length==1&&Se(n[0])?it(n[0],nr(de())):it($t(n,1),nr(de()));var a=n.length;return Ue(function(h){for(var p=-1,w=jt(h.length,a);++p<w;)h[p]=n[p].call(this,h[p]);return ir(r,this,h)})}),ua=Ue(function(r,n){var a=ii(n,Ji(ua));return Fr(r,C,t,n,a)}),Bh=Ue(function(r,n){var a=ii(n,Ji(Bh));return Fr(r,E,t,n,a)}),Qv=zr(function(r,n){return Fr(r,b,t,t,t,n)});function Xv(r,n){if(typeof r!="function")throw new gr(d);return n=n===t?n:Oe(n),Ue(r,n)}function Zv(r,n){if(typeof r!="function")throw new gr(d);return n=n==null?0:vt(Oe(n),0),Ue(function(a){var h=a[n],p=ci(a,0,n);return h&&ri(p,h),ir(r,this,p)})}function em(r,n,a){var h=!0,p=!0;if(typeof r!="function")throw new gr(d);return ot(a)&&(h="leading"in a?!!a.leading:h,p="trailing"in a?!!a.trailing:p),zh(r,n,{leading:h,maxWait:n,trailing:p})}function tm(r){return Lh(r,1)}function rm(r,n){return ua(Wo(n),r)}function im(){if(!arguments.length)return[];var r=arguments[0];return Se(r)?r:[r]}function nm(r){return vr(r,A)}function sm(r,n){return n=typeof n=="function"?n:t,vr(r,A,n)}function om(r){return vr(r,D|A)}function am(r,n){return n=typeof n=="function"?n:t,vr(r,D|A,n)}function cm(r,n){return n==null||Cu(r,n,Rt(n))}function xr(r,n){return r===n||r!==r&&n!==n}var um=xs($o),hm=xs(function(r,n){return r>=n}),Ii=$u(function(){return arguments}())?$u:function(r){return ut(r)&&Xe.call(r,"callee")&&!_u.call(r,"callee")},Se=z.isArray,lm=ru?nr(ru):w0;function Qt(r){return r!=null&&$s(r.length)&&!Hr(r)}function ht(r){return ut(r)&&Qt(r)}function fm(r){return r===!0||r===!1||ut(r)&&Bt(r)==F}var ui=xg||ba,dm=iu?nr(iu):b0;function pm(r){return ut(r)&&r.nodeType===1&&!On(r)}function gm(r){if(r==null)return!0;if(Qt(r)&&(Se(r)||typeof r=="string"||typeof r.splice=="function"||ui(r)||Qi(r)||Ii(r)))return!r.length;var n=qt(r);if(n==be||n==_e)return!r.size;if(Sn(r))return!jo(r).length;for(var a in r)if(Xe.call(r,a))return!1;return!0}function ym(r,n){return En(r,n)}function vm(r,n,a){a=typeof a=="function"?a:t;var h=a?a(r,n):t;return h===t?En(r,n,t,a):!!h}function ha(r){if(!ut(r))return!1;var n=Bt(r);return n==R||n==l||typeof r.message=="string"&&typeof r.name=="string"&&!On(r)}function mm(r){return typeof r=="number"&&Du(r)}function Hr(r){if(!ot(r))return!1;var n=Bt(r);return n==ne||n==ce||n==j||n==ct}function Hh(r){return typeof r=="number"&&r==Oe(r)}function $s(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=H}function ot(r){var n=typeof r;return r!=null&&(n=="object"||n=="function")}function ut(r){return r!=null&&typeof r=="object"}var kh=nu?nr(nu):E0;function wm(r,n){return r===n||Mo(r,n,ea(n))}function bm(r,n,a){return a=typeof a=="function"?a:t,Mo(r,n,ea(n),a)}function _m(r){return Kh(r)&&r!=+r}function Em(r){if(sy(r))throw new De(c);return Lu(r)}function Dm(r){return r===null}function Im(r){return r==null}function Kh(r){return typeof r=="number"||ut(r)&&Bt(r)==Me}function On(r){if(!ut(r)||Bt(r)!=Te)return!1;var n=cs(r);if(n===null)return!0;var a=Xe.call(n,"constructor")&&n.constructor;return typeof a=="function"&&a instanceof a&&ns.call(a)==bg}var la=su?nr(su):D0;function Sm(r){return Hh(r)&&r>=-H&&r<=H}var Vh=ou?nr(ou):I0;function Ls(r){return typeof r=="string"||!Se(r)&&ut(r)&&Bt(r)==Pe}function or(r){return typeof r=="symbol"||ut(r)&&Bt(r)==Ce}var Qi=au?nr(au):S0;function xm(r){return r===t}function Om(r){return ut(r)&&qt(r)==Ie}function Pm(r){return ut(r)&&Bt(r)==Ae}var Cm=xs(qo),Am=xs(function(r,n){return r<=n});function Wh(r){if(!r)return[];if(Qt(r))return Ls(r)?Ir(r):Jt(r);if(pn&&r[pn])return cg(r[pn]());var n=qt(r),a=n==be?xo:n==_e?ts:Xi;return a(r)}function kr(r){if(!r)return r===0?r:0;if(r=br(r),r===J||r===-J){var n=r<0?-1:1;return n*k}return r===r?r:0}function Oe(r){var n=kr(r),a=n%1;return n===n?a?n-a:n:0}function Gh(r){return r?bi(Oe(r),0,Z):0}function br(r){if(typeof r=="number")return r;if(or(r))return G;if(ot(r)){var n=typeof r.valueOf=="function"?r.valueOf():r;r=ot(n)?n+"":n}if(typeof r!="string")return r===0?r:+r;r=du(r);var a=lp.test(r);return a||dp.test(r)?Kp(r.slice(2),a?2:8):hp.test(r)?G:+r}function Yh(r){return Rr(r,Xt(r))}function Rm(r){return r?bi(Oe(r),-H,H):r===0?r:0}function Qe(r){return r==null?"":sr(r)}var Nm=Gi(function(r,n){if(Sn(n)||Qt(n)){Rr(n,Rt(n),r);return}for(var a in n)Xe.call(n,a)&&wn(r,a,n[a])}),Jh=Gi(function(r,n){Rr(n,Xt(n),r)}),Ms=Gi(function(r,n,a,h){Rr(n,Xt(n),r,h)}),Tm=Gi(function(r,n,a,h){Rr(n,Rt(n),r,h)}),Um=zr(No);function $m(r,n){var a=Wi(r);return n==null?a:Pu(a,n)}var Lm=Ue(function(r,n){r=Ze(r);var a=-1,h=n.length,p=h>2?n[2]:t;for(p&&Ht(n[0],n[1],p)&&(h=1);++a<h;)for(var w=n[a],S=Xt(w),N=-1,M=S.length;++N<M;){var Y=S[N],Q=r[Y];(Q===t||xr(Q,ki[Y])&&!Xe.call(r,Y))&&(r[Y]=w[Y])}return r}),Mm=Ue(function(r){return r.push(t,dh),ir(Qh,t,r)});function jm(r,n){return uu(r,de(n,3),Ar)}function qm(r,n){return uu(r,de(n,3),Uo)}function Fm(r,n){return r==null?r:To(r,de(n,3),Xt)}function zm(r,n){return r==null?r:Tu(r,de(n,3),Xt)}function Bm(r,n){return r&&Ar(r,de(n,3))}function Hm(r,n){return r&&Uo(r,de(n,3))}function km(r){return r==null?[]:ms(r,Rt(r))}function Km(r){return r==null?[]:ms(r,Xt(r))}function fa(r,n,a){var h=r==null?t:_i(r,n);return h===t?a:h}function Vm(r,n){return r!=null&&yh(r,n,g0)}function da(r,n){return r!=null&&yh(r,n,y0)}var Wm=ch(function(r,n,a){n!=null&&typeof n.toString!="function"&&(n=ss.call(n)),r[n]=a},ga(Zt)),Gm=ch(function(r,n,a){n!=null&&typeof n.toString!="function"&&(n=ss.call(n)),Xe.call(r,n)?r[n].push(a):r[n]=[a]},de),Ym=Ue(_n);function Rt(r){return Qt(r)?xu(r):jo(r)}function Xt(r){return Qt(r)?xu(r,!0):x0(r)}function Jm(r,n){var a={};return n=de(n,3),Ar(r,function(h,p,w){qr(a,n(h,p,w),h)}),a}function Qm(r,n){var a={};return n=de(n,3),Ar(r,function(h,p,w){qr(a,p,n(h,p,w))}),a}var Xm=Gi(function(r,n,a){ws(r,n,a)}),Qh=Gi(function(r,n,a,h){ws(r,n,a,h)}),Zm=zr(function(r,n){var a={};if(r==null)return a;var h=!1;n=it(n,function(w){return w=ai(w,r),h||(h=w.length>1),w}),Rr(r,Xo(r),a),h&&(a=vr(a,D|I|A,W0));for(var p=n.length;p--;)ko(a,n[p]);return a});function ew(r,n){return Xh(r,Us(de(n)))}var tw=zr(function(r,n){return r==null?{}:P0(r,n)});function Xh(r,n){if(r==null)return{};var a=it(Xo(r),function(h){return[h]});return n=de(n),Hu(r,a,function(h,p){return n(h,p[0])})}function rw(r,n,a){n=ai(n,r);var h=-1,p=n.length;for(p||(p=1,r=t);++h<p;){var w=r==null?t:r[Nr(n[h])];w===t&&(h=p,w=a),r=Hr(w)?w.call(r):w}return r}function iw(r,n,a){return r==null?r:Dn(r,n,a)}function nw(r,n,a,h){return h=typeof h=="function"?h:t,r==null?r:Dn(r,n,a,h)}var Zh=lh(Rt),el=lh(Xt);function sw(r,n,a){var h=Se(r),p=h||ui(r)||Qi(r);if(n=de(n,4),a==null){var w=r&&r.constructor;p?a=h?new w:[]:ot(r)?a=Hr(w)?Wi(cs(r)):{}:a={}}return(p?pr:Ar)(r,function(S,N,M){return n(a,S,N,M)}),a}function ow(r,n){return r==null?!0:ko(r,n)}function aw(r,n,a){return r==null?r:Gu(r,n,Wo(a))}function cw(r,n,a,h){return h=typeof h=="function"?h:t,r==null?r:Gu(r,n,Wo(a),h)}function Xi(r){return r==null?[]:So(r,Rt(r))}function uw(r){return r==null?[]:So(r,Xt(r))}function hw(r,n,a){return a===t&&(a=n,n=t),a!==t&&(a=br(a),a=a===a?a:0),n!==t&&(n=br(n),n=n===n?n:0),bi(br(r),n,a)}function lw(r,n,a){return n=kr(n),a===t?(a=n,n=0):a=kr(a),r=br(r),v0(r,n,a)}function fw(r,n,a){if(a&&typeof a!="boolean"&&Ht(r,n,a)&&(n=a=t),a===t&&(typeof n=="boolean"?(a=n,n=t):typeof r=="boolean"&&(a=r,r=t)),r===t&&n===t?(r=0,n=1):(r=kr(r),n===t?(n=r,r=0):n=kr(n)),r>n){var h=r;r=n,n=h}if(a||r%1||n%1){var p=Iu();return jt(r+p*(n-r+kp("1e-"+((p+"").length-1))),n)}return zo(r,n)}var dw=Yi(function(r,n,a){return n=n.toLowerCase(),r+(a?tl(n):n)});function tl(r){return pa(Qe(r).toLowerCase())}function rl(r){return r=Qe(r),r&&r.replace(gp,ig).replace(Up,"")}function pw(r,n,a){r=Qe(r),n=sr(n);var h=r.length;a=a===t?h:bi(Oe(a),0,h);var p=a;return a-=n.length,a>=0&&r.slice(a,p)==n}function gw(r){return r=Qe(r),r&&wt.test(r)?r.replace(fn,ng):r}function yw(r){return r=Qe(r),r&&St.test(r)?r.replace(dt,"\\$&"):r}var vw=Yi(function(r,n,a){return r+(a?"-":"")+n.toLowerCase()}),mw=Yi(function(r,n,a){return r+(a?" ":"")+n.toLowerCase()}),ww=sh("toLowerCase");function bw(r,n,a){r=Qe(r),n=Oe(n);var h=n?Bi(r):0;if(!n||h>=n)return r;var p=(n-h)/2;return Ss(fs(p),a)+r+Ss(ls(p),a)}function _w(r,n,a){r=Qe(r),n=Oe(n);var h=n?Bi(r):0;return n&&h<n?r+Ss(n-h,a):r}function Ew(r,n,a){r=Qe(r),n=Oe(n);var h=n?Bi(r):0;return n&&h<n?Ss(n-h,a)+r:r}function Dw(r,n,a){return a||n==null?n=0:n&&(n=+n),Ag(Qe(r).replace(pt,""),n||0)}function Iw(r,n,a){return(a?Ht(r,n,a):n===t)?n=1:n=Oe(n),Bo(Qe(r),n)}function Sw(){var r=arguments,n=Qe(r[0]);return r.length<3?n:n.replace(r[1],r[2])}var xw=Yi(function(r,n,a){return r+(a?"_":"")+n.toLowerCase()});function Ow(r,n,a){return a&&typeof a!="number"&&Ht(r,n,a)&&(n=a=t),a=a===t?Z:a>>>0,a?(r=Qe(r),r&&(typeof n=="string"||n!=null&&!la(n))&&(n=sr(n),!n&&zi(r))?ci(Ir(r),0,a):r.split(n,a)):[]}var Pw=Yi(function(r,n,a){return r+(a?" ":"")+pa(n)});function Cw(r,n,a){return r=Qe(r),a=a==null?0:bi(Oe(a),0,r.length),n=sr(n),r.slice(a,a+n.length)==n}function Aw(r,n,a){var h=v.templateSettings;a&&Ht(r,n,a)&&(n=t),r=Qe(r),n=Ms({},n,h,fh);var p=Ms({},n.imports,h.imports,fh),w=Rt(p),S=So(p,w),N,M,Y=0,Q=n.interpolate||Jn,ee="__p += '",oe=Oo((n.escape||Jn).source+"|"+Q.source+"|"+(Q===gt?up:Jn).source+"|"+(n.evaluate||Jn).source+"|$","g"),le="//# sourceURL="+(Xe.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++qp+"]")+`
`;r.replace(oe,function(ge,je,ke,ar,kt,cr){return ke||(ke=ar),ee+=r.slice(Y,cr).replace(yp,sg),je&&(N=!0,ee+=`' +
__e(`+je+`) +
'`),kt&&(M=!0,ee+=`';
`+kt+`;
__p += '`),ke&&(ee+=`' +
((__t = (`+ke+`)) == null ? '' : __t) +
'`),Y=cr+ge.length,ge}),ee+=`';
`;var pe=Xe.call(n,"variable")&&n.variable;if(!pe)ee=`with (obj) {
`+ee+`
}
`;else if(ap.test(pe))throw new De(f);ee=(M?ee.replace(ei,""):ee).replace(gi,"$1").replace(Mi,"$1;"),ee="function("+(pe||"obj")+`) {
`+(pe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(N?", __e = _.escape":"")+(M?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ee+`return __p
}`;var Ne=nl(function(){return Ye(w,le+"return "+ee).apply(t,S)});if(Ne.source=ee,ha(Ne))throw Ne;return Ne}function Rw(r){return Qe(r).toLowerCase()}function Nw(r){return Qe(r).toUpperCase()}function Tw(r,n,a){if(r=Qe(r),r&&(a||n===t))return du(r);if(!r||!(n=sr(n)))return r;var h=Ir(r),p=Ir(n),w=pu(h,p),S=gu(h,p)+1;return ci(h,w,S).join("")}function Uw(r,n,a){if(r=Qe(r),r&&(a||n===t))return r.slice(0,vu(r)+1);if(!r||!(n=sr(n)))return r;var h=Ir(r),p=gu(h,Ir(n))+1;return ci(h,0,p).join("")}function $w(r,n,a){if(r=Qe(r),r&&(a||n===t))return r.replace(pt,"");if(!r||!(n=sr(n)))return r;var h=Ir(r),p=pu(h,Ir(n));return ci(h,p).join("")}function Lw(r,n){var a=W,h=re;if(ot(n)){var p="separator"in n?n.separator:p;a="length"in n?Oe(n.length):a,h="omission"in n?sr(n.omission):h}r=Qe(r);var w=r.length;if(zi(r)){var S=Ir(r);w=S.length}if(a>=w)return r;var N=a-Bi(h);if(N<1)return h;var M=S?ci(S,0,N).join(""):r.slice(0,N);if(p===t)return M+h;if(S&&(N+=M.length-N),la(p)){if(r.slice(N).search(p)){var Y,Q=M;for(p.global||(p=Oo(p.source,Qe($c.exec(p))+"g")),p.lastIndex=0;Y=p.exec(Q);)var ee=Y.index;M=M.slice(0,ee===t?N:ee)}}else if(r.indexOf(sr(p),N)!=N){var oe=M.lastIndexOf(p);oe>-1&&(M=M.slice(0,oe))}return M+h}function Mw(r){return r=Qe(r),r&&mt.test(r)?r.replace(ji,fg):r}var jw=Yi(function(r,n,a){return r+(a?" ":"")+n.toUpperCase()}),pa=sh("toUpperCase");function il(r,n,a){return r=Qe(r),n=a?t:n,n===t?ag(r)?gg(r):Xp(r):r.match(n)||[]}var nl=Ue(function(r,n){try{return ir(r,t,n)}catch(a){return ha(a)?a:new De(a)}}),qw=zr(function(r,n){return pr(n,function(a){a=Nr(a),qr(r,a,ca(r[a],r))}),r});function Fw(r){var n=r==null?0:r.length,a=de();return r=n?it(r,function(h){if(typeof h[1]!="function")throw new gr(d);return[a(h[0]),h[1]]}):[],Ue(function(h){for(var p=-1;++p<n;){var w=r[p];if(ir(w[0],this,h))return ir(w[1],this,h)}})}function zw(r){return f0(vr(r,D))}function ga(r){return function(){return r}}function Bw(r,n){return r==null||r!==r?n:r}var Hw=ah(),kw=ah(!0);function Zt(r){return r}function ya(r){return Mu(typeof r=="function"?r:vr(r,D))}function Kw(r){return qu(vr(r,D))}function Vw(r,n){return Fu(r,vr(n,D))}var Ww=Ue(function(r,n){return function(a){return _n(a,r,n)}}),Gw=Ue(function(r,n){return function(a){return _n(r,a,n)}});function va(r,n,a){var h=Rt(n),p=ms(n,h);a==null&&!(ot(n)&&(p.length||!h.length))&&(a=n,n=r,r=this,p=ms(n,Rt(n)));var w=!(ot(a)&&"chain"in a)||!!a.chain,S=Hr(r);return pr(p,function(N){var M=n[N];r[N]=M,S&&(r.prototype[N]=function(){var Y=this.__chain__;if(w||Y){var Q=r(this.__wrapped__),ee=Q.__actions__=Jt(this.__actions__);return ee.push({func:M,args:arguments,thisArg:r}),Q.__chain__=Y,Q}return M.apply(r,ri([this.value()],arguments))})}),r}function Yw(){return Ut._===this&&(Ut._=_g),this}function ma(){}function Jw(r){return r=Oe(r),Ue(function(n){return zu(n,r)})}var Qw=Yo(it),Xw=Yo(cu),Zw=Yo(bo);function sl(r){return ra(r)?_o(Nr(r)):C0(r)}function e1(r){return function(n){return r==null?t:_i(r,n)}}var t1=uh(),r1=uh(!0);function wa(){return[]}function ba(){return!1}function i1(){return{}}function n1(){return""}function s1(){return!0}function o1(r,n){if(r=Oe(r),r<1||r>H)return[];var a=Z,h=jt(r,Z);n=de(n),r-=Z;for(var p=Io(h,n);++a<r;)n(a);return p}function a1(r){return Se(r)?it(r,Nr):or(r)?[r]:Jt(Sh(Qe(r)))}function c1(r){var n=++wg;return Qe(r)+n}var u1=Is(function(r,n){return r+n},0),h1=Jo("ceil"),l1=Is(function(r,n){return r/n},1),f1=Jo("floor");function d1(r){return r&&r.length?vs(r,Zt,$o):t}function p1(r,n){return r&&r.length?vs(r,de(n,2),$o):t}function g1(r){return lu(r,Zt)}function y1(r,n){return lu(r,de(n,2))}function v1(r){return r&&r.length?vs(r,Zt,qo):t}function m1(r,n){return r&&r.length?vs(r,de(n,2),qo):t}var w1=Is(function(r,n){return r*n},1),b1=Jo("round"),_1=Is(function(r,n){return r-n},0);function E1(r){return r&&r.length?Do(r,Zt):0}function D1(r,n){return r&&r.length?Do(r,de(n,2)):0}return v.after=Kv,v.ary=Lh,v.assign=Nm,v.assignIn=Jh,v.assignInWith=Ms,v.assignWith=Tm,v.at=Um,v.before=Mh,v.bind=ca,v.bindAll=qw,v.bindKey=jh,v.castArray=im,v.chain=Th,v.chunk=fy,v.compact=dy,v.concat=py,v.cond=Fw,v.conforms=zw,v.constant=ga,v.countBy=Ev,v.create=$m,v.curry=qh,v.curryRight=Fh,v.debounce=zh,v.defaults=Lm,v.defaultsDeep=Mm,v.defer=Vv,v.delay=Wv,v.difference=gy,v.differenceBy=yy,v.differenceWith=vy,v.drop=my,v.dropRight=wy,v.dropRightWhile=by,v.dropWhile=_y,v.fill=Ey,v.filter=Iv,v.flatMap=Ov,v.flatMapDeep=Pv,v.flatMapDepth=Cv,v.flatten=Ch,v.flattenDeep=Dy,v.flattenDepth=Iy,v.flip=Gv,v.flow=Hw,v.flowRight=kw,v.fromPairs=Sy,v.functions=km,v.functionsIn=Km,v.groupBy=Av,v.initial=Oy,v.intersection=Py,v.intersectionBy=Cy,v.intersectionWith=Ay,v.invert=Wm,v.invertBy=Gm,v.invokeMap=Nv,v.iteratee=ya,v.keyBy=Tv,v.keys=Rt,v.keysIn=Xt,v.map=Rs,v.mapKeys=Jm,v.mapValues=Qm,v.matches=Kw,v.matchesProperty=Vw,v.memoize=Ts,v.merge=Xm,v.mergeWith=Qh,v.method=Ww,v.methodOf=Gw,v.mixin=va,v.negate=Us,v.nthArg=Jw,v.omit=Zm,v.omitBy=ew,v.once=Yv,v.orderBy=Uv,v.over=Qw,v.overArgs=Jv,v.overEvery=Xw,v.overSome=Zw,v.partial=ua,v.partialRight=Bh,v.partition=$v,v.pick=tw,v.pickBy=Xh,v.property=sl,v.propertyOf=e1,v.pull=Uy,v.pullAll=Rh,v.pullAllBy=$y,v.pullAllWith=Ly,v.pullAt=My,v.range=t1,v.rangeRight=r1,v.rearg=Qv,v.reject=jv,v.remove=jy,v.rest=Xv,v.reverse=oa,v.sampleSize=Fv,v.set=iw,v.setWith=nw,v.shuffle=zv,v.slice=qy,v.sortBy=kv,v.sortedUniq=Vy,v.sortedUniqBy=Wy,v.split=Ow,v.spread=Zv,v.tail=Gy,v.take=Yy,v.takeRight=Jy,v.takeRightWhile=Qy,v.takeWhile=Xy,v.tap=dv,v.throttle=em,v.thru=As,v.toArray=Wh,v.toPairs=Zh,v.toPairsIn=el,v.toPath=a1,v.toPlainObject=Yh,v.transform=sw,v.unary=tm,v.union=Zy,v.unionBy=ev,v.unionWith=tv,v.uniq=rv,v.uniqBy=iv,v.uniqWith=nv,v.unset=ow,v.unzip=aa,v.unzipWith=Nh,v.update=aw,v.updateWith=cw,v.values=Xi,v.valuesIn=uw,v.without=sv,v.words=il,v.wrap=rm,v.xor=ov,v.xorBy=av,v.xorWith=cv,v.zip=uv,v.zipObject=hv,v.zipObjectDeep=lv,v.zipWith=fv,v.entries=Zh,v.entriesIn=el,v.extend=Jh,v.extendWith=Ms,va(v,v),v.add=u1,v.attempt=nl,v.camelCase=dw,v.capitalize=tl,v.ceil=h1,v.clamp=hw,v.clone=nm,v.cloneDeep=om,v.cloneDeepWith=am,v.cloneWith=sm,v.conformsTo=cm,v.deburr=rl,v.defaultTo=Bw,v.divide=l1,v.endsWith=pw,v.eq=xr,v.escape=gw,v.escapeRegExp=yw,v.every=Dv,v.find=Sv,v.findIndex=Oh,v.findKey=jm,v.findLast=xv,v.findLastIndex=Ph,v.findLastKey=qm,v.floor=f1,v.forEach=Uh,v.forEachRight=$h,v.forIn=Fm,v.forInRight=zm,v.forOwn=Bm,v.forOwnRight=Hm,v.get=fa,v.gt=um,v.gte=hm,v.has=Vm,v.hasIn=da,v.head=Ah,v.identity=Zt,v.includes=Rv,v.indexOf=xy,v.inRange=lw,v.invoke=Ym,v.isArguments=Ii,v.isArray=Se,v.isArrayBuffer=lm,v.isArrayLike=Qt,v.isArrayLikeObject=ht,v.isBoolean=fm,v.isBuffer=ui,v.isDate=dm,v.isElement=pm,v.isEmpty=gm,v.isEqual=ym,v.isEqualWith=vm,v.isError=ha,v.isFinite=mm,v.isFunction=Hr,v.isInteger=Hh,v.isLength=$s,v.isMap=kh,v.isMatch=wm,v.isMatchWith=bm,v.isNaN=_m,v.isNative=Em,v.isNil=Im,v.isNull=Dm,v.isNumber=Kh,v.isObject=ot,v.isObjectLike=ut,v.isPlainObject=On,v.isRegExp=la,v.isSafeInteger=Sm,v.isSet=Vh,v.isString=Ls,v.isSymbol=or,v.isTypedArray=Qi,v.isUndefined=xm,v.isWeakMap=Om,v.isWeakSet=Pm,v.join=Ry,v.kebabCase=vw,v.last=wr,v.lastIndexOf=Ny,v.lowerCase=mw,v.lowerFirst=ww,v.lt=Cm,v.lte=Am,v.max=d1,v.maxBy=p1,v.mean=g1,v.meanBy=y1,v.min=v1,v.minBy=m1,v.stubArray=wa,v.stubFalse=ba,v.stubObject=i1,v.stubString=n1,v.stubTrue=s1,v.multiply=w1,v.nth=Ty,v.noConflict=Yw,v.noop=ma,v.now=Ns,v.pad=bw,v.padEnd=_w,v.padStart=Ew,v.parseInt=Dw,v.random=fw,v.reduce=Lv,v.reduceRight=Mv,v.repeat=Iw,v.replace=Sw,v.result=rw,v.round=b1,v.runInContext=$,v.sample=qv,v.size=Bv,v.snakeCase=xw,v.some=Hv,v.sortedIndex=Fy,v.sortedIndexBy=zy,v.sortedIndexOf=By,v.sortedLastIndex=Hy,v.sortedLastIndexBy=ky,v.sortedLastIndexOf=Ky,v.startCase=Pw,v.startsWith=Cw,v.subtract=_1,v.sum=E1,v.sumBy=D1,v.template=Aw,v.times=o1,v.toFinite=kr,v.toInteger=Oe,v.toLength=Gh,v.toLower=Rw,v.toNumber=br,v.toSafeInteger=Rm,v.toString=Qe,v.toUpper=Nw,v.trim=Tw,v.trimEnd=Uw,v.trimStart=$w,v.truncate=Lw,v.unescape=Mw,v.uniqueId=c1,v.upperCase=jw,v.upperFirst=pa,v.each=Uh,v.eachRight=$h,v.first=Ah,va(v,function(){var r={};return Ar(v,function(n,a){Xe.call(v.prototype,a)||(r[a]=n)}),r}(),{chain:!1}),v.VERSION=s,pr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){v[r].placeholder=v}),pr(["drop","take"],function(r,n){Fe.prototype[r]=function(a){a=a===t?1:vt(Oe(a),0);var h=this.__filtered__&&!n?new Fe(this):this.clone();return h.__filtered__?h.__takeCount__=jt(a,h.__takeCount__):h.__views__.push({size:jt(a,Z),type:r+(h.__dir__<0?"Right":"")}),h},Fe.prototype[r+"Right"]=function(a){return this.reverse()[r](a).reverse()}}),pr(["filter","map","takeWhile"],function(r,n){var a=n+1,h=a==_||a==X;Fe.prototype[r]=function(p){var w=this.clone();return w.__iteratees__.push({iteratee:de(p,3),type:a}),w.__filtered__=w.__filtered__||h,w}}),pr(["head","last"],function(r,n){var a="take"+(n?"Right":"");Fe.prototype[r]=function(){return this[a](1).value()[0]}}),pr(["initial","tail"],function(r,n){var a="drop"+(n?"":"Right");Fe.prototype[r]=function(){return this.__filtered__?new Fe(this):this[a](1)}}),Fe.prototype.compact=function(){return this.filter(Zt)},Fe.prototype.find=function(r){return this.filter(r).head()},Fe.prototype.findLast=function(r){return this.reverse().find(r)},Fe.prototype.invokeMap=Ue(function(r,n){return typeof r=="function"?new Fe(this):this.map(function(a){return _n(a,r,n)})}),Fe.prototype.reject=function(r){return this.filter(Us(de(r)))},Fe.prototype.slice=function(r,n){r=Oe(r);var a=this;return a.__filtered__&&(r>0||n<0)?new Fe(a):(r<0?a=a.takeRight(-r):r&&(a=a.drop(r)),n!==t&&(n=Oe(n),a=n<0?a.dropRight(-n):a.take(n-r)),a)},Fe.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},Fe.prototype.toArray=function(){return this.take(Z)},Ar(Fe.prototype,function(r,n){var a=/^(?:filter|find|map|reject)|While$/.test(n),h=/^(?:head|last)$/.test(n),p=v[h?"take"+(n=="last"?"Right":""):n],w=h||/^find/.test(n);p&&(v.prototype[n]=function(){var S=this.__wrapped__,N=h?[1]:arguments,M=S instanceof Fe,Y=N[0],Q=M||Se(S),ee=function(je){var ke=p.apply(v,ri([je],N));return h&&oe?ke[0]:ke};Q&&a&&typeof Y=="function"&&Y.length!=1&&(M=Q=!1);var oe=this.__chain__,le=!!this.__actions__.length,pe=w&&!oe,Ne=M&&!le;if(!w&&Q){S=Ne?S:new Fe(this);var ge=r.apply(S,N);return ge.__actions__.push({func:As,args:[ee],thisArg:t}),new yr(ge,oe)}return pe&&Ne?r.apply(this,N):(ge=this.thru(ee),pe?h?ge.value()[0]:ge.value():ge)})}),pr(["pop","push","shift","sort","splice","unshift"],function(r){var n=rs[r],a=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",h=/^(?:pop|shift)$/.test(r);v.prototype[r]=function(){var p=arguments;if(h&&!this.__chain__){var w=this.value();return n.apply(Se(w)?w:[],p)}return this[a](function(S){return n.apply(Se(S)?S:[],p)})}}),Ar(Fe.prototype,function(r,n){var a=v[n];if(a){var h=a.name+"";Xe.call(Vi,h)||(Vi[h]=[]),Vi[h].push({name:n,func:a})}}),Vi[Ds(t,te).name]=[{name:"wrapper",func:t}],Fe.prototype.clone=Mg,Fe.prototype.reverse=jg,Fe.prototype.value=qg,v.prototype.at=pv,v.prototype.chain=gv,v.prototype.commit=yv,v.prototype.next=vv,v.prototype.plant=wv,v.prototype.reverse=bv,v.prototype.toJSON=v.prototype.valueOf=v.prototype.value=_v,v.prototype.first=v.prototype.head,pn&&(v.prototype[pn]=mv),v},Hi=yg();yi?((yi.exports=Hi)._=Hi,yo._=Hi):Ut._=Hi}).call(Un)})(uc,uc.exports);var yS=Object.defineProperty,vS=Object.defineProperties,mS=Object.getOwnPropertyDescriptors,Mf=Object.getOwnPropertySymbols,wS=Object.prototype.hasOwnProperty,bS=Object.prototype.propertyIsEnumerable,jf=(i,e,t)=>e in i?yS(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Bs=(i,e)=>{for(var t in e||(e={}))wS.call(e,t)&&jf(i,t,e[t]);if(Mf)for(var t of Mf(e))bS.call(e,t)&&jf(i,t,e[t]);return i},_S=(i,e)=>vS(i,mS(e));function fi(i,e,t){var s;const o=yE(i);return((s=e.rpcMap)==null?void 0:s[o.reference])||`${gS}?chainId=${o.namespace}:${o.reference}&projectId=${t}`}function Li(i){return i.includes(":")?i.split(":")[1]:i}function sp(i){return i.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function ES(i,e){const t=Object.keys(e.namespaces).filter(o=>o.includes(i));if(!t.length)return[];const s=[];return t.forEach(o=>{const c=e.namespaces[o].accounts;s.push(...c)}),s}function qf(i={},e={}){const t=Ff(i),s=Ff(e);return uc.exports.merge(t,s)}function Ff(i){var e,t,s,o;const c={};if(!Bn(i))return c;for(const[d,f]of Object.entries(i)){const y=Ic(d)?[d]:f.chains,g=f.methods||[],m=f.events||[],D=f.rpcMap||{},I=$n(d);c[I]=_S(Bs(Bs({},c[I]),f),{chains:xa(y,(e=c[I])==null?void 0:e.chains),methods:xa(g,(t=c[I])==null?void 0:t.methods),events:xa(m,(s=c[I])==null?void 0:s.events),rpcMap:Bs(Bs({},D),(o=c[I])==null?void 0:o.rpcMap)})}return c}function DS(i){return i.includes(":")?i.split(":")[2]:i}function IS(i){const e={};for(const[t,s]of Object.entries(i)){const o=s.methods||[],c=s.events||[],d=s.accounts||[],f=Ic(t)?[t]:s.chains?s.chains:sp(s.accounts);e[t]={chains:f,methods:o,events:c,accounts:d}}return e}function Fa(i){return typeof i=="number"?i:i.includes("0x")?parseInt(i,16):(i=i.includes(":")?i.split(":")[1]:i,isNaN(Number(i))?i:Number(i))}const op={},st=i=>op[i],za=(i,e)=>{op[i]=e};class SS{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Zr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=Li(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||fi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Xr(new pi(s,st("disableProviderPing")))}}class xS{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=st("events"),this.client=st("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(Zr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const s=t||fi(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Xr(new pi(s,st("disableProviderPing")))}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=parseInt(Li(t));e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,s;let o=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}}class OS{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Zr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=Li(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||fi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Xr(new pi(s,st("disableProviderPing")))}}class PS{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Zr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=Li(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||fi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Xr(new pi(s,st("disableProviderPing")))}}class CS{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Zr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const s=this.getCardanoRPCUrl(t),o=Li(t);e[o]=this.createHttpProvider(o,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Xr(new pi(s,st("disableProviderPing")))}}class AS{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Zr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=Li(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||fi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Xr(new pi(s,st("disableProviderPing")))}}class RS{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Zr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=Li(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||fi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Xr(new pi(s,st("disableProviderPing")))}}class NS{constructor(e){this.name="near",this.namespace=e.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||fi(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Zr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||fi(e,this.namespace);return typeof s>"u"?void 0:new Xr(new pi(s,st("disableProviderPing")))}}var TS=Object.defineProperty,US=Object.defineProperties,$S=Object.getOwnPropertyDescriptors,zf=Object.getOwnPropertySymbols,LS=Object.prototype.hasOwnProperty,MS=Object.prototype.propertyIsEnumerable,Bf=(i,e,t)=>e in i?TS(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Hs=(i,e)=>{for(var t in e||(e={}))LS.call(e,t)&&Bf(i,t,e[t]);if(zf)for(var t of zf(e))MS.call(e,t)&&Bf(i,t,e[t]);return i},Ba=(i,e)=>US(i,$S(e));class Tc{constructor(e){this.events=new dc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:ze.pino(ze.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||$f})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new Tc(e);return await t.initialize(),t}async request(e,t,s){const[o,c]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(o).request({request:Hs({},e),chainId:`${o}:${c}`,topic:this.session.topic,expiry:s})}sendAsync(e,t,s,o){const c=new Date().getTime();this.request(e,s,o).then(d=>t(null,so(c,d))).catch(d=>t(d,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:nt("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(c=>{this.session=c;const d=IS(c.namespaces);this.namespaces=qf(this.namespaces,d),this.persist("namespaces",this.namespaces)}).catch(c=>{if(c.message!==ip)throw c;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[s,o]=this.validateChain(e);this.getProvider(s).setDefaultChain(o,t)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if($r(t)){for(const s of t)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await cS.init({logger:this.providerOpts.logger||$f,relayUrl:this.providerOpts.relayUrl||fS,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>$n(t)))];za("client",this.client),za("events",this.events),za("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const s=ES(t,this.session),o=sp(s),c=qf(this.namespaces,this.optionalNamespaces),d=Ba(Hs({},c[t]),{accounts:s,chains:o});switch(t){case"eip155":this.rpcProviders[t]=new xS({namespace:d});break;case"solana":this.rpcProviders[t]=new OS({namespace:d});break;case"cosmos":this.rpcProviders[t]=new PS({namespace:d});break;case"polkadot":this.rpcProviders[t]=new SS({namespace:d});break;case"cip34":this.rpcProviders[t]=new CS({namespace:d});break;case"elrond":this.rpcProviders[t]=new AS({namespace:d});break;case"multiversx":this.rpcProviders[t]=new RS({namespace:d});break;case"near":this.rpcProviders[t]=new NS({namespace:d});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:s}=t;if(s.name==="accountsChanged"){const o=s.data;o&&$r(o)&&this.events.emit("accountsChanged",o.map(DS))}else if(s.name==="chainChanged"){const o=t.chainId,c=t.event.data,d=$n(o),f=Fa(o)!==Fa(c)?`${d}:${Fa(c)}`:o;this.onChainChanged(f)}else this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var s;const{namespaces:o}=t,c=(s=this.client)==null?void 0:s.session.get(e);this.session=Ba(Hs({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Ba(Hs({},nt("USER_DISCONNECTED")),{data:e.topic}))}),this.on(Zr.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:s,sessionProperties:o}=e;t&&Object.keys(t).length&&(this.namespaces=t),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",t),this.persist("optionalNamespaces",s)}validateChain(e){const[t,s]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,s];if(t&&!Object.keys(this.namespaces||{}).map(d=>$n(d)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&s)return[t,s];const o=$n(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){if(!this.namespaces)return;const[s,o]=this.validateChain(e);o&&(t||this.getProvider(s).setDefaultChain(o),this.namespaces[s]?this.namespaces[s].defaultChain=o:this.namespaces[`${s}:${o}`]?this.namespaces[`${s}:${o}`].defaultChain=o:this.namespaces[`${s}:${o}`]={defaultChain:o},this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",o))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${Lf}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${Lf}/${e}`)}}const jS=Tc,qS="wc",FS="ethereum_provider",zS=`${qS}@2:${FS}:`,BS="https://rpc.walletconnect.com/v1/",hc=["eth_sendTransaction","personal_sign"],HS=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],lc=["chainChanged","accountsChanged"],kS=["chainChanged","accountsChanged","message","disconnect","connect"];var KS=Object.defineProperty,VS=Object.defineProperties,WS=Object.getOwnPropertyDescriptors,Hf=Object.getOwnPropertySymbols,GS=Object.prototype.hasOwnProperty,YS=Object.prototype.propertyIsEnumerable,kf=(i,e,t)=>e in i?KS(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Mn=(i,e)=>{for(var t in e||(e={}))GS.call(e,t)&&kf(i,t,e[t]);if(Hf)for(var t of Hf(e))YS.call(e,t)&&kf(i,t,e[t]);return i},Kf=(i,e)=>VS(i,WS(e));function Xs(i){return Number(i[0].split(":")[1])}function Ha(i){return`0x${i.toString(16)}`}function JS(i){const{chains:e,optionalChains:t,methods:s,optionalMethods:o,events:c,optionalEvents:d,rpcMap:f}=i;if(!$r(e))throw new Error("Invalid chains");const y={chains:e,methods:s||hc,events:c||lc,rpcMap:Mn({},e.length?{[Xs(e)]:f[Xs(e)]}:{})},g=c==null?void 0:c.filter(A=>!lc.includes(A)),m=s==null?void 0:s.filter(A=>!hc.includes(A));if(!t&&!d&&!o&&!(g!=null&&g.length)&&!(m!=null&&m.length))return{required:e.length?y:void 0};const D=(g==null?void 0:g.length)&&(m==null?void 0:m.length)||!t,I={chains:[...new Set(D?y.chains.concat(t||[]):t)],methods:[...new Set(y.methods.concat(o!=null&&o.length?o:HS))],events:[...new Set(y.events.concat(d!=null&&d.length?d:kS))],rpcMap:f};return{required:e.length?y:void 0,optional:t.length?I:void 0}}class Uc{constructor(){this.events=new Er.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=zS,this.on=(e,t)=>(this.events.on(e,t),this),this.once=(e,t)=>(this.events.once(e,t),this),this.removeListener=(e,t)=>(this.events.removeListener(e,t),this),this.off=(e,t)=>(this.events.off(e,t),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const t=new Uc;return await t.initialize(e),t}async request(e,t){return await this.signer.request(e,this.formatChainId(this.chainId),t)}sendAsync(e,t,s){this.signer.sendAsync(e,t,this.formatChainId(this.chainId),s)}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:t,optional:s}=JS(this.rpc);try{const o=await new Promise(async(d,f)=>{var y;this.rpc.showQrModal&&((y=this.modal)==null||y.subscribeModal(g=>{!g.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),f(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Kf(Mn({namespaces:Mn({},t&&{[this.namespace]:t})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(g=>{d(g)}).catch(g=>{f(new Error(g.message))})});if(!o)return;const c=vE(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:Ha(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:s}=t;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",Ha(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",Kf(Mn({},nt("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var t,s;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(s=this.modal)==null||s.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",Ha(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,s,o]=e.split(":");return{chainId:`${t}:${s}`,address:o}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,s;const o=(t=e==null?void 0:e.chains)!=null?t:[],c=(s=e==null?void 0:e.optionalChains)!=null?s:[],d=o.concat(c);if(!d.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const f=o.length?(e==null?void 0:e.methods)||hc:[],y=o.length?(e==null?void 0:e.events)||lc:[],g=(e==null?void 0:e.optionalMethods)||[],m=(e==null?void 0:e.optionalEvents)||[],D=(e==null?void 0:e.rpcMap)||this.buildRpcMap(d,e.projectId),I=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(A=>this.formatChainId(A)),optionalChains:c.map(A=>this.formatChainId(A)),methods:f,events:y,optionalMethods:g,optionalEvents:m,rpcMap:D,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:I,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const s={};return e.forEach(o=>{s[o]=this.getRpcUrl(o,t)}),s}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?Xs(this.rpc.chains):Xs(this.rpc.optionalChains),this.signer=await jS.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:s}=await x1(()=>import("./index-B18Rf5_z.js").then(o=>o.i),__vite__mapDeps([0,1,2]));t=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(Mn({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:s,rpcMap:o}=e;t&&$r(t)&&(this.rpc.chains=t.map(c=>this.formatChainId(c)),t.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)})),s&&$r(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(c=>this.formatChainId(c)),s.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)}))}getRpcUrl(e,t){var s;return((s=this.rpc.rpcMap)==null?void 0:s[e])||`${BS}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}}const g5=Uc;export{g5 as EthereumProvider,kS as OPTIONAL_EVENTS,HS as OPTIONAL_METHODS,lc as REQUIRED_EVENTS,hc as REQUIRED_METHODS,Uc as default};
